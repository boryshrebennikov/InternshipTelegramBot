[
    {
        "id": "dbbd86af.74c0d8",
        "type": "tab",
        "label": "Main Flow",
        "disabled": false,
        "info": ""
    },
    {
        "id": "96f6108e.64a37",
        "type": "tab",
        "label": "Start command",
        "disabled": false,
        "info": ""
    },
    {
        "id": "696b129b.360e0c",
        "type": "tab",
        "label": "Is registration completed",
        "disabled": false,
        "info": ""
    },
    {
        "id": "4c6874fb.68b9dc",
        "type": "tab",
        "label": "Editing username",
        "disabled": false,
        "info": ""
    },
    {
        "id": "3b5b98a.1c38768",
        "type": "tab",
        "label": "Editing location",
        "disabled": false,
        "info": ""
    },
    {
        "id": "68a30d94.469f94",
        "type": "tab",
        "label": "Editing occupation",
        "disabled": false,
        "info": ""
    },
    {
        "id": "df5e43cb.b674f",
        "type": "tab",
        "label": "Main menu",
        "disabled": false,
        "info": ""
    },
    {
        "id": "276bc02d.e347",
        "type": "tab",
        "label": "Pages info",
        "disabled": false,
        "info": ""
    },
    {
        "id": "d3d080fa.62628",
        "type": "tab",
        "label": "The most popular questions",
        "disabled": false,
        "info": ""
    },
    {
        "id": "cbf72f33.63dd6",
        "type": "tab",
        "label": "Chatting",
        "disabled": false,
        "info": ""
    },
    {
        "id": "14785f2b.3d2341",
        "type": "tab",
        "label": "Is admin",
        "disabled": false,
        "info": ""
    },
    {
        "id": "741a84b0.eaaafc",
        "type": "tab",
        "label": "Admin messages",
        "disabled": false,
        "info": ""
    },
    {
        "id": "27a4d84f.90dc58",
        "type": "tab",
        "label": "Admin auth message",
        "disabled": false,
        "info": ""
    },
    {
        "id": "74e0bd75.30b964",
        "type": "tab",
        "label": "Admin menu",
        "disabled": false,
        "info": ""
    },
    {
        "id": "892838ee.3ab438",
        "type": "tab",
        "label": "Admin statistics",
        "disabled": false,
        "info": ""
    },
    {
        "id": "76bd89c2.eace48",
        "type": "tab",
        "label": "Admin editing info",
        "disabled": false,
        "info": ""
    },
    {
        "id": "59350fd8.5c52c",
        "type": "tab",
        "label": "Admin distribution",
        "disabled": false,
        "info": ""
    },
    {
        "id": "4000ac09.8509f4",
        "type": "tab",
        "label": "Admin management",
        "disabled": false,
        "info": ""
    },
    {
        "id": "54742aae.b4a584",
        "type": "tab",
        "label": "Sync FAQ",
        "disabled": false,
        "info": ""
    },
    {
        "id": "411ddac8.164cb4",
        "type": "subflow",
        "name": "Send message to the chat",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 140,
                "y": 80,
                "wires": [
                    {
                        "id": "bd92a1fe.c5f6f"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 720,
                "y": 80,
                "wires": [
                    {
                        "id": "b8d99eac.ee468",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "color": "#DDAA99"
    },
    {
        "id": "4001764a.8341f8",
        "type": "subflow",
        "name": "Remove inline keyboard",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 160,
                "y": 80,
                "wires": [
                    {
                        "id": "a46d83e7.59837"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1980,
                "y": 80,
                "wires": [
                    {
                        "id": "cfe21d91.ca59b",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "color": "#DDAA99"
    },
    {
        "id": "529c4263.aeab0c",
        "type": "MySQLdatabase",
        "name": "",
        "host": "localhost",
        "port": "3306",
        "db": "internship_telegram_bot",
        "tz": "",
        "charset": "UTF8"
    },
    {
        "id": "b513f9.a96b5c08",
        "type": "dialogflowv2-token",
        "name": "Questions"
    },
    {
        "id": "95f1f9c.778f308",
        "type": "dialogflowv2-token",
        "name": "dialogflow_node_red"
    },
    {
        "id": "83a6c20c.1b51b",
        "type": "function",
        "z": "4c6874fb.68b9dc",
        "name": "Updating user name",
        "func": "msg.first_name = msg.payload_from_hook.callback_query.message.chat.first_name ? msg.payload_from_hook.callback_query.message.chat.first_name : '';\nmsg.last_name = msg.payload_from_hook.callback_query.message.chat.last_name ? msg.payload_from_hook.callback_query.message.chat.last_name : '';\n\nmsg.method = \"PUT\"\nmsg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users?id=\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\nmsg.payload = {\n    \"name\": msg.first_name + \" \" + msg.last_name,\n    \"state\": {\"state\": \"location\"}\n}\n\n//for the next question\nmsg.text = \"–ó—Ä–æ–∑—É–º—ñ–ª–æ. –î–µ –≤–∏ –ø—Ä–æ–∂–∏–≤–∞—î—Ç–µ?\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 440,
        "y": 160,
        "wires": [
            [
                "4a21bcb4.3b48f4"
            ]
        ]
    },
    {
        "id": "49db1ec2.c7de4",
        "type": "link in",
        "z": "4c6874fb.68b9dc",
        "name": "Set username to default name",
        "links": [
            "96e4744d.d20358",
            "e97be8fd.b371d8",
            "9fa707eb.be1788"
        ],
        "x": 235,
        "y": 160,
        "wires": [
            [
                "83a6c20c.1b51b",
                "28cc6c0e.6a0174"
            ]
        ]
    },
    {
        "id": "f553be12.15931",
        "type": "debug",
        "z": "4c6874fb.68b9dc",
        "name": "Setting username to default response from db",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 980,
        "y": 240,
        "wires": []
    },
    {
        "id": "28cc6c0e.6a0174",
        "type": "debug",
        "z": "4c6874fb.68b9dc",
        "name": "Setting username to default incoming data",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 450,
        "y": 240,
        "wires": []
    },
    {
        "id": "643d38df.03a4c8",
        "type": "function",
        "z": "4c6874fb.68b9dc",
        "name": "Setting up response",
        "func": "msg.payload = {\n    text: \"–í–∫–∞–∂—ñ—Ç—å, –±—É–¥—å –ª–∞—Å–∫–∞, —Å–≤–æ—î —ñ–º'—èüëá\",\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1820,
        "y": 160,
        "wires": [
            [
                "c538e448.9052c8"
            ]
        ]
    },
    {
        "id": "407592c4.adb5ec",
        "type": "link in",
        "z": "4c6874fb.68b9dc",
        "name": "Send request message to enter a new username",
        "links": [
            "b48e521d.7a459",
            "ba2be4d7.46a368",
            "8b7e5ba1.e6b3d8",
            "7009e878.03e338"
        ],
        "x": 1605,
        "y": 160,
        "wires": [
            [
                "643d38df.03a4c8"
            ]
        ]
    },
    {
        "id": "4d10c364.bba70c",
        "type": "link out",
        "z": "4c6874fb.68b9dc",
        "name": "Move on to setting the location field",
        "links": [
            "b0af6159.780a4",
            "1835ced7.6011d1",
            "2afdb4a1.ffb67c"
        ],
        "x": 875,
        "y": 160,
        "wires": []
    },
    {
        "id": "37feab15.469a44",
        "type": "comment",
        "z": "4c6874fb.68b9dc",
        "name": "Setting username to default name",
        "info": "",
        "x": 350,
        "y": 120,
        "wires": []
    },
    {
        "id": "56b28ca1.adcfe4",
        "type": "comment",
        "z": "4c6874fb.68b9dc",
        "name": "Request message to enter a new username",
        "info": "",
        "x": 1760,
        "y": 120,
        "wires": []
    },
    {
        "id": "29b87cf7.8de694",
        "type": "debug",
        "z": "4c6874fb.68b9dc",
        "name": "Setting username field to 'editing' response from db",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3050,
        "y": 260,
        "wires": []
    },
    {
        "id": "32bc9488.39455c",
        "type": "function",
        "z": "4c6874fb.68b9dc",
        "name": "Changing state to 'username'",
        "func": "msg.method = \"PUT\"\nmsg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users?id=\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\nmsg.payload = {\n    \"state\": {\"state\": \"username\"}\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2500,
        "y": 160,
        "wires": [
            [
                "36cbe213.34e8fe"
            ]
        ]
    },
    {
        "id": "981f1664.6f90e8",
        "type": "comment",
        "z": "4c6874fb.68b9dc",
        "name": "Move on to setting the location field",
        "info": "",
        "x": 1000,
        "y": 120,
        "wires": []
    },
    {
        "id": "cab5fa05.8972f8",
        "type": "function",
        "z": "96f6108e.64a37",
        "name": "Setting up response greeting to '/start'",
        "func": "msg.payload = {\n    text: \"–ü—Ä–∏–≤—ñ—Ç! –Ø –±–æ—Ç –∫–∞—Ñ–µ–¥—Ä–∏ –Ü–°–ú.üë®‚Äçüíª–ó —Ä–∞–¥—ñ—Å—Ç—é –¥–æ–ø–æ–º–æ–∂—É –∑–Ω–∞–π—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –≤—Å—ñ –≤–∞—à—ñ –ø–∏—Ç–∞–Ω–Ω—è\",\n    chat_id: msg.chat_id\n}\n\n//for the next question\nmsg.text = \"–î–∞–≤–∞–π—Ç–µ –∑–Ω–∞–π–æ–º–∏—Ç–∏—Å—å –±–ª–∏–∂—á–µ. –ß–∏ –º–æ–∂—É —è –¥–æ –≤–∞—Å –∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—è \" + msg.first_name + \" \" + msg.last_name + \"?\"\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2370,
        "y": 120,
        "wires": [
            [
                "c965d10e.f8642"
            ]
        ]
    },
    {
        "id": "20d295e5.2aa6ca",
        "type": "function",
        "z": "96f6108e.64a37",
        "name": "Setting up request message to set username",
        "func": "msg.payload = {\n    text: msg.text,\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–¢–∞–∫, –∑–≤—ñ—Å–Ω–æ\",\n                callback_data: \"setCurrentName\"\n            }, \n            {\n                text: \"–Ø —Ö–æ—á—É –∑–º—ñ–Ω–∏—Ç–∏\",\n                callback_data: \"setName\"\n            }]\n        ]\n    },\n    chat_id: msg.chat_id,\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 3190,
        "y": 120,
        "wires": [
            [
                "cece57bc.ae7278"
            ]
        ]
    },
    {
        "id": "41e89314.19813c",
        "type": "debug",
        "z": "96f6108e.64a37",
        "name": "Getting user row in 'start command flow' response from api",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1160,
        "y": 300,
        "wires": []
    },
    {
        "id": "776fd5bc.aa182c",
        "type": "function",
        "z": "96f6108e.64a37",
        "name": "Checking presence of user row",
        "func": "if (msg.payload.status && msg.payload.status == \"success\") return [null, msg];\nelse return [msg, null];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1170,
        "y": 220,
        "wires": [
            [
                "58ada314.42903c"
            ],
            [
                "65f19cea.cc3ef4"
            ]
        ]
    },
    {
        "id": "bb24cad3.d57618",
        "type": "link in",
        "z": "96f6108e.64a37",
        "name": "Start",
        "links": [
            "2cfd1290.cbdfde",
            "b2bc8798.6a3f68",
            "a30c38e0.20a148",
            "712534ba.03dabc",
            "3df9c3f8.76229c",
            "ea1a539f.fff1a"
        ],
        "x": 415,
        "y": 220,
        "wires": [
            [
                "954a6c74.4f585",
                "de1e2237.23c0a"
            ]
        ]
    },
    {
        "id": "fc1f4d6.e69b0b",
        "type": "comment",
        "z": "96f6108e.64a37",
        "name": "Start",
        "info": "",
        "x": 450,
        "y": 180,
        "wires": []
    },
    {
        "id": "1835ced7.6011d1",
        "type": "link in",
        "z": "3b5b98a.1c38768",
        "name": "Send message to set the location field",
        "links": [
            "4d10c364.bba70c",
            "67e90bd9.a1e8c4",
            "ce2794d2.a63448",
            "fc83002f.8146f",
            "6f605b10.5004f4",
            "d8112410.42a728",
            "bba92257.ecedb",
            "82300e9c.ebaef",
            "edc1406.22255c",
            "25ba409f.99d92",
            "f9c56bb.4602798",
            "6eccdeb4.00c91"
        ],
        "x": 175,
        "y": 140,
        "wires": [
            [
                "d2a126cb.79b0c8"
            ]
        ]
    },
    {
        "id": "d2a126cb.79b0c8",
        "type": "function",
        "z": "3b5b98a.1c38768",
        "name": "Setting up question for location",
        "func": "msg.payload = {\n    text: msg.text,    \n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 470,
        "y": 140,
        "wires": [
            [
                "bcaa2825.03ec98"
            ]
        ]
    },
    {
        "id": "f83bba65.663248",
        "type": "function",
        "z": "3b5b98a.1c38768",
        "name": "Changing state filed to 'location'",
        "func": "msg.method = \"PUT\"\nmsg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users?id=\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\nmsg.payload = {\n    \"state\": {\"state\": \"location\"}\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1210,
        "y": 140,
        "wires": [
            [
                "14d25b8f.4b64c4"
            ]
        ]
    },
    {
        "id": "c6df9017.a5565",
        "type": "debug",
        "z": "3b5b98a.1c38768",
        "name": "Changing city field to 'editing' response from db",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1800,
        "y": 220,
        "wires": []
    },
    {
        "id": "64fc7f2f.7e856",
        "type": "comment",
        "z": "3b5b98a.1c38768",
        "name": "Request message to enter a location",
        "info": "",
        "x": 300,
        "y": 100,
        "wires": []
    },
    {
        "id": "62bdcfd6.d166e",
        "type": "link in",
        "z": "68a30d94.469f94",
        "name": "Send message to set the occupation field",
        "links": [
            "8a07dd6e.fb122",
            "eb6c15f.d5924e8",
            "cbb721f9.d1df5",
            "99c3c041.c38d3",
            "4984be9d.47765",
            "76dc39c7.1f1908",
            "1b5b2acd.749c85",
            "533ced35.8e30a4",
            "57b8c25.ed8713c"
        ],
        "x": 195,
        "y": 300,
        "wires": [
            [
                "c54069b2.59d4f8"
            ]
        ]
    },
    {
        "id": "c54069b2.59d4f8",
        "type": "function",
        "z": "68a30d94.469f94",
        "name": "Setting up 'choose occupation' message",
        "func": "msg.payload = {\n    text: msg.text,\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–ê–±—ñ—Ç—É—Ä—ñ—î–Ω—Ç\",\n                callback_data: \"setOccupationAsAnApplicant\"            \n            }, \n            {\n                text: \"–û–¥–∏–Ω –∑ –±–∞—Ç—å–∫—ñ–≤\",\n                callback_data: \"setOccupationAsOneOfTheParents\"            \n            }],\n            [{\n                text: \"–í–∏–∫–ª–∞–¥–∞—á\",\n                callback_data: \"setOccupationAsATeacher\"            \n            },\n            {\n                text: \"–°—Ç—É–¥–µ–Ω—Ç\",\n                callback_data: \"setOccupationAsAStudent\"            \n            }],\n            [{\n                text: \"–Ü–Ω—à–µ\",\n                callback_data: \"setOccupationAsOther\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 460,
        "y": 300,
        "wires": [
            [
                "6a938578.b8740c"
            ]
        ]
    },
    {
        "id": "efb68a90.a747e8",
        "type": "function",
        "z": "68a30d94.469f94",
        "name": "Set occupation as an applicant",
        "func": "msg.occupation = \"Applicant\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2330,
        "y": 180,
        "wires": [
            [
                "1001a33d.d9504d"
            ]
        ]
    },
    {
        "id": "35734a3f.d60566",
        "type": "function",
        "z": "68a30d94.469f94",
        "name": "Set occupation as one of the parents",
        "func": "msg.occupation = \"Parent\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2350,
        "y": 240,
        "wires": [
            [
                "1001a33d.d9504d"
            ]
        ]
    },
    {
        "id": "28c9f7e4.efea48",
        "type": "function",
        "z": "68a30d94.469f94",
        "name": "Set occupation as a teacher",
        "func": "msg.occupation = \"Teacher\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2320,
        "y": 300,
        "wires": [
            [
                "1001a33d.d9504d"
            ]
        ]
    },
    {
        "id": "564c6898.976ac8",
        "type": "function",
        "z": "68a30d94.469f94",
        "name": "Set occupation as a student",
        "func": "msg.occupation = \"Student\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2320,
        "y": 360,
        "wires": [
            [
                "1001a33d.d9504d"
            ]
        ]
    },
    {
        "id": "acac65a4.a6de98",
        "type": "function",
        "z": "68a30d94.469f94",
        "name": "Set occupation as other",
        "func": "msg.occupation = \"Other\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2310,
        "y": 420,
        "wires": [
            [
                "1001a33d.d9504d"
            ]
        ]
    },
    {
        "id": "bfff6d3f.b5c17",
        "type": "debug",
        "z": "68a30d94.469f94",
        "name": "Editing occupation field response from db",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3260,
        "y": 360,
        "wires": []
    },
    {
        "id": "59d394d6.305dac",
        "type": "link out",
        "z": "68a30d94.469f94",
        "name": "Move on to printing main menu",
        "links": [
            "f1be3b15.c41ab8",
            "502c79bf.c60c68"
        ],
        "x": 3155,
        "y": 280,
        "wires": []
    },
    {
        "id": "ed917a17.8e5078",
        "type": "link in",
        "z": "68a30d94.469f94",
        "name": "Set occupation as an applicant",
        "links": [
            "2b168ecb.915b02",
            "8d8d567.b8915a8",
            "9f17155a.a2e3d8"
        ],
        "x": 1875,
        "y": 180,
        "wires": [
            [
                "efb68a90.a747e8"
            ]
        ]
    },
    {
        "id": "4f5ec5f6.e9838c",
        "type": "link in",
        "z": "68a30d94.469f94",
        "name": "Set occupation as one of the parents",
        "links": [
            "84969f23.caa1",
            "a7216124.6534",
            "ab9f10ed.c145a"
        ],
        "x": 1875,
        "y": 240,
        "wires": [
            [
                "35734a3f.d60566"
            ]
        ]
    },
    {
        "id": "f2c3d2a0.25b49",
        "type": "link in",
        "z": "68a30d94.469f94",
        "name": "Set occupation as a teacher",
        "links": [
            "b50620a8.7515",
            "5ffcf5e0.aa2fec",
            "7f128497.b6240c"
        ],
        "x": 1875,
        "y": 300,
        "wires": [
            [
                "28c9f7e4.efea48"
            ]
        ]
    },
    {
        "id": "4ed757e7.456528",
        "type": "link in",
        "z": "68a30d94.469f94",
        "name": "Set occupation as a student",
        "links": [
            "1356b19c.1cb64e",
            "3b6ee588.2aab8a",
            "68c78f79.2c1b2"
        ],
        "x": 1875,
        "y": 360,
        "wires": [
            [
                "564c6898.976ac8"
            ]
        ]
    },
    {
        "id": "bcbdc401.9580e8",
        "type": "link in",
        "z": "68a30d94.469f94",
        "name": "Set occupation as other",
        "links": [
            "ce92fb67.2ac148",
            "9eae2df4.d9717",
            "7501c22.02e853c"
        ],
        "x": 1875,
        "y": 420,
        "wires": [
            [
                "acac65a4.a6de98"
            ]
        ]
    },
    {
        "id": "f1632c06.222ac",
        "type": "comment",
        "z": "68a30d94.469f94",
        "name": "Setting occupation",
        "info": "",
        "x": 1950,
        "y": 140,
        "wires": []
    },
    {
        "id": "ba8647ee.f68c28",
        "type": "comment",
        "z": "68a30d94.469f94",
        "name": "Request message to choose an occupation",
        "info": "",
        "x": 340,
        "y": 260,
        "wires": []
    },
    {
        "id": "ea5c7390.3d1a9",
        "type": "comment",
        "z": "68a30d94.469f94",
        "name": "Move on to printing main menu",
        "info": "",
        "x": 3270,
        "y": 240,
        "wires": []
    },
    {
        "id": "e0bc4239.7e156",
        "type": "function",
        "z": "cbf72f33.63dd6",
        "name": "Editing username or city or move on to processing message",
        "func": "function isTooLongAnswer(text) {\n    if (msg.message.length > 120) {\n        msg.payload = {\n            \"text\": text,\n            \"chat_id\": msg.chat_id\n        }\n        \n        return true;\n    }\n    \n    return false;\n}\n\nmsg.method = \"PUT\"\nmsg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users?id=\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nif (msg.payload.status && msg.payload.status == \"success\") {\n    //for admins\n    if (msg.payload.user.role_name.includes(\"admin\")) {\n        if (msg.payload.user.state.state.startsWith(\"editingInfo\")) {\n        \n            return [null, null, null, null, msg, null, null, null];\n        } else if (msg.payload.user.state.state == \"writingTextForDistribution\") {\n            \n            return [null, null, null, null, null, msg, null, null];\n        } else if (msg.payload.user.state.state == \"addingAdmin\") {\n            \n            return [null, null, null, null, null, null, msg, null];\n        }\n    }\n    \n    \n    //registrations and dialogflow\n    if (msg.payload.user.state.state == \"username\") {\n        if (isTooLongAnswer(\"–í–∏ –≤–≤–µ–ª–∏ –∑–∞–¥—É–∂–µ –¥–æ–≤–≥–µ —ñ–º'—è\")) return [null, null, msg, null, null, null, null, null];\n        \n        msg.payload = {\n            \"name\": msg.message\n        }\n        \n        //for the next question\n        msg.text = \"–ó—Ä–æ–∑—É–º—ñ–ª–æ. –î–µ –≤–∏ –ø—Ä–æ–∂–∏–≤–∞—î—Ç–µ?\";\n        \n        return [msg, null, null, null, null, null, null];\n    } else if (msg.payload.user.state.state == \"location\") {\n        if (isTooLongAnswer(\"–í–∏ –≤–≤–µ–ª–∏ –∑–∞–¥—É–∂–µ –¥–æ–≤–≥—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å\")) return [null, null, msg, null, null, null, null, null];\n        \n        msg.payload = {\n            \"city\": msg.message\n        }\n        \n        //for the next message\n        msg.text = \"–°—É–ø–µ—Ä. –î–ª—è –∫—Ä–∞—â–æ–≥–æ –ø—ñ–¥–±–æ—Ä—É FAQ üìä –≤–∏–±–µ—Ä—ñ—Ç—å —Å–≤—ñ–π –≤–∏–¥ –∑–∞–π–Ω—è—Ç–æ—Å—Ç—ñ\";\n        \n        return [null, msg, null, null, null, null, null, null];\n    } else if (msg.payload.user.state.state == \"registered\") {\n        \n        //sending saved contexts\n        msg.queryParams = {\n            \"contexts\": global.get(msg.chat_id.toString())\n        };\n        \n        //slice if it is answer to dialogflow question\n        if (msg.message.startsWith(\"answerToDFQuestion_\")) {\n            msg.payload = msg.message.slice(19);\n        } else {\n            msg.payload = msg.message;\n        }\n        \n        return [null, null, null, msg, null, null, null, null];\n    }\n}\n\nreturn [null, null, null, null, null, null, null, msg];",
        "outputs": 8,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1200,
        "y": 600,
        "wires": [
            [
                "858f85dd.43b438"
            ],
            [
                "2d8d4f52.fd9d1"
            ],
            [
                "5b53c12b.cc56"
            ],
            [
                "c82c545b.287d98"
            ],
            [
                "f3b73302.b6bf3"
            ],
            [
                "9c1f5735.fbe608"
            ],
            [
                "24e51cd8.751164"
            ],
            [
                "452a3d2.72b81c4"
            ]
        ],
        "outputLabels": [
            "Saving the username field",
            "Saving the city field",
            "Sending a message",
            "Send answer to one of the most popular questions",
            "DialogFlow Processing Message",
            "",
            "",
            ""
        ]
    },
    {
        "id": "bba92257.ecedb",
        "type": "link out",
        "z": "cbf72f33.63dd6",
        "name": "Move on to setting the location field",
        "links": [
            "b0af6159.780a4",
            "1835ced7.6011d1",
            "2afdb4a1.ffb67c"
        ],
        "x": 1975,
        "y": 180,
        "wires": []
    },
    {
        "id": "76dc39c7.1f1908",
        "type": "link out",
        "z": "cbf72f33.63dd6",
        "name": "Move on to choosing occupation",
        "links": [
            "4b1be78d.e0a2d8",
            "62bdcfd6.d166e"
        ],
        "x": 1975,
        "y": 380,
        "wires": []
    },
    {
        "id": "5581481b.706b38",
        "type": "link in",
        "z": "cbf72f33.63dd6",
        "name": "Edit username or city or process message",
        "links": [
            "17a4ed75.37c813",
            "5079e290.c379dc",
            "fd9aa5ae.4abe08"
        ],
        "x": 335,
        "y": 600,
        "wires": [
            [
                "e0bc4239.7e156"
            ]
        ]
    },
    {
        "id": "11cb9c66.1c2c64",
        "type": "comment",
        "z": "cbf72f33.63dd6",
        "name": "Processing other messages. Edit username or city",
        "info": "",
        "x": 510,
        "y": 560,
        "wires": []
    },
    {
        "id": "bd92a1fe.c5f6f",
        "type": "change",
        "z": "411ddac8.164cb4",
        "name": "Setting up bot url",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "\"https://api.telegram.org/bot\" & $env('TOKEN') & \"/sendMessage\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 330,
        "y": 80,
        "wires": [
            [
                "b8d99eac.ee468"
            ]
        ]
    },
    {
        "id": "b8d99eac.ee468",
        "type": "http request",
        "z": "411ddac8.164cb4",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "basic",
        "x": 550,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "5d8decb2.3014e4",
        "type": "debug",
        "z": "cbf72f33.63dd6",
        "name": "Response from dialogflow",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2030,
        "y": 860,
        "wires": []
    },
    {
        "id": "c82c545b.287d98",
        "type": "dialogflowv2",
        "z": "cbf72f33.63dd6",
        "dialogflow": "b513f9.a96b5c08",
        "language": "uk",
        "debug": false,
        "queryParamsOK": true,
        "x": 1800,
        "y": 780,
        "wires": [
            [
                "5d8decb2.3014e4",
                "8c22d5f5.4223e8"
            ]
        ]
    },
    {
        "id": "2c767f74.82a47",
        "type": "comment",
        "z": "cbf72f33.63dd6",
        "name": "DialogFlow Processing Message",
        "info": "",
        "x": 1850,
        "y": 740,
        "wires": []
    },
    {
        "id": "63a1490b.736ab8",
        "type": "function",
        "z": "cbf72f33.63dd6",
        "name": "Setting up dialogflow response",
        "func": "msg.intent = msg.payload;\n\nmsg.payload = {\n    chat_id: msg.chat_id,\n    text: msg._dialogflow.fulfillmentText,\n    reply_markup: {\n        inline_keyboard: [[{\n            text: \"‚óÄ –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é\",\n            callback_data: \"mainMenu\"\n        }]]\n    }\n}\n\nif (msg._dialogflow.fulfillmentMessages[0].platform == \"TELEGRAM\") {\n    msg.payload.text = msg._dialogflow.fulfillmentMessages[0].payload.fields.telegram.structValue.fields.text.stringValue;\n    \n    var inlineKeyboardAnswers = [];\n    msg._dialogflow.fulfillmentMessages[0].payload.fields.telegram.structValue\n        .fields.reply_markup.structValue.fields.inline_keyboard.listValue.values[0]\n        .listValue.values.forEach((value) => {\n            inlineKeyboardAnswers.push(\n                    {\n                        text: value.structValue.fields.text.stringValue,\n                        callback_data: \"answerToDFQuestion_\" + value.structValue.fields.callback_data.stringValue\n                        \n                    }\n                );\n        });\n    \n    msg.payload.reply_markup.inline_keyboard.unshift(inlineKeyboardAnswers)\n}\n\n\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2590,
        "y": 780,
        "wires": [
            [
                "5a2ebc6a.567e54"
            ]
        ]
    },
    {
        "id": "985d37c2.3d2328",
        "type": "comment",
        "z": "cbf72f33.63dd6",
        "name": "Move on to setting the location field",
        "info": "",
        "x": 2100,
        "y": 140,
        "wires": []
    },
    {
        "id": "74b4671f.1c13a8",
        "type": "comment",
        "z": "cbf72f33.63dd6",
        "name": "Move on to choosing occupation",
        "info": "",
        "x": 2090,
        "y": 340,
        "wires": []
    },
    {
        "id": "452a3d2.72b81c4",
        "type": "link out",
        "z": "cbf72f33.63dd6",
        "name": "Is registration completed",
        "links": [
            "6ff45d49.c66084",
            "4d1e8f79.27d3c"
        ],
        "x": 1735,
        "y": 1320,
        "wires": []
    },
    {
        "id": "1795e6cf.ce9ef9",
        "type": "comment",
        "z": "cbf72f33.63dd6",
        "name": "Checking whether the registration is completed",
        "info": "",
        "x": 1900,
        "y": 1280,
        "wires": []
    },
    {
        "id": "8c22d5f5.4223e8",
        "type": "function",
        "z": "cbf72f33.63dd6",
        "name": "Saving dialogflow context",
        "func": "global.set(msg.chat_id.toString(), msg._dialogflow.outputContexts);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2190,
        "y": 780,
        "wires": [
            [
                "63a1490b.736ab8"
            ]
        ]
    },
    {
        "id": "319d5b6f.be2d74",
        "type": "function",
        "z": "4001764a.8341f8",
        "name": "Removing inline keyboard",
        "func": "//remove inline keyboard\nmsg.payload = {\n    chat_id: msg.chat_id,\n    message_id: msg.message_id,\n    reply_markup: {\n        inline_keyboard: []\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 730,
        "y": 80,
        "wires": [
            [
                "ac12e929.bfded8"
            ]
        ]
    },
    {
        "id": "4a6d9a4d.b3d5b4",
        "type": "comment",
        "z": "cbf72f33.63dd6",
        "name": "Sending a message",
        "info": "",
        "x": 1810,
        "y": 560,
        "wires": []
    },
    {
        "id": "a64a08f7.365978",
        "type": "comment",
        "z": "cbf72f33.63dd6",
        "name": "Saving the city field",
        "info": "",
        "x": 1810,
        "y": 340,
        "wires": []
    },
    {
        "id": "b908221a.202f7",
        "type": "comment",
        "z": "cbf72f33.63dd6",
        "name": "Saving the username field",
        "info": "",
        "x": 1830,
        "y": 140,
        "wires": []
    },
    {
        "id": "954a6c74.4f585",
        "type": "debug",
        "z": "96f6108e.64a37",
        "name": "Start command incoming data",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 610,
        "y": 300,
        "wires": []
    },
    {
        "id": "5b53c12b.cc56",
        "type": "subflow:411ddac8.164cb4",
        "z": "cbf72f33.63dd6",
        "name": "",
        "env": [],
        "x": 1830,
        "y": 600,
        "wires": [
            []
        ]
    },
    {
        "id": "5a2ebc6a.567e54",
        "type": "subflow:411ddac8.164cb4",
        "z": "cbf72f33.63dd6",
        "name": "",
        "env": [],
        "x": 2930,
        "y": 780,
        "wires": [
            [
                "a8d398a0.9fa888",
                "173d0a39.c80376"
            ]
        ]
    },
    {
        "id": "6a938578.b8740c",
        "type": "subflow:411ddac8.164cb4",
        "z": "68a30d94.469f94",
        "name": "",
        "env": [],
        "x": 820,
        "y": 300,
        "wires": [
            [
                "5cdcad90.c84254"
            ]
        ]
    },
    {
        "id": "bcaa2825.03ec98",
        "type": "subflow:411ddac8.164cb4",
        "z": "3b5b98a.1c38768",
        "name": "",
        "env": [],
        "x": 850,
        "y": 140,
        "wires": [
            [
                "f83bba65.663248"
            ]
        ]
    },
    {
        "id": "c538e448.9052c8",
        "type": "subflow:411ddac8.164cb4",
        "z": "4c6874fb.68b9dc",
        "name": "",
        "env": [],
        "x": 2130,
        "y": 160,
        "wires": [
            [
                "32bc9488.39455c"
            ]
        ]
    },
    {
        "id": "c965d10e.f8642",
        "type": "subflow:411ddac8.164cb4",
        "z": "96f6108e.64a37",
        "name": "",
        "env": [],
        "x": 2710,
        "y": 120,
        "wires": [
            [
                "20d295e5.2aa6ca"
            ]
        ]
    },
    {
        "id": "cece57bc.ae7278",
        "type": "subflow:411ddac8.164cb4",
        "z": "96f6108e.64a37",
        "name": "",
        "env": [],
        "x": 3550,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "a46d83e7.59837",
        "type": "change",
        "z": "4001764a.8341f8",
        "name": "Saving msg.payload",
        "rules": [
            {
                "t": "set",
                "p": "payload_copy",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 80,
        "wires": [
            [
                "319d5b6f.be2d74"
            ]
        ]
    },
    {
        "id": "cfe21d91.ca59b",
        "type": "change",
        "z": "4001764a.8341f8",
        "name": "Setting saved payload to msg.payload",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload_copy",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1730,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "ac12e929.bfded8",
        "type": "change",
        "z": "4001764a.8341f8",
        "name": "Setting up editMessageReplyMarkup url",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "\"https://api.telegram.org/bot\" & $env('TOKEN') & \"/editMessageReplyMarkup\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1060,
        "y": 80,
        "wires": [
            [
                "a41f75cf.a711d8"
            ]
        ]
    },
    {
        "id": "a41f75cf.a711d8",
        "type": "http request",
        "z": "4001764a.8341f8",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "basic",
        "x": 1350,
        "y": 80,
        "wires": [
            [
                "cfe21d91.ca59b"
            ]
        ]
    },
    {
        "id": "a8d398a0.9fa888",
        "type": "function",
        "z": "cbf72f33.63dd6",
        "name": "Updating calls field of question",
        "func": "msg.method = \"PUT\";\nmsg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/questions/faq/increment?name=\" + msg.intent;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 3290,
        "y": 780,
        "wires": [
            [
                "bb4c4877.8d7198",
                "492e5f50.8b03c"
            ]
        ]
    },
    {
        "id": "1c133d73.d7c5c3",
        "type": "debug",
        "z": "dbbd86af.74c0d8",
        "name": "Incoming data",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 880,
        "wires": []
    },
    {
        "id": "13e44bbe.022ec4",
        "type": "http response",
        "z": "dbbd86af.74c0d8",
        "name": "",
        "statusCode": "200",
        "headers": {},
        "x": 440,
        "y": 940,
        "wires": []
    },
    {
        "id": "be1ed164.1521d",
        "type": "function",
        "z": "dbbd86af.74c0d8",
        "name": "Formatting data",
        "func": "if (msg.payload.callback_query) {\n    msg.message = msg.payload.callback_query.data;\n        \n    msg.chat_id = msg.payload.callback_query.from.id\n    \n    msg.message_id = msg.payload.callback_query.message.message_id;\n    \n    return [msg, null];\n} else if (msg.payload.message) {\n    //saving firstname and lastname of user\n    msg.first_name = msg.payload.message.chat.first_name ? msg.payload.message.chat.first_name : '';\n    msg.last_name = msg.payload.message.chat.last_name ? msg.payload.message.chat.last_name : '';\n    \n    msg.username = msg.payload.message.chat.username;\n\n    msg.message = msg.payload.message.text;\n    \n    msg.chat_id = msg.payload.message.from.id\n    \n    msg.message_id = msg.payload.message.message_id - 1;\n    \n    return [null, msg];\n}\n\nreturn [null, null]",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 580,
        "y": 800,
        "wires": [
            [
                "c017e434.7d5098"
            ],
            [
                "336efa19.615be6"
            ]
        ]
    },
    {
        "id": "d4173cf4.07cab",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Callback query events",
        "property": "message",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "setCurrentName",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "setName",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "setOccupationAsAnApplicant",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "setOccupationAsOneOfTheParents",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "setOccupationAsATeacher",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "setOccupationAsAStudent",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "setOccupationAsOther",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "mainMenu",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "theMostPopularQuestions",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "AboutISM",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "AboutNULP",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "HowToUseBot",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 12,
        "x": 1280,
        "y": 340,
        "wires": [
            [
                "9fa707eb.be1788"
            ],
            [
                "7009e878.03e338"
            ],
            [
                "9f17155a.a2e3d8"
            ],
            [
                "ab9f10ed.c145a"
            ],
            [
                "7f128497.b6240c"
            ],
            [
                "68c78f79.2c1b2"
            ],
            [
                "7501c22.02e853c"
            ],
            [
                "423e195b.dec3f8"
            ],
            [
                "d7b8d232.f7981"
            ],
            [
                "84602d83.794bf"
            ],
            [
                "84602d83.794bf"
            ],
            [
                "84602d83.794bf"
            ]
        ]
    },
    {
        "id": "9fa707eb.be1788",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Set username to default name",
        "links": [
            "49db1ec2.c7de4"
        ],
        "x": 1775,
        "y": 60,
        "wires": []
    },
    {
        "id": "7009e878.03e338",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Set username",
        "links": [
            "407592c4.adb5ec"
        ],
        "x": 1775,
        "y": 100,
        "wires": []
    },
    {
        "id": "423e195b.dec3f8",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Print main menu",
        "links": [
            "f1be3b15.c41ab8",
            "502c79bf.c60c68"
        ],
        "x": 1775,
        "y": 440,
        "wires": []
    },
    {
        "id": "9f17155a.a2e3d8",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Set occupation as an applicant",
        "links": [
            "3272d461.c8fe5c",
            "ed917a17.8e5078"
        ],
        "x": 1775,
        "y": 180,
        "wires": []
    },
    {
        "id": "ab9f10ed.c145a",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Set occupation as one of the parents",
        "links": [
            "84f1ccf3.e8c91",
            "4f5ec5f6.e9838c"
        ],
        "x": 1775,
        "y": 220,
        "wires": []
    },
    {
        "id": "7f128497.b6240c",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Set occupation as a teacher",
        "links": [
            "7ed591d4.8c433",
            "f2c3d2a0.25b49"
        ],
        "x": 1775,
        "y": 260,
        "wires": []
    },
    {
        "id": "68c78f79.2c1b2",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Set occupation as a student",
        "links": [
            "6ef222d3.893f0c",
            "4ed757e7.456528"
        ],
        "x": 1775,
        "y": 300,
        "wires": []
    },
    {
        "id": "7501c22.02e853c",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Set occupation as other",
        "links": [
            "bebaf9fd.57b3d8",
            "bcbdc401.9580e8"
        ],
        "x": 1775,
        "y": 340,
        "wires": []
    },
    {
        "id": "25afae95.4a6452",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Set occupation",
        "info": "# Setting occupation",
        "x": 1840,
        "y": 140,
        "wires": []
    },
    {
        "id": "4ea530d9.6681",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Main menu",
        "info": "",
        "x": 1820,
        "y": 400,
        "wires": []
    },
    {
        "id": "42e1a254.93316c",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Edit name",
        "info": "",
        "x": 1820,
        "y": 20,
        "wires": []
    },
    {
        "id": "d7b8d232.f7981",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send the most popular questions",
        "links": [
            "db785c0e.a93d6"
        ],
        "x": 1775,
        "y": 540,
        "wires": []
    },
    {
        "id": "92a60b0a.a91188",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send the most popular questions",
        "info": "",
        "x": 1890,
        "y": 500,
        "wires": []
    },
    {
        "id": "84602d83.794bf",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send message about ISM department",
        "links": [
            "b25d1f4e.85ebd",
            "94e14c4f.1155d",
            "255971.a036369"
        ],
        "x": 1775,
        "y": 640,
        "wires": []
    },
    {
        "id": "9e3a5712.5abb58",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send messages about ISM department, NULP, how to use the bot ",
        "info": "",
        "x": 1990,
        "y": 600,
        "wires": []
    },
    {
        "id": "59c1267b.ca3c98",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Answer to dialogflow question",
        "property": "$split(msg.message, \"_\", 1)",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "eq",
                "v": "answerToDFQuestion",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1310,
        "y": 840,
        "wires": [
            [
                "17a4ed75.37c813"
            ]
        ]
    },
    {
        "id": "17a4ed75.37c813",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Process message",
        "links": [
            "957981a1.8fdad",
            "62416c5b.bd8764",
            "5581481b.706b38",
            "3be0d365.f203bc",
            "c69d98c5.c5cda8"
        ],
        "x": 1775,
        "y": 840,
        "wires": []
    },
    {
        "id": "a1439bf8.dd9a78",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Process message",
        "info": "",
        "x": 1850,
        "y": 800,
        "wires": []
    },
    {
        "id": "db142eec.63a9b",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Set answer to popular question(pagination)",
        "property": "$split(msg.message, \"_\", 1)",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "eq",
                "v": "theMostPopularQPagination",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1350,
        "y": 740,
        "wires": [
            [
                "44ca7e7d.f7226"
            ]
        ]
    },
    {
        "id": "44ca7e7d.f7226",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Set answer to popular question(pagination)",
        "links": [
            "db785c0e.a93d6"
        ],
        "x": 1775,
        "y": 740,
        "wires": []
    },
    {
        "id": "695523ed.ad23dc",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Set answer to popular question(pagination)",
        "info": "",
        "x": 1920,
        "y": 700,
        "wires": []
    },
    {
        "id": "712534ba.03dabc",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "/start",
        "links": [
            "bb24cad3.d57618"
        ],
        "x": 1715,
        "y": 3360,
        "wires": []
    },
    {
        "id": "5079e290.c379dc",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Process message",
        "links": [
            "5581481b.706b38"
        ],
        "x": 1815,
        "y": 3520,
        "wires": []
    },
    {
        "id": "2cd9581b.de63b8",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Other user messages",
        "info": "",
        "x": 1900,
        "y": 3480,
        "wires": []
    },
    {
        "id": "2caa3ca0.e8c6a4",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Start",
        "info": "",
        "x": 1750,
        "y": 3320,
        "wires": []
    },
    {
        "id": "c255e784.8ab028",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Start or admin or message",
        "property": "message",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "/start",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "/admin",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 1320,
        "y": 3440,
        "wires": [
            [
                "712534ba.03dabc"
            ],
            [
                "ebcc50de.24dfc"
            ],
            [
                "5079e290.c379dc"
            ]
        ]
    },
    {
        "id": "7e88b121.6fb1e",
        "type": "http in",
        "z": "dbbd86af.74c0d8",
        "name": "",
        "url": "/bot",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 220,
        "y": 800,
        "wires": [
            [
                "1c133d73.d7c5c3",
                "13e44bbe.022ec4",
                "be1ed164.1521d"
            ]
        ]
    },
    {
        "id": "58ada314.42903c",
        "type": "function",
        "z": "96f6108e.64a37",
        "name": "Registering new user row in db",
        "func": "msg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users\";\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\nmsg.payload = {\n    \"id\": msg.chat_id,\n    \"username\": msg.username,\n    \"state\": {\"state\" : \"created\"}\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1690,
        "y": 120,
        "wires": [
            [
                "a67c174.729e1e8",
                "d9be97f3.f863e8"
            ]
        ]
    },
    {
        "id": "3038c760.952438",
        "type": "debug",
        "z": "96f6108e.64a37",
        "name": "Registering new user response from db",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2300,
        "y": 200,
        "wires": []
    },
    {
        "id": "502c79bf.c60c68",
        "type": "link in",
        "z": "df5e43cb.b674f",
        "name": "Print main menu",
        "links": [
            "9d38cfeb.72544",
            "cfe6162e.b07178",
            "fee03af4.838098",
            "76361c43.ee74f4",
            "59d394d6.305dac",
            "3dff8462.4ec1dc",
            "423e195b.dec3f8",
            "beaeab00.e10d98"
        ],
        "x": 195,
        "y": 160,
        "wires": [
            [
                "e26cee31.fdd81"
            ]
        ]
    },
    {
        "id": "e26cee31.fdd81",
        "type": "function",
        "z": "df5e43cb.b674f",
        "name": "Setting up message with main menu",
        "func": "msg.payload_user = msg.payload;\n\nmsg.payload = {\n    text: \"‚úÖ –í–∏ –≤ –≥–æ–ª–æ–≤–Ω–æ–º—É –º–µ–Ω—é. –ó–∞–¥–∞–≤–∞–π—Ç–µ –ø–∏—Ç–∞–Ω–Ω—è —á–∏ –æ–±–µ—Ä—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –ø—É–Ω–∫—Ç\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–ù–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à—ñ –ø–∏—Ç–∞–Ω–Ω—è üî•\",\n                callback_data: \"theMostPopularQuestions\"            \n            }], \n            [{\n                text: \"–ü—Ä–æ –∫–∞—Ñ–µ–¥—Ä—É ICM üòé\",\n                callback_data: \"AboutISM\"            \n            },\n            {\n                text: \"–ü—Ä–æ –ù–£–õ–ü üöÄ\",\n                callback_data: \"AboutNULP\"            \n            }],\n            [{\n                text: \"–Ø–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ç–∏—Å—è –±–æ—Ç–æ–º üìÅ\",\n                callback_data: \"HowToUseBot\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nif (msg.payload_user.user.role_name.includes(\"admin\")) {\n    msg.payload.reply_markup.inline_keyboard.push([{\n        text: \"–ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å\",\n        callback_data: \"adminMenu\"\n    }]);\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 450,
        "y": 160,
        "wires": [
            [
                "744eb46c.1a166c"
            ]
        ]
    },
    {
        "id": "a3e54823.a72818",
        "type": "comment",
        "z": "df5e43cb.b674f",
        "name": "Message with main menu",
        "info": "",
        "x": 290,
        "y": 120,
        "wires": []
    },
    {
        "id": "744eb46c.1a166c",
        "type": "subflow:411ddac8.164cb4",
        "z": "df5e43cb.b674f",
        "name": "",
        "env": [],
        "x": 790,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "58a6af09.78559",
        "type": "function",
        "z": "696b129b.360e0c",
        "name": "Is registration completed",
        "func": "if (msg.payload.user.role_name != \"admin\") {\n    if (msg.payload.user.state.state == \"created\" || msg.payload.user.state.state == \"username\") {\n        //for the next question\n        msg.text = \"–ß–∏ –º–æ–∂—É —è –¥–æ –≤–∞—Å –∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—è \" + msg.first_name + \" \" + msg.last_name + \"?\";\n        \n        return [msg, null, null, null];\n    } else if (msg.payload.user.state.state == \"location\") {\n        //for the next question\n        msg.text = \"–î–µ –≤–∏ –ø—Ä–æ–∂–∏–≤–∞—î—Ç–µ?\";\n        \n        return [null, msg, null, null];\n    } else if (msg.payload.user.state.state == \"occupation\") {\n        //for the next question\n        msg.text = \"–î–ª—è –∫—Ä–∞—â–æ–≥–æ –ø—ñ–¥–±–æ—Ä—É FAQ üìä –≤–∏–±–µ—Ä—ñ—Ç—å —Å–≤—ñ–π –≤–∏–¥ –∑–∞–π–Ω—è—Ç–æ—Å—Ç—ñ\";\n        \n        return [null, null, msg, null];\n    }\n}\n\nreturn [null, null, null, msg];",
        "outputs": 4,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 890,
        "y": 320,
        "wires": [
            [
                "b62113f8.d98b5"
            ],
            [
                "25ba409f.99d92"
            ],
            [
                "1b5b2acd.749c85"
            ],
            [
                "beaeab00.e10d98"
            ]
        ],
        "inputLabels": [
            "Checking whether the registration is completed"
        ],
        "outputLabels": [
            "Move on to setting the username field again",
            "Move on to setting the location field again",
            "Move on to setting the occupation field again",
            "Send main menu message"
        ]
    },
    {
        "id": "25ba409f.99d92",
        "type": "link out",
        "z": "696b129b.360e0c",
        "name": "Move on to setting the location field again",
        "links": [
            "1835ced7.6011d1"
        ],
        "x": 1195,
        "y": 260,
        "wires": []
    },
    {
        "id": "1b5b2acd.749c85",
        "type": "link out",
        "z": "696b129b.360e0c",
        "name": "Move on to setting the occupation field again",
        "links": [
            "62bdcfd6.d166e"
        ],
        "x": 1195,
        "y": 380,
        "wires": []
    },
    {
        "id": "beaeab00.e10d98",
        "type": "link out",
        "z": "696b129b.360e0c",
        "name": "Send main menu message",
        "links": [
            "f1be3b15.c41ab8",
            "502c79bf.c60c68"
        ],
        "x": 1195,
        "y": 500,
        "wires": []
    },
    {
        "id": "4f8a25d5.b0636c",
        "type": "comment",
        "z": "696b129b.360e0c",
        "name": "Send main menu message",
        "info": "",
        "x": 1290,
        "y": 460,
        "wires": []
    },
    {
        "id": "4d1e8f79.27d3c",
        "type": "link in",
        "z": "696b129b.360e0c",
        "name": "Is registration completed",
        "links": [
            "452a3d2.72b81c4",
            "65f19cea.cc3ef4",
            "a26ae768.2eea48",
            "18a42917.130a67",
            "c93fac14.b4c41",
            "aa4734c9.318da8"
        ],
        "x": 355,
        "y": 320,
        "wires": [
            [
                "58a6af09.78559"
            ]
        ]
    },
    {
        "id": "4ce7c89d.99df08",
        "type": "comment",
        "z": "696b129b.360e0c",
        "name": "Move on to setting the location field again",
        "info": "",
        "x": 1340,
        "y": 220,
        "wires": []
    },
    {
        "id": "4ec2269f.2800f8",
        "type": "comment",
        "z": "696b129b.360e0c",
        "name": "Move on to setting the occupation field again",
        "info": "",
        "x": 1350,
        "y": 340,
        "wires": []
    },
    {
        "id": "eec829d9.ecc588",
        "type": "comment",
        "z": "696b129b.360e0c",
        "name": "Checking whether the registration is completed",
        "info": "",
        "x": 520,
        "y": 280,
        "wires": []
    },
    {
        "id": "62f23a28.fa8414",
        "type": "comment",
        "z": "696b129b.360e0c",
        "name": "Move on to setting the username field again",
        "info": "",
        "x": 1350,
        "y": 100,
        "wires": []
    },
    {
        "id": "65f19cea.cc3ef4",
        "type": "link out",
        "z": "96f6108e.64a37",
        "name": "Is registration completed",
        "links": [
            "4d1e8f79.27d3c"
        ],
        "x": 1575,
        "y": 300,
        "wires": []
    },
    {
        "id": "7c78aa7a.0ce5a4",
        "type": "comment",
        "z": "96f6108e.64a37",
        "name": "Check whether the registration is completed",
        "info": "",
        "x": 1730,
        "y": 260,
        "wires": []
    },
    {
        "id": "a009902e.25a1b",
        "type": "subflow:411ddac8.164cb4",
        "z": "696b129b.360e0c",
        "name": "",
        "env": [],
        "x": 2390,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "e074a2a5.84fdc",
        "type": "function",
        "z": "696b129b.360e0c",
        "name": "Setting up request message to set username",
        "func": "msg.payload = {\n    text: msg.text,\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–¢–∞–∫, –∑–≤—ñ—Å–Ω–æ\",\n                callback_data: \"setCurrentName\"\n            }, \n            {\n                text: \"–Ø —Ö–æ—á—É –∑–º—ñ–Ω–∏—Ç–∏\",\n                callback_data: \"setName\"\n            }]\n        ]\n    },\n    chat_id: msg.chat_id,\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2010,
        "y": 140,
        "wires": [
            [
                "a009902e.25a1b"
            ]
        ]
    },
    {
        "id": "5c5914e5.d60a4c",
        "type": "function",
        "z": "d3d080fa.62628",
        "name": "Setting up next or last question",
        "func": "msg.payload = {\n    text: (msg.message+1) + \". \" + msg.payload.questions[msg.message].question + \"\\n\\n–í—ñ–¥–ø–æ–≤—ñ–¥—å:\\n\" + msg.payload.questions[msg.message].answer,\n    chat_id: msg.chat_id,\n    message_id: msg.message_id,\n    reply_markup: {\n        inline_keyboard: [[]]\n    },\n}\n\nif (msg.message > 0) {\n    msg.payload.reply_markup.inline_keyboard[0].push({\n                text: \"‚óÄ –ù–∞–∑–∞–¥\",\n                callback_data: \"theMostPopularQPagination_\" + (msg.message - 1)\n            });\n}\n\nif (msg.message < 4) {\n    msg.payload.reply_markup.inline_keyboard[0].push({\n                text: \"–î–∞–ª—ñ ‚ñ∂\",\n                callback_data: \"theMostPopularQPagination_\" + (msg.message + 1)\n            });\n}\n\nmsg.payload.reply_markup.inline_keyboard.push([{\n        text: \"‚óÄ –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é\",\n        callback_data: \"mainMenu\"\n    }]);\n\nif (msg.sendAsASimpleMessage) return [msg, null];\nelse return [null, msg];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1050,
        "y": 180,
        "wires": [
            [
                "d5c114ce.369d48"
            ],
            [
                "9fc24cee.822f5"
            ]
        ]
    },
    {
        "id": "5b820640.b7dcf8",
        "type": "comment",
        "z": "d3d080fa.62628",
        "name": "Setting up answer to next or last or first question(pagination)",
        "info": "",
        "x": 420,
        "y": 140,
        "wires": []
    },
    {
        "id": "9fc24cee.822f5",
        "type": "change",
        "z": "d3d080fa.62628",
        "name": "Setting up editMessageText url",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "\"https://api.telegram.org/bot\" & $env('TOKEN') & \"/editMessageText\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1390,
        "y": 300,
        "wires": [
            [
                "43f8240a.a3c04c"
            ]
        ]
    },
    {
        "id": "43f8240a.a3c04c",
        "type": "http request",
        "z": "d3d080fa.62628",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "basic",
        "x": 1670,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "db785c0e.a93d6",
        "type": "link in",
        "z": "d3d080fa.62628",
        "name": "Set answer to question(pagination)",
        "links": [
            "44ca7e7d.f7226",
            "d7b8d232.f7981"
        ],
        "x": 215,
        "y": 180,
        "wires": [
            [
                "393aa544.3be7ba"
            ]
        ]
    },
    {
        "id": "393aa544.3be7ba",
        "type": "function",
        "z": "d3d080fa.62628",
        "name": "Getting info from questions",
        "func": "msg.sendAsASimpleMessage = false;\n\nif (msg.message.startsWith(\"theMostPopularQPagination_\")) {\n    msg.message = parseInt(msg.message.split(\"_\")[1]);\n} else {\n    msg.message = 0;\n    \n    msg.sendAsASimpleMessage = true;\n}\n\nmsg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/questions/faq?questions_amount=5\";\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 440,
        "y": 180,
        "wires": [
            [
                "ffff4207.4cbe7"
            ]
        ]
    },
    {
        "id": "255971.a036369",
        "type": "link in",
        "z": "276bc02d.e347",
        "name": "Send message with page info",
        "links": [
            "84602d83.794bf"
        ],
        "x": 75,
        "y": 100,
        "wires": [
            [
                "7d62bb88.a5bb24"
            ]
        ]
    },
    {
        "id": "dd7e88ad.066828",
        "type": "function",
        "z": "276bc02d.e347",
        "name": "Setting up message info",
        "func": "msg.payload = {\n    parse_mode: \"html\",\n    text: msg.payload.settings.value,\n    chat_id: msg.chat_id,\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"‚óÄ –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é\",\n                callback_data: \"mainMenu\"\n            }]\n        ]\n    },\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 910,
        "y": 100,
        "wires": [
            [
                "a38f117b.4a1c1"
            ]
        ]
    },
    {
        "id": "640de173.48ae8",
        "type": "comment",
        "z": "276bc02d.e347",
        "name": "Message with page Info",
        "info": "",
        "x": 160,
        "y": 60,
        "wires": []
    },
    {
        "id": "7d62bb88.a5bb24",
        "type": "function",
        "z": "276bc02d.e347",
        "name": "Getting info from InfoPages",
        "func": "msg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/settings/get?name=\" + msg.message;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 100,
        "wires": [
            [
                "9ad5d228.d8ffb"
            ]
        ]
    },
    {
        "id": "b8e30ec7.7d583",
        "type": "debug",
        "z": "276bc02d.e347",
        "name": "Getting info from InfoPage response from db",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 850,
        "y": 180,
        "wires": []
    },
    {
        "id": "a38f117b.4a1c1",
        "type": "subflow:411ddac8.164cb4",
        "z": "276bc02d.e347",
        "name": "",
        "env": [],
        "x": 1230,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "336efa19.615be6",
        "type": "subflow:4001764a.8341f8",
        "z": "dbbd86af.74c0d8",
        "name": "",
        "env": [],
        "x": 650,
        "y": 3280,
        "wires": [
            [
                "43383010.7a91f"
            ]
        ]
    },
    {
        "id": "d5c114ce.369d48",
        "type": "subflow:411ddac8.164cb4",
        "z": "d3d080fa.62628",
        "name": "",
        "env": [],
        "x": 1390,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "de1e2237.23c0a",
        "type": "function",
        "z": "96f6108e.64a37",
        "name": "Getting user row",
        "func": "msg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users/\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 600,
        "y": 220,
        "wires": [
            [
                "a092bba8.d7b3c8"
            ]
        ]
    },
    {
        "id": "a092bba8.d7b3c8",
        "type": "http request",
        "z": "96f6108e.64a37",
        "name": "",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 810,
        "y": 220,
        "wires": [
            [
                "41e89314.19813c",
                "776fd5bc.aa182c"
            ]
        ]
    },
    {
        "id": "a67c174.729e1e8",
        "type": "http request",
        "z": "96f6108e.64a37",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 2010,
        "y": 120,
        "wires": [
            [
                "3038c760.952438",
                "cab5fa05.8972f8"
            ]
        ]
    },
    {
        "id": "4a21bcb4.3b48f4",
        "type": "http request",
        "z": "4c6874fb.68b9dc",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 690,
        "y": 160,
        "wires": [
            [
                "4d10c364.bba70c",
                "f553be12.15931"
            ]
        ]
    },
    {
        "id": "36cbe213.34e8fe",
        "type": "http request",
        "z": "4c6874fb.68b9dc",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 2750,
        "y": 160,
        "wires": [
            [
                "29b87cf7.8de694"
            ]
        ]
    },
    {
        "id": "14d25b8f.4b64c4",
        "type": "http request",
        "z": "3b5b98a.1c38768",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 1490,
        "y": 140,
        "wires": [
            [
                "c6df9017.a5565"
            ]
        ]
    },
    {
        "id": "57f0180.55088e8",
        "type": "http request",
        "z": "68a30d94.469f94",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 2970,
        "y": 280,
        "wires": [
            [
                "bfff6d3f.b5c17",
                "59d394d6.305dac"
            ]
        ]
    },
    {
        "id": "1001a33d.d9504d",
        "type": "function",
        "z": "68a30d94.469f94",
        "name": "Set occupation field",
        "func": "msg.method = \"PUT\"\nmsg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users?id=\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\nmsg.payload = {\n    \"type_name\": msg.occupation,\n    \"state\": {\"state\": \"registered\"}\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2730,
        "y": 280,
        "wires": [
            [
                "57f0180.55088e8"
            ]
        ]
    },
    {
        "id": "858f85dd.43b438",
        "type": "http request",
        "z": "cbf72f33.63dd6",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 1790,
        "y": 180,
        "wires": [
            [
                "bba92257.ecedb"
            ]
        ]
    },
    {
        "id": "2d8d4f52.fd9d1",
        "type": "http request",
        "z": "cbf72f33.63dd6",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 1790,
        "y": 380,
        "wires": [
            [
                "76dc39c7.1f1908"
            ]
        ]
    },
    {
        "id": "ffff4207.4cbe7",
        "type": "http request",
        "z": "d3d080fa.62628",
        "name": "",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 710,
        "y": 180,
        "wires": [
            [
                "5c5914e5.d60a4c"
            ]
        ]
    },
    {
        "id": "bb4c4877.8d7198",
        "type": "http request",
        "z": "cbf72f33.63dd6",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 3610,
        "y": 780,
        "wires": [
            [
                "a6c076cb.782348",
                "44bde95d.ab5328"
            ]
        ]
    },
    {
        "id": "9ad5d228.d8ffb",
        "type": "http request",
        "z": "276bc02d.e347",
        "name": "",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 570,
        "y": 100,
        "wires": [
            [
                "dd7e88ad.066828",
                "b8e30ec7.7d583"
            ]
        ]
    },
    {
        "id": "ebcc50de.24dfc",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Admin permission check",
        "links": [
            "10bc7ce3.c92493"
        ],
        "x": 1815,
        "y": 3440,
        "wires": []
    },
    {
        "id": "39c371c1.697aee",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Admin",
        "info": "",
        "x": 1850,
        "y": 3400,
        "wires": []
    },
    {
        "id": "10bc7ce3.c92493",
        "type": "link in",
        "z": "14785f2b.3d2341",
        "name": "Admin permission check",
        "links": [
            "ebcc50de.24dfc"
        ],
        "x": 215,
        "y": 320,
        "wires": [
            [
                "16abb23a.271dde"
            ]
        ]
    },
    {
        "id": "d5cd829c.4da0d",
        "type": "link in",
        "z": "27a4d84f.90dc58",
        "name": "Admin authentication",
        "links": [
            "94a275bf.bc4bf8"
        ],
        "x": 195,
        "y": 100,
        "wires": [
            [
                "2c09c454.955c1c"
            ]
        ]
    },
    {
        "id": "b9b30aa4.913de8",
        "type": "comment",
        "z": "27a4d84f.90dc58",
        "name": "Admin authentication",
        "info": "",
        "x": 280,
        "y": 60,
        "wires": []
    },
    {
        "id": "2c09c454.955c1c",
        "type": "function",
        "z": "27a4d84f.90dc58",
        "name": "Setting up message with main menu",
        "func": "msg.payload = {\n    text: \"–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å\",\n    chat_id: msg.chat_id\n}\n\n//means admin authentication process\nglobal.set((\"admins.\" + msg.chat_id), \"authentication\");\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 450,
        "y": 100,
        "wires": [
            [
                "f4cf9845.c9c9e8"
            ]
        ]
    },
    {
        "id": "f4cf9845.c9c9e8",
        "type": "subflow:411ddac8.164cb4",
        "z": "27a4d84f.90dc58",
        "name": "",
        "env": [],
        "x": 810,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "dae42a0e.30b798",
        "type": "link in",
        "z": "741a84b0.eaaafc",
        "name": "Process admin message",
        "links": [
            "5aa25e4d.afa2f"
        ],
        "x": 175,
        "y": 280,
        "wires": [
            [
                "f444d784.4b3ec8"
            ]
        ]
    },
    {
        "id": "1ef275a0.a014aa",
        "type": "comment",
        "z": "741a84b0.eaaafc",
        "name": "Process admin message",
        "info": "",
        "x": 270,
        "y": 240,
        "wires": []
    },
    {
        "id": "174b2f09.720ee1",
        "type": "link in",
        "z": "74e0bd75.30b964",
        "name": "Send admin menu",
        "links": [
            "251e1dc6.f7dae2",
            "a0263de3.c8c3d",
            "6fc70e3b.e2da2",
            "16626079.4e26d",
            "416afadd.7a16f4",
            "59c43f49.d05c1"
        ],
        "x": 195,
        "y": 180,
        "wires": [
            [
                "3ec1dc48.121724"
            ]
        ]
    },
    {
        "id": "f8c321de.c69c",
        "type": "comment",
        "z": "74e0bd75.30b964",
        "name": "Sending admin menu",
        "info": "",
        "x": 280,
        "y": 140,
        "wires": []
    },
    {
        "id": "ee6a100.26f8bf",
        "type": "subflow:411ddac8.164cb4",
        "z": "74e0bd75.30b964",
        "name": "",
        "env": [],
        "x": 1510,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "7a6c7bed.6c8544",
        "type": "function",
        "z": "74e0bd75.30b964",
        "name": "Setting up message with admin menu",
        "func": "msg.payload = {\n    text: \"–í–∏ –≤ –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—ñ. –í–∏–±–µ—Ä—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –ø—É–Ω–∫—Ç\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\",\n                callback_data: \"statistics\"            \n            }], \n            [{\n                text: \"–†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ ICM üòé\",\n                callback_data: \"editInfo_AboutISM\"            \n            }],\n            [{\n                text: \"–†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –ù–£–õ–ü üöÄ\",\n                callback_data: \"editInfo_AboutNULP\"            \n            }],\n            [{\n                text: \"–Ø–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ç–∏—Å—è –±–æ—Ç–æ–º üìÅ\",\n                callback_data: \"editInfo_HowToUseBot\"            \n            }],\n            [{\n                text: \"–û–Ω–æ–≤–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ –ø–∏—Ç–∞–Ω—å üîÑ\",\n                callback_data: \"syncFAQ\"            \n            }],\n            [{\n                text: \"–ú–∞—Å–æ–≤–∞ —Ä–æ–∑—Å–∏–ª–∫–∞ üì©\",\n                callback_data: \"distribution\"            \n            }],\n            [{\n                text: \"‚óÄ –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é\",\n                callback_data: \"mainMenu\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nif (msg.payload_admin.user.role_name == \"super-admin\") {\n    msg.payload.reply_markup.inline_keyboard.pop();\n    \n    msg.payload.reply_markup.inline_keyboard.push(\n        [{\n            text: \"–ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –∞–¥–º—ñ–Ω—ñ–≤ üë®‚Äç‚öñÔ∏è\",\n            callback_data: \"adminManagement\"\n        }],\n        [{\n            text: \"‚óÄ –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é\",\n            callback_data: \"mainMenu\"            \n        }]);\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1150,
        "y": 180,
        "wires": [
            [
                "ee6a100.26f8bf"
            ]
        ]
    },
    {
        "id": "feea9f00.ef13e",
        "type": "comment",
        "z": "14785f2b.3d2341",
        "name": "Checking permissions",
        "info": "",
        "x": 300,
        "y": 280,
        "wires": []
    },
    {
        "id": "5cdcad90.c84254",
        "type": "function",
        "z": "68a30d94.469f94",
        "name": "Changing state field to 'occupation'",
        "func": "msg.method = \"PUT\"\nmsg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users?id=\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\nmsg.payload = {\n    \"state\": {\"state\": \"occupation\"}\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1240,
        "y": 300,
        "wires": [
            [
                "993855d7.043228"
            ]
        ]
    },
    {
        "id": "993855d7.043228",
        "type": "http request",
        "z": "68a30d94.469f94",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 1530,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "b62113f8.d98b5",
        "type": "function",
        "z": "696b129b.360e0c",
        "name": "Changing state filed to 'created'",
        "func": "msg.method = \"PUT\"\nmsg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users?id=\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\nmsg.payload = {\n    \"state\": {\"state\": \"created\"}\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1310,
        "y": 140,
        "wires": [
            [
                "b36044b0.dd6018"
            ]
        ]
    },
    {
        "id": "b36044b0.dd6018",
        "type": "http request",
        "z": "696b129b.360e0c",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 1590,
        "y": 140,
        "wires": [
            [
                "e074a2a5.84fdc"
            ]
        ]
    },
    {
        "id": "a5af100c.3c9e6",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Callback admin query events",
        "property": "message",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "adminMenu",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "statistics",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "theMostPopularQuestionsForAdmin",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "totalNumberOfUsers",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "groupsMenuNumberOfUsers",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "distribution",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "writeMessageForDistribution",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "sendMessageEditingDistribution",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "editGroupsForDistribution",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "goToCompleteDistributionMessage",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "completeDistribution",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "adminManagement",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "addAdmin",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "adminsForDelete",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "syncFAQ",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "unansweredQuestions",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "clearUnansweredQuestionsList",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 17,
        "x": 1500,
        "y": 1440,
        "wires": [
            [
                "16626079.4e26d"
            ],
            [
                "441568f.2e4a998"
            ],
            [
                "857490ee.89b9d"
            ],
            [
                "384d9cd0.c20d84"
            ],
            [
                "88664c92.b9374"
            ],
            [
                "fb5c0751.e781d8"
            ],
            [
                "b1199913.726ea8"
            ],
            [
                "e3531219.e2e16"
            ],
            [
                "b0b82aef.d9adc8"
            ],
            [
                "8ffc49f3.7d4878"
            ],
            [
                "ef489044.60ce5"
            ],
            [
                "d5772bfb.1db3b8"
            ],
            [
                "e3ee6ca3.b886c"
            ],
            [
                "22333f69.fdca5"
            ],
            [
                "fd270046.426d4"
            ],
            [
                "284c3f7b.7c2f8"
            ],
            [
                "f1c3ab8.d32b458"
            ]
        ]
    },
    {
        "id": "441568f.2e4a998",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send admin statistics menu",
        "links": [
            "e6b71aba.a6e668"
        ],
        "x": 1775,
        "y": 1240,
        "wires": []
    },
    {
        "id": "1314e790.78d638",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send admin statistics menu",
        "info": "",
        "x": 1880,
        "y": 1200,
        "wires": []
    },
    {
        "id": "e6b71aba.a6e668",
        "type": "link in",
        "z": "892838ee.3ab438",
        "name": "Send admin statistics menu",
        "links": [
            "441568f.2e4a998"
        ],
        "x": 175,
        "y": 100,
        "wires": [
            [
                "62fb6121.5b6d6"
            ]
        ]
    },
    {
        "id": "69997a3a.806a74",
        "type": "comment",
        "z": "892838ee.3ab438",
        "name": "Sending admin statistics menu",
        "info": "",
        "x": 290,
        "y": 60,
        "wires": []
    },
    {
        "id": "62fb6121.5b6d6",
        "type": "function",
        "z": "892838ee.3ab438",
        "name": "Setting up message with admin statistics menu",
        "func": "msg.payload = {\n    text: \"–í–∏–±–µ—Ä—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –ø—É–Ω–∫—Ç üìä\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–ù–∞–π–±—ñ–ª—å—à –ø–æ—à–∏—Ä–µ–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è\",\n                callback_data: \"theMostPopularQuestionsForAdmin\"            \n            }],\n            [{\n                text: \"–ü–∏—Ç–∞–Ω–Ω—è –±–µ–∑ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ\",\n                callback_data: \"unansweredQuestions\"            \n            }],\n            [{\n                text: \"–û—á–∏—Å—Ç–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ –ø–∏—Ç–∞–Ω–Ω—å –±–µ–∑ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ\",\n                callback_data: \"clearUnansweredQuestionsList\"            \n            }],\n            [{\n                text: \"–ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤\",\n                callback_data: \"totalNumberOfUsers\"            \n            }],\n            [{\n                text: \"–ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –ø–µ–≤–Ω–æ—ó –≥—Ä—É–ø–∏\",\n                callback_data: \"groupsMenuNumberOfUsers\"            \n            }],\n            [{\n                text: \"‚è™ –ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å\",\n                callback_data: \"adminMenu\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 480,
        "y": 100,
        "wires": [
            [
                "ef71566a.78a108"
            ]
        ]
    },
    {
        "id": "ef71566a.78a108",
        "type": "subflow:411ddac8.164cb4",
        "z": "892838ee.3ab438",
        "name": "",
        "x": 870,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "384d9cd0.c20d84",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Get total number of users",
        "links": [
            "fa6195ba.f6b108"
        ],
        "x": 1775,
        "y": 1400,
        "wires": []
    },
    {
        "id": "b83bf345.f41b6",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Get total number of users",
        "info": "",
        "x": 1870,
        "y": 1360,
        "wires": []
    },
    {
        "id": "fa6195ba.f6b108",
        "type": "link in",
        "z": "892838ee.3ab438",
        "name": "Get total number of users",
        "links": [
            "384d9cd0.c20d84",
            "1efe31e6.57de7e"
        ],
        "x": 175,
        "y": 460,
        "wires": [
            [
                "b21b9fd9.f3f67"
            ]
        ]
    },
    {
        "id": "9cefd413.fc1df8",
        "type": "comment",
        "z": "892838ee.3ab438",
        "name": "Getting total number of users",
        "info": "",
        "x": 280,
        "y": 420,
        "wires": []
    },
    {
        "id": "b21b9fd9.f3f67",
        "type": "function",
        "z": "892838ee.3ab438",
        "name": "Getting total number of users",
        "func": "var group = \"\";\nif (msg.message.split('_')[1]) {\n    group = \"?type_name=\" + msg.message.split('_')[1];\n}\n\nmsg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users/statistics\" + group;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 460,
        "wires": [
            [
                "38d61daa.3cd252"
            ]
        ]
    },
    {
        "id": "84ca21f9.36fa6",
        "type": "function",
        "z": "892838ee.3ab438",
        "name": "Setting up message with total number of users",
        "func": "msg.payload = {\n    text: \"–ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤: \" + msg.payload.usersAmount,\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"‚óÄ –ù–∞–∑–∞–¥\",\n                callback_data: \"statistics\"            \n            }],\n            [{\n                text: \"‚è™ –ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å\",\n                callback_data: \"adminMenu\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1120,
        "y": 460,
        "wires": [
            [
                "3ef52885.a11438"
            ]
        ]
    },
    {
        "id": "3ef52885.a11438",
        "type": "subflow:411ddac8.164cb4",
        "z": "892838ee.3ab438",
        "name": "",
        "x": 1510,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "38d61daa.3cd252",
        "type": "http request",
        "z": "892838ee.3ab438",
        "name": "",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 690,
        "y": 460,
        "wires": [
            [
                "84ca21f9.36fa6"
            ]
        ]
    },
    {
        "id": "1efe31e6.57de7e",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send number of users of a group",
        "links": [
            "fa6195ba.f6b108"
        ],
        "x": 1795,
        "y": 2720,
        "wires": []
    },
    {
        "id": "6f51c3f6.40991c",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send number of users of a group",
        "info": "",
        "x": 1910,
        "y": 2680,
        "wires": []
    },
    {
        "id": "4acba4db.21b67c",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Admin users statistics of groups",
        "property": "$split(msg.message, \"_\", 1)",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "eq",
                "v": "numberOfUsersOfAGroup",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1330,
        "y": 2720,
        "wires": [
            [
                "1efe31e6.57de7e"
            ]
        ]
    },
    {
        "id": "e73d99f1.c57c58",
        "type": "link in",
        "z": "892838ee.3ab438",
        "name": "Send menu with groups (number of users)",
        "links": [
            "88664c92.b9374"
        ],
        "x": 175,
        "y": 600,
        "wires": [
            [
                "3e97624e.e1943e"
            ]
        ]
    },
    {
        "id": "febae297.ef2cf",
        "type": "comment",
        "z": "892838ee.3ab438",
        "name": "Sending menu with groups (number of users)",
        "info": "",
        "x": 330,
        "y": 560,
        "wires": []
    },
    {
        "id": "3e97624e.e1943e",
        "type": "function",
        "z": "892838ee.3ab438",
        "name": "Setting up message with menu with groups",
        "func": "msg.payload = {\n    text: \"–í–∏–±–µ—Ä—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –ø—É–Ω–∫—Ç üìä\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–ê–±—ñ—Ç—É—Ä—ñ—î–Ω—Ç\",\n                callback_data: \"numberOfUsersOfAGroup_Applicant\"            \n            }, \n            {\n                text: \"–û–¥–∏–Ω –∑ –±–∞—Ç—å–∫—ñ–≤\",\n                callback_data: \"numberOfUsersOfAGroup_Parent\"            \n            }],\n            [{\n                text: \"–í–∏–∫–ª–∞–¥–∞—á\",\n                callback_data: \"numberOfUsersOfAGroup_Teacher\"            \n            },\n            {\n                text: \"–°—Ç—É–¥–µ–Ω—Ç\",\n                callback_data: \"numberOfUsersOfAGroup_Student\"            \n            }],\n            [{\n                text: \"–Ü–Ω—à–µ\",\n                callback_data: \"numberOfUsersOfAGroup_Other\"            \n            }],\n            [{\n                text: \"‚óÄ –ù–∞–∑–∞–¥\",\n                callback_data: \"statistics\"            \n            }],\n            [{\n                text: \"‚è™ –ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å\",\n                callback_data: \"adminMenu\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 470,
        "y": 600,
        "wires": [
            [
                "88c9da92.3faac8"
            ]
        ]
    },
    {
        "id": "88c9da92.3faac8",
        "type": "subflow:411ddac8.164cb4",
        "z": "892838ee.3ab438",
        "name": "",
        "x": 850,
        "y": 600,
        "wires": [
            []
        ]
    },
    {
        "id": "88664c92.b9374",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send menu with groups (number of users)",
        "links": [
            "e73d99f1.c57c58"
        ],
        "x": 1775,
        "y": 1480,
        "wires": []
    },
    {
        "id": "a193e222.7975b",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send menu with groups (number of users)",
        "info": "",
        "x": 1920,
        "y": 1440,
        "wires": []
    },
    {
        "id": "16626079.4e26d",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send admin menu",
        "links": [
            "174b2f09.720ee1"
        ],
        "x": 1775,
        "y": 1140,
        "wires": []
    },
    {
        "id": "c4e635cf.389bf8",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send admin menu",
        "info": "",
        "x": 1850,
        "y": 1100,
        "wires": []
    },
    {
        "id": "78e346f1.8e8b28",
        "type": "function",
        "z": "892838ee.3ab438",
        "name": "Setting up next or last question",
        "func": "msg.payload = {\n    text: (msg.message+1) + \". \" + msg.payload.questions[msg.message].question + \"\\n\\n–ó–∞–¥–∞–Ω–æ: \" + msg.payload.questions[msg.message].stats + \"\\n\\n–í—ñ–¥–ø–æ–≤—ñ–¥—å:\\n\" + msg.payload.questions[msg.message].answer,\n    chat_id: msg.chat_id,\n    message_id: msg.message_id,\n    reply_markup: {\n        inline_keyboard: [[]]\n    },\n};\n\nif (msg.message > 0) {\n    msg.payload.reply_markup.inline_keyboard[0].push({\n                text: \"‚óÄ –ù–∞–∑–∞–¥\",\n                callback_data: \"theMostPopularQPaginationForAdmin_\" + (msg.message - 1)\n            });\n}\n\nif (msg.message < 4) {\n    msg.payload.reply_markup.inline_keyboard[0].push({\n                text: \"–î–∞–ª—ñ ‚ñ∂\",\n                callback_data: \"theMostPopularQPaginationForAdmin_\" + (msg.message + 1)\n            });\n}\n\nmsg.payload.reply_markup.inline_keyboard.push([{\n        text: \"‚óÄ –ù–∞–∑–∞–¥ –¥–æ –º–µ–Ω—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏\",\n        callback_data: \"statistics\"            \n    }])\n\nmsg.payload.reply_markup.inline_keyboard.push([{\n        text: \"‚è™ –ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å\",\n        callback_data: \"adminMenu\"\n    }]);\n\nif (msg.sendAsASimpleMessage) return [msg, null];\nelse return [null, msg];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1010,
        "y": 240,
        "wires": [
            [
                "230ea498.065ddc"
            ],
            [
                "2ef67ced.c751b4"
            ]
        ]
    },
    {
        "id": "206e324c.35e26e",
        "type": "comment",
        "z": "892838ee.3ab438",
        "name": "Setting up answer to next or last or first question for admin (pagination)",
        "info": "",
        "x": 410,
        "y": 200,
        "wires": []
    },
    {
        "id": "2ef67ced.c751b4",
        "type": "change",
        "z": "892838ee.3ab438",
        "name": "Setting up editMessageText url",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "\"https://api.telegram.org/bot\" & $env('TOKEN') & \"/editMessageText\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1350,
        "y": 360,
        "wires": [
            [
                "134eb23c.9aa8fe"
            ]
        ]
    },
    {
        "id": "134eb23c.9aa8fe",
        "type": "http request",
        "z": "892838ee.3ab438",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "basic",
        "x": 1630,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "4329a74.1062558",
        "type": "link in",
        "z": "892838ee.3ab438",
        "name": "Set answer to question for admin (pagination)",
        "links": [
            "857490ee.89b9d",
            "87c7d03d.ab97b"
        ],
        "x": 175,
        "y": 240,
        "wires": [
            [
                "6ca8bcf8.3c9544"
            ]
        ]
    },
    {
        "id": "6ca8bcf8.3c9544",
        "type": "function",
        "z": "892838ee.3ab438",
        "name": "Getting info from questions",
        "func": "msg.sendAsASimpleMessage = false;\n\nif (msg.message.startsWith(\"theMostPopularQPaginationForAdmin_\")) {\n    msg.message = parseInt(msg.message.split(\"_\")[1]);\n} else {\n    msg.message = 0;\n    \n    msg.sendAsASimpleMessage = true;\n}\n\nmsg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/questions/faq?questions_amount=5\";\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 400,
        "y": 240,
        "wires": [
            [
                "12232cbb.f802d3"
            ]
        ]
    },
    {
        "id": "230ea498.065ddc",
        "type": "subflow:411ddac8.164cb4",
        "z": "892838ee.3ab438",
        "name": "",
        "env": [],
        "x": 1350,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "12232cbb.f802d3",
        "type": "http request",
        "z": "892838ee.3ab438",
        "name": "",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 670,
        "y": 240,
        "wires": [
            [
                "78e346f1.8e8b28"
            ]
        ]
    },
    {
        "id": "857490ee.89b9d",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send the most popular questions for admin",
        "links": [
            "4329a74.1062558"
        ],
        "x": 1775,
        "y": 1320,
        "wires": []
    },
    {
        "id": "988b4bfe.7ceae8",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send the most popular questions for admin",
        "info": "",
        "x": 1920,
        "y": 1280,
        "wires": []
    },
    {
        "id": "a525eef0.3d2fc",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Set answer to popular question for admin (pagination)",
        "property": "$split(msg.message, \"_\", 1)",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "eq",
                "v": "theMostPopularQPaginationForAdmin",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1400,
        "y": 2820,
        "wires": [
            [
                "87c7d03d.ab97b"
            ]
        ]
    },
    {
        "id": "87c7d03d.ab97b",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Set answer to popular question(pagination)",
        "links": [
            "4329a74.1062558"
        ],
        "x": 1795,
        "y": 2820,
        "wires": []
    },
    {
        "id": "28ecb014.f4527",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Set answer to popular question(pagination)",
        "info": "",
        "x": 1940,
        "y": 2780,
        "wires": []
    },
    {
        "id": "84224ec9.c9393",
        "type": "switch",
        "z": "741a84b0.eaaafc",
        "name": "",
        "property": "msg.payload.user.state.state",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "cont",
                "v": "editingInfo",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "writingTextForDistribution",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 1150,
        "y": 280,
        "wires": [
            [
                "537142d8.31be7c"
            ],
            [
                "b736f0dc.7e744"
            ],
            [
                "fd9aa5ae.4abe08"
            ]
        ]
    },
    {
        "id": "e06e2c86.59eb2",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Start editing info",
        "info": "",
        "x": 1860,
        "y": 2880,
        "wires": []
    },
    {
        "id": "63b0881b.a8f938",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Start editing info",
        "property": "$split(msg.message, \"_\", 1)",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "eq",
                "v": "editInfo",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1280,
        "y": 2920,
        "wires": [
            [
                "b634643e.b6e4a8"
            ]
        ]
    },
    {
        "id": "b634643e.b6e4a8",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Start editing info",
        "links": [
            "6eb3f60a.d73ba8",
            "a9fa525e.2b40b"
        ],
        "x": 1795,
        "y": 2920,
        "wires": []
    },
    {
        "id": "6eb3f60a.d73ba8",
        "type": "link in",
        "z": "76bd89c2.eace48",
        "name": "Start editing info",
        "links": [
            "b634643e.b6e4a8"
        ],
        "x": 155,
        "y": 100,
        "wires": [
            [
                "3b51c244.f6a03e"
            ]
        ]
    },
    {
        "id": "a04c29.fed883d8",
        "type": "comment",
        "z": "76bd89c2.eace48",
        "name": "Start editing info",
        "info": "",
        "x": 220,
        "y": 60,
        "wires": []
    },
    {
        "id": "52968a19.95efe4",
        "type": "function",
        "z": "76bd89c2.eace48",
        "name": "Setting up message to write new text",
        "func": "msg.payload = {\n    text: \"–í–∫–∞–∂—ñ—Ç—å –Ω–æ–≤–∏–π —Ç–µ–∫—Å—Ç –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è üçì\",\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1250,
        "y": 100,
        "wires": [
            [
                "a840a40f.812458"
            ]
        ]
    },
    {
        "id": "a840a40f.812458",
        "type": "subflow:411ddac8.164cb4",
        "z": "76bd89c2.eace48",
        "name": "",
        "env": [],
        "x": 1630,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "537142d8.31be7c",
        "type": "link out",
        "z": "741a84b0.eaaafc",
        "name": "Edit info",
        "links": [
            "d609159f.a9e588"
        ],
        "x": 1335,
        "y": 180,
        "wires": []
    },
    {
        "id": "50e18887.cf9af8",
        "type": "comment",
        "z": "741a84b0.eaaafc",
        "name": "Edit info",
        "info": "",
        "x": 1380,
        "y": 140,
        "wires": []
    },
    {
        "id": "d609159f.a9e588",
        "type": "link in",
        "z": "76bd89c2.eace48",
        "name": "Edit info",
        "links": [
            "537142d8.31be7c",
            "f3b73302.b6bf3"
        ],
        "x": 155,
        "y": 240,
        "wires": [
            [
                "31e9048a.92614c"
            ]
        ]
    },
    {
        "id": "35e49a63.cf1266",
        "type": "comment",
        "z": "76bd89c2.eace48",
        "name": "Edit info",
        "info": "",
        "x": 200,
        "y": 200,
        "wires": []
    },
    {
        "id": "31e9048a.92614c",
        "type": "function",
        "z": "76bd89c2.eace48",
        "name": "Editing info",
        "func": "msg.method = \"PUT\";\nmsg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/settings/change\";\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\nmsg.payload = {\n    \"name\": msg.payload.user.state.state.split('_')[1],\n    \"value\": msg.message\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 350,
        "y": 240,
        "wires": [
            [
                "ca8a8ab0.459f08"
            ]
        ]
    },
    {
        "id": "ca8a8ab0.459f08",
        "type": "http request",
        "z": "76bd89c2.eace48",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 590,
        "y": 240,
        "wires": [
            [
                "8ef6a097.3e4e9"
            ]
        ]
    },
    {
        "id": "8ef6a097.3e4e9",
        "type": "switch",
        "z": "76bd89c2.eace48",
        "name": "If successful",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "success",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 870,
        "y": 240,
        "wires": [
            [
                "86b37728.c9ce98"
            ],
            [
                "7957d706.e73268"
            ]
        ]
    },
    {
        "id": "86b37728.c9ce98",
        "type": "function",
        "z": "76bd89c2.eace48",
        "name": "Setting up message about successful editing",
        "func": "msg.payload = {\n    text: \"–¢–µ–∫—Å—Ç —É—Å–ø—ñ—à–Ω–æ –∑–º—ñ–Ω–µ–Ω–æ\",\n    chat_id: msg.chat_id,\n    reply_markup: {\n        inline_keyboard: [\n            [{\n                text: \"‚è™ –ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å\",\n                callback_data: \"adminMenu\"\n            }]\n        ]\n    }\n}\n\nglobal.set((\"admins.\" + msg.chat_id), \"authenticated\");\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1270,
        "y": 180,
        "wires": [
            [
                "a5df2520.fa5008"
            ]
        ]
    },
    {
        "id": "a5df2520.fa5008",
        "type": "subflow:411ddac8.164cb4",
        "z": "76bd89c2.eace48",
        "name": "",
        "env": [],
        "x": 1630,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "7957d706.e73268",
        "type": "function",
        "z": "76bd89c2.eace48",
        "name": "Setting up message about failed editing",
        "func": "msg.payload = {\n    text: \"–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞\",\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1260,
        "y": 300,
        "wires": [
            [
                "e6ea5ac9.012de8"
            ]
        ]
    },
    {
        "id": "e6ea5ac9.012de8",
        "type": "subflow:411ddac8.164cb4",
        "z": "76bd89c2.eace48",
        "name": "",
        "env": [],
        "x": 1630,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "2bb0fcbb.eacf14",
        "type": "function",
        "z": "59350fd8.5c52c",
        "name": "Setting up state and list with occupations",
        "func": "msg.method = \"PUT\"\nmsg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users?id=\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nmsg.payload_admin = msg.payload;\n\nif (msg.message == \"distribution\") {\n    msg.payload = {\n        \"state\": {\n            \"state\": \"settingGroupsForDistribution\",\n            \"occupations\": []\n        }\n    };\n} else if (msg.message == \"editGroupsForDistribution\") {\n    \n    msg.addedOccupations = msg.payload.user.state.occupations;\n    \n    msg.payload.user.state.state = \"settingGroupsForDistribution\";\n    msg.payload = {\"state\": msg.payload.user.state};\n}else {\n    msg.addedOccupations = msg.payload.user.state.occupations;\n    \n    occupation = msg.message.split('_')[1];\n    \n    if (msg.addedOccupations.includes(occupation)) msg.addedOccupations.splice(msg.addedOccupations.indexOf(occupation), (msg.addedOccupations.indexOf(occupation)+1));\n    else msg.addedOccupations.push(occupation);\n    \n    msg.payload.user.state.occupations = msg.addedOccupations;\n    msg.payload = {\"state\": msg.payload.user.state};\n}\n\nreturn msg;\n\n\n\n\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 600,
        "y": 180,
        "wires": [
            [
                "92eb133.434a4f"
            ]
        ]
    },
    {
        "id": "a8f532b7.9551d",
        "type": "link in",
        "z": "59350fd8.5c52c",
        "name": "Send list of groups for distribution",
        "links": [
            "fb5c0751.e781d8",
            "9b2645fd.c8ba98",
            "b0b82aef.d9adc8"
        ],
        "x": 315,
        "y": 180,
        "wires": [
            [
                "2bb0fcbb.eacf14"
            ]
        ]
    },
    {
        "id": "6d7b857a.114fec",
        "type": "comment",
        "z": "59350fd8.5c52c",
        "name": "Sending list of groups for distribution",
        "info": "",
        "x": 440,
        "y": 140,
        "wires": []
    },
    {
        "id": "e70f41c0.f3098",
        "type": "subflow:411ddac8.164cb4",
        "z": "59350fd8.5c52c",
        "name": "",
        "env": [],
        "x": 2060,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "fb5c0751.e781d8",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send list of groups for distribution",
        "links": [
            "a8f532b7.9551d"
        ],
        "x": 1775,
        "y": 1580,
        "wires": []
    },
    {
        "id": "15c919f4.91a136",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send list of groups for distribution",
        "info": "",
        "x": 1890,
        "y": 1540,
        "wires": []
    },
    {
        "id": "1ec0b11f.98ad7f",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Add group for distribution",
        "property": "$split(msg.message, \"_\", 1)",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "eq",
                "v": "addForDistribution",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1310,
        "y": 3020,
        "wires": [
            [
                "9b2645fd.c8ba98"
            ]
        ]
    },
    {
        "id": "9b2645fd.c8ba98",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Add group for distribution",
        "links": [
            "a8f532b7.9551d"
        ],
        "x": 1795,
        "y": 3020,
        "wires": []
    },
    {
        "id": "be03b478.0c00c8",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Add group for distribution",
        "info": "",
        "x": 1890,
        "y": 2980,
        "wires": []
    },
    {
        "id": "5b54cd4a.61f504",
        "type": "http request",
        "z": "59350fd8.5c52c",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "basic",
        "x": 2360,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "76441be9.c976f4",
        "type": "change",
        "z": "59350fd8.5c52c",
        "name": "Setting up editMessageText url",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "\"https://api.telegram.org/bot\" & $env('TOKEN') & \"/editMessageText\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2080,
        "y": 260,
        "wires": [
            [
                "5b54cd4a.61f504"
            ]
        ]
    },
    {
        "id": "b5ff5cf5.c0b24",
        "type": "link in",
        "z": "59350fd8.5c52c",
        "name": "Send message to write text for distribution",
        "links": [
            "b1199913.726ea8"
        ],
        "x": 315,
        "y": 420,
        "wires": [
            [
                "5cecf8af.0c1248"
            ]
        ]
    },
    {
        "id": "9a88c541.0459e8",
        "type": "comment",
        "z": "59350fd8.5c52c",
        "name": "Sending message to write text for distribution",
        "info": "",
        "x": 470,
        "y": 380,
        "wires": []
    },
    {
        "id": "b1199913.726ea8",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send message to write text for distribution",
        "links": [
            "b5ff5cf5.c0b24",
            "fe06c939.f5a5f8"
        ],
        "x": 1775,
        "y": 1660,
        "wires": []
    },
    {
        "id": "29728730.274f78",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send message to write text for distribution",
        "info": "",
        "x": 1920,
        "y": 1620,
        "wires": []
    },
    {
        "id": "eae2ed79.704ac",
        "type": "function",
        "z": "59350fd8.5c52c",
        "name": "Setting up message to write text for distribution",
        "func": "msg.payload = {\n    text: \"–í–≤–µ–¥—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –¥–ª—è —Ä–æ–∑—Å–∏–ª–∫–∏ —Ç–µ–∫—Å—Ç\",\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1260,
        "y": 420,
        "wires": [
            [
                "a033be76.0e7ac"
            ]
        ]
    },
    {
        "id": "a033be76.0e7ac",
        "type": "subflow:411ddac8.164cb4",
        "z": "59350fd8.5c52c",
        "name": "",
        "env": [],
        "x": 1670,
        "y": 420,
        "wires": [
            []
        ]
    },
    {
        "id": "b736f0dc.7e744",
        "type": "link out",
        "z": "741a84b0.eaaafc",
        "name": "Send message with confirming spreading button",
        "links": [
            "db5111a4.bf331",
            "f7fe263.2dba3d8"
        ],
        "x": 1335,
        "y": 280,
        "wires": []
    },
    {
        "id": "5a3b0e57.a76a5",
        "type": "comment",
        "z": "741a84b0.eaaafc",
        "name": "Send message with confirming spreading button",
        "info": "",
        "x": 1500,
        "y": 240,
        "wires": []
    },
    {
        "id": "db5111a4.bf331",
        "type": "link in",
        "z": "59350fd8.5c52c",
        "name": "Send message with confirming spreading button",
        "links": [
            "b736f0dc.7e744",
            "9c1f5735.fbe608",
            "8ffc49f3.7d4878"
        ],
        "x": 315,
        "y": 600,
        "wires": [
            [
                "f768f6de.9cf298"
            ]
        ]
    },
    {
        "id": "42cc6517.88b41c",
        "type": "comment",
        "z": "59350fd8.5c52c",
        "name": "Sending message with confirming spreading button",
        "info": "",
        "x": 490,
        "y": 560,
        "wires": []
    },
    {
        "id": "9ef6addc.728b4",
        "type": "subflow:411ddac8.164cb4",
        "z": "59350fd8.5c52c",
        "name": "",
        "env": [],
        "x": 1670,
        "y": 600,
        "wires": [
            []
        ]
    },
    {
        "id": "fc0983c6.40571",
        "type": "function",
        "z": "59350fd8.5c52c",
        "name": "Setting up message with confirming spreading button",
        "func": "msg.payload = {\n    text: \"–ö–∞—Ç–µ–≥–æ—Ä—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤: \" + (msg.payload_admin.user.state.occupations.join(', ')) + \"\\n–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:\\n \" + msg.payload_admin.user.state.message + \"\\n –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –æ–±—Ä–∞–Ω–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º?\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–ù—ñ, –ø–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å –¥–æ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è\",\n                callback_data: \"sendMessageEditingDistribution\"            \n            }], \n            [{\n                text: \"–¢–∞–∫, –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏\",\n                callback_data: \"completeDistribution\"          \n            }],\n            [{\n                text: \"–ü–æ–≤–Ω—ñ—Å—Ç—é —Å–∫–∞—Å—É–≤–∞—Ç–∏ —Ä–æ–∑—Å–∏–ª–∫—É\",\n                callback_data: \"adminMenu\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1280,
        "y": 600,
        "wires": [
            [
                "9ef6addc.728b4"
            ]
        ]
    },
    {
        "id": "e3531219.e2e16",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send message with buttons for editing distribution",
        "links": [
            "8182241d.800bf8"
        ],
        "x": 1775,
        "y": 1740,
        "wires": []
    },
    {
        "id": "4739e0dc.1da31",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send message with buttons for editing distribution",
        "info": "",
        "x": 1940,
        "y": 1700,
        "wires": []
    },
    {
        "id": "8182241d.800bf8",
        "type": "link in",
        "z": "59350fd8.5c52c",
        "name": "Send message with buttons for editing distribution",
        "links": [
            "e3531219.e2e16"
        ],
        "x": 315,
        "y": 760,
        "wires": [
            [
                "464d9ee.e730a6"
            ]
        ]
    },
    {
        "id": "f469e1bc.18146",
        "type": "comment",
        "z": "59350fd8.5c52c",
        "name": "Sending message with buttons for editing distribution",
        "info": "",
        "x": 490,
        "y": 720,
        "wires": []
    },
    {
        "id": "464d9ee.e730a6",
        "type": "function",
        "z": "59350fd8.5c52c",
        "name": "Setting up message with buttons for editing distribution",
        "func": "msg.payload = {\n    text: \"–©–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –≤—ñ–¥—Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏?\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–ö–∞—Ç–µ–≥–æ—Ä—ñ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤\",\n                callback_data: \"editGroupsForDistribution\"            \n            }, \n            {\n                text: \"–¢–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è\",\n                callback_data: \"writeMessageForDistribution\"            \n            }],\n            [{\n                text: \"–Ü —Ç–µ —ñ —ñ–Ω—à–µ\",\n                callback_data: \"distribution\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 640,
        "y": 760,
        "wires": [
            [
                "f33aa358.28c37"
            ]
        ]
    },
    {
        "id": "f33aa358.28c37",
        "type": "subflow:411ddac8.164cb4",
        "z": "59350fd8.5c52c",
        "name": "",
        "env": [],
        "x": 1030,
        "y": 760,
        "wires": [
            []
        ]
    },
    {
        "id": "b0d5bd6c.c553d",
        "type": "link in",
        "z": "59350fd8.5c52c",
        "name": "Complete distribution",
        "links": [
            "ef489044.60ce5"
        ],
        "x": 315,
        "y": 920,
        "wires": [
            [
                "d01bf2b1.154b",
                "7595aabc.c1d6b4"
            ]
        ]
    },
    {
        "id": "a46b81a3.c399",
        "type": "comment",
        "z": "59350fd8.5c52c",
        "name": "Complete distribution",
        "info": "",
        "x": 400,
        "y": 880,
        "wires": []
    },
    {
        "id": "d01bf2b1.154b",
        "type": "function",
        "z": "59350fd8.5c52c",
        "name": "Getting users",
        "func": "msg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users?type_name=\" + (msg.payload.user.state.occupations.join('&type_name='));\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nmsg.payload_admin = msg.payload;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 520,
        "y": 920,
        "wires": [
            [
                "ecc482b0.00a"
            ]
        ]
    },
    {
        "id": "ecc482b0.00a",
        "type": "http request",
        "z": "59350fd8.5c52c",
        "name": "",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 770,
        "y": 920,
        "wires": [
            [
                "a5102251.e189a"
            ]
        ]
    },
    {
        "id": "a09c0ff1.528c5",
        "type": "function",
        "z": "59350fd8.5c52c",
        "name": "Completing distibution",
        "func": "var apiResponse = msg.payload.users;\n\nmsg.payload = {\n    text: msg.payload_admin.user.state.message,\n}\n\nfor (var i = 0; i < apiResponse.length; i++) {\n    msg.payload.chat_id = apiResponse[i].id;\n        \n    node.send(msg);\n}\n\nmsg.payload = {\n    text: \"–ù–∞–∑–∞–¥ –≤ –≥–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"‚è™ –ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å\",\n                callback_data: \"adminMenu\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1220,
        "y": 920,
        "wires": [
            [
                "33e611e8.1dd02e"
            ]
        ]
    },
    {
        "id": "33e611e8.1dd02e",
        "type": "subflow:411ddac8.164cb4",
        "z": "59350fd8.5c52c",
        "name": "",
        "env": [],
        "x": 1530,
        "y": 920,
        "wires": [
            [
                "57e48ccd.cf1694"
            ]
        ]
    },
    {
        "id": "e26ac470.e2c558",
        "type": "comment",
        "z": "741a84b0.eaaafc",
        "name": "Other user messages",
        "info": "",
        "x": 1420,
        "y": 340,
        "wires": []
    },
    {
        "id": "fd9aa5ae.4abe08",
        "type": "link out",
        "z": "741a84b0.eaaafc",
        "name": "Process message",
        "links": [
            "5581481b.706b38",
            "3be0d365.f203bc",
            "c69d98c5.c5cda8"
        ],
        "x": 1335,
        "y": 380,
        "wires": []
    },
    {
        "id": "2c29d5cc.f3f26a",
        "type": "function",
        "z": "cbf72f33.63dd6",
        "name": "Add unanswered question",
        "func": "msg.method = \"POST\";\nmsg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/questions\";\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\nmsg.payload = {\n    \"question\": msg.message\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 4130,
        "y": 780,
        "wires": [
            [
                "6759fe90.40e07"
            ]
        ]
    },
    {
        "id": "6759fe90.40e07",
        "type": "http request",
        "z": "cbf72f33.63dd6",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 4430,
        "y": 780,
        "wires": [
            [
                "26bece42.b72052"
            ]
        ]
    },
    {
        "id": "16abb23a.271dde",
        "type": "function",
        "z": "14785f2b.3d2341",
        "name": "If admin",
        "func": "if (msg.payload.user && msg.payload.user.role_name.includes(\"admin\")) {\n    return [null, msg];\n}\n\nreturn [msg, null];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 460,
        "y": 320,
        "wires": [
            [
                "c93fac14.b4c41"
            ],
            [
                "59c43f49.d05c1"
            ]
        ],
        "outputLabels": [
            "Isn't admin",
            "Is admin"
        ]
    },
    {
        "id": "d9be97f3.f863e8",
        "type": "debug",
        "z": "96f6108e.64a37",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2020,
        "y": 240,
        "wires": []
    },
    {
        "id": "3b51c244.f6a03e",
        "type": "function",
        "z": "76bd89c2.eace48",
        "name": "Set status 'editing info'",
        "func": "msg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users?id=\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\nmsg.payload = {\n    \"state\": {\"state\": (\"editingInfo_\" + msg.message.split('_')[1])}\n}\n\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 380,
        "y": 100,
        "wires": [
            [
                "cf7f49d8.775858"
            ]
        ]
    },
    {
        "id": "cf7f49d8.775858",
        "type": "http request",
        "z": "76bd89c2.eace48",
        "name": "",
        "method": "PUT",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 650,
        "y": 100,
        "wires": [
            [
                "31999288.76a66e"
            ]
        ]
    },
    {
        "id": "31999288.76a66e",
        "type": "switch",
        "z": "76bd89c2.eace48",
        "name": "If success",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "success",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 880,
        "y": 100,
        "wires": [
            [
                "52968a19.95efe4"
            ]
        ]
    },
    {
        "id": "5301e7c4.494898",
        "type": "function",
        "z": "741a84b0.eaaafc",
        "name": "Get all admins",
        "func": "msg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users/\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 400,
        "y": 280,
        "wires": [
            [
                "9d29bcc1.3d405"
            ]
        ]
    },
    {
        "id": "9d29bcc1.3d405",
        "type": "http request",
        "z": "741a84b0.eaaafc",
        "name": "",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 630,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "f444d784.4b3ec8",
        "type": "switch",
        "z": "741a84b0.eaaafc",
        "name": "If success",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "success",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 910,
        "y": 280,
        "wires": [
            [
                "84224ec9.c9393"
            ]
        ]
    },
    {
        "id": "b42d2140.4b459",
        "type": "comment",
        "z": "cbf72f33.63dd6",
        "name": "Edit info",
        "info": "",
        "x": 1780,
        "y": 920,
        "wires": []
    },
    {
        "id": "f3b73302.b6bf3",
        "type": "link out",
        "z": "cbf72f33.63dd6",
        "name": "Edit info",
        "links": [
            "d609159f.a9e588"
        ],
        "x": 1735,
        "y": 960,
        "wires": []
    },
    {
        "id": "92eb133.434a4f",
        "type": "http request",
        "z": "59350fd8.5c52c",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 930,
        "y": 180,
        "wires": [
            [
                "6d615cc0.3b18b4"
            ]
        ]
    },
    {
        "id": "6d615cc0.3b18b4",
        "type": "switch",
        "z": "59350fd8.5c52c",
        "name": "If success",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "success",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1180,
        "y": 180,
        "wires": [
            [
                "2752e817.64aad8"
            ]
        ]
    },
    {
        "id": "2752e817.64aad8",
        "type": "function",
        "z": "59350fd8.5c52c",
        "name": "Setting up message with list of groups for distribution",
        "func": "var occupations = {\"Applicant\" : '', \"Parent\": '', \"Teacher\": '', \"Student\": '', \"Other\": ''};\n\nif (msg.message != \"distribution\") {\n    for (const [key, value] of Object.entries(occupations)) {\n       if (msg.addedOccupations.includes(key)) occupations[key] = \"‚úÖ\";\n    }\n}\n\nmsg.payload = {\n    text: \"–í–∏–±–µ—Ä—ñ—Ç—å –∫–∞—Ç–µ–≥–æ—Ä—ñ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ üôÇ\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: occupations[\"Applicant\"] + \"–ê–±—ñ—Ç—É—Ä—ñ—î–Ω—Ç–∏\",\n                callback_data: \"addForDistribution_Applicant\"            \n            }, \n            {\n                text: occupations[\"Parent\"] + \"–ë–∞—Ç—å–∫–∏\",\n                callback_data: \"addForDistribution_Parent\"            \n            }],\n            [{\n                text: occupations[\"Teacher\"] + \"–í–∏–∫–ª–∞–¥–∞—á—ñ\",\n                callback_data: \"addForDistribution_Teacher\"            \n            },\n            {\n                text: occupations[\"Student\"] + \"–°—Ç—É–¥–µ–Ω—Ç–∏\",\n                callback_data: \"addForDistribution_Student\"            \n            }],\n            [{\n                text: occupations[\"Other\"] + \"–Ü–Ω—à–µ\",\n                callback_data: \"addForDistribution_Other\"            \n            }],\n            [{\n                text: \"‚è™ –ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å\",\n                callback_data: \"adminMenu\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nif (msg.message != \"distribution\")  {\n    msg.payload.message_id = msg.message_id;\n    \n    if (Object.values(occupations).includes(\"‚úÖ\")) {\n        msg.payload.reply_markup.inline_keyboard.pop();\n        \n        msg.payload.reply_markup.inline_keyboard.push(\n            [{\n                text: \"–ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏\",\n                callback_data: (msg.payload_admin.user.state.message ? \"goToCompleteDistributionMessage\" : \"writeMessageForDistribution\")        \n            }],\n            [{\n                text: \"‚è™ –ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å\",\n                callback_data: \"adminMenu\"            \n            }]);\n    }\n    \n    return [null, msg];\n}\n\nreturn [msg, null];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1620,
        "y": 180,
        "wires": [
            [
                "e70f41c0.f3098"
            ],
            [
                "76441be9.c976f4"
            ]
        ]
    },
    {
        "id": "70a4f6b8.84e278",
        "type": "http request",
        "z": "dbbd86af.74c0d8",
        "name": "",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 1010,
        "y": 1480,
        "wires": [
            [
                "708284e0.3b6a4c"
            ]
        ]
    },
    {
        "id": "91ffc7e7.5a6d18",
        "type": "function",
        "z": "dbbd86af.74c0d8",
        "name": "Getting user row",
        "func": "msg.payload_from_hook = msg.payload;\n\nmsg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users/\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 860,
        "y": 1520,
        "wires": [
            [
                "70a4f6b8.84e278"
            ]
        ]
    },
    {
        "id": "708284e0.3b6a4c",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Is success",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "success",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1050,
        "y": 1580,
        "wires": [
            [
                "689e4325.47104c",
                "59c1267b.ca3c98",
                "d4173cf4.07cab",
                "db142eec.63a9b"
            ]
        ]
    },
    {
        "id": "689e4325.47104c",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Is admin",
        "property": "payload.user.role_name",
        "propertyType": "msg",
        "rules": [
            {
                "t": "cont",
                "v": "admin",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1000,
        "y": 2160,
        "wires": [
            [
                "a5af100c.3c9e6",
                "4acba4db.21b67c",
                "a525eef0.3d2fc",
                "63b0881b.a8f938",
                "1ec0b11f.98ad7f",
                "77999755.4ff548",
                "abd8c51f.27f648"
            ],
            []
        ]
    },
    {
        "id": "c017e434.7d5098",
        "type": "subflow:4001764a.8341f8",
        "z": "dbbd86af.74c0d8",
        "name": "",
        "env": [],
        "x": 870,
        "y": 760,
        "wires": [
            [
                "91ffc7e7.5a6d18"
            ]
        ]
    },
    {
        "id": "59cac999.01c698",
        "type": "http request",
        "z": "dbbd86af.74c0d8",
        "name": "",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 1130,
        "y": 3280,
        "wires": [
            [
                "7af57ab2.f52244"
            ]
        ]
    },
    {
        "id": "43383010.7a91f",
        "type": "function",
        "z": "dbbd86af.74c0d8",
        "name": "Getting user row",
        "func": "msg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users/\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 920,
        "y": 3280,
        "wires": [
            [
                "59cac999.01c698"
            ]
        ]
    },
    {
        "id": "5cecf8af.0c1248",
        "type": "function",
        "z": "59350fd8.5c52c",
        "name": "Set status 'writingTextForDistribution'",
        "func": "msg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users?id=\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nmsg.payload.user.state.state = \"writingTextForDistribution\";\nmsg.payload = {\"state\": msg.payload.user.state};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 570,
        "y": 420,
        "wires": [
            [
                "e4c1baf3.fe42b8"
            ]
        ]
    },
    {
        "id": "e4c1baf3.fe42b8",
        "type": "http request",
        "z": "59350fd8.5c52c",
        "name": "",
        "method": "PUT",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 890,
        "y": 420,
        "wires": [
            [
                "eae2ed79.704ac"
            ]
        ]
    },
    {
        "id": "a5102251.e189a",
        "type": "switch",
        "z": "59350fd8.5c52c",
        "name": "If success",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "success",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 980,
        "y": 920,
        "wires": [
            [
                "a09c0ff1.528c5"
            ]
        ]
    },
    {
        "id": "9c1f5735.fbe608",
        "type": "link out",
        "z": "cbf72f33.63dd6",
        "name": "Send message with confirming spreading button",
        "links": [
            "db5111a4.bf331",
            "f7fe263.2dba3d8"
        ],
        "x": 1735,
        "y": 1080,
        "wires": []
    },
    {
        "id": "ac5bd21e.b470b",
        "type": "comment",
        "z": "cbf72f33.63dd6",
        "name": "Send message with confirming spreading button",
        "info": "",
        "x": 1900,
        "y": 1040,
        "wires": []
    },
    {
        "id": "57e48ccd.cf1694",
        "type": "function",
        "z": "59350fd8.5c52c",
        "name": "Set status 'writingTextForDistribution'",
        "func": "msg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users?id=\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\nmsg.payload = {\n    \"state\": {\"state\": \"registered\"}\n}\n\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1910,
        "y": 920,
        "wires": [
            [
                "ee8a826a.d31bd"
            ]
        ]
    },
    {
        "id": "ee8a826a.d31bd",
        "type": "http request",
        "z": "59350fd8.5c52c",
        "name": "",
        "method": "PUT",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 2250,
        "y": 920,
        "wires": [
            []
        ]
    },
    {
        "id": "3ec1dc48.121724",
        "type": "function",
        "z": "74e0bd75.30b964",
        "name": "Changing state filed to 'registered''",
        "func": "msg.method = \"PUT\"\nmsg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users?id=\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nmsg.payload_admin = msg.payload;\n\nmsg.payload = {\n    \"state\": {\"state\": \"registered\"}\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 480,
        "y": 180,
        "wires": [
            [
                "71663428.9de72c"
            ]
        ]
    },
    {
        "id": "71663428.9de72c",
        "type": "http request",
        "z": "74e0bd75.30b964",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 750,
        "y": 180,
        "wires": [
            [
                "7a6c7bed.6c8544"
            ]
        ]
    },
    {
        "id": "c980835f.1f3f7",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send message with confirming spreading button",
        "info": "",
        "x": 1940,
        "y": 1860,
        "wires": []
    },
    {
        "id": "8ffc49f3.7d4878",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send message with confirming spreading button",
        "links": [
            "db5111a4.bf331",
            "f7fe263.2dba3d8"
        ],
        "x": 1775,
        "y": 1900,
        "wires": []
    },
    {
        "id": "7ebae3f.93e8d1c",
        "type": "http request",
        "z": "59350fd8.5c52c",
        "name": "",
        "method": "PUT",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 890,
        "y": 600,
        "wires": [
            [
                "fc0983c6.40571"
            ]
        ]
    },
    {
        "id": "f768f6de.9cf298",
        "type": "function",
        "z": "59350fd8.5c52c",
        "name": "Set status 'writingTextForDistribution'",
        "func": "msg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users?id=\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nmsg.payload_admin = msg.payload;\n\nif (!msg.payload.user.state.message) msg.payload.user.state.message = msg.message;\nmsg.payload = {\"state\": msg.payload.user.state};\n    \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 570,
        "y": 600,
        "wires": [
            [
                "7ebae3f.93e8d1c"
            ]
        ]
    },
    {
        "id": "ef489044.60ce5",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Complete distribution",
        "links": [
            "b0d5bd6c.c553d"
        ],
        "x": 1775,
        "y": 1980,
        "wires": []
    },
    {
        "id": "6a546e4c.aac6",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Complete distribution",
        "info": "",
        "x": 1860,
        "y": 1940,
        "wires": []
    },
    {
        "id": "2477cc81.af2264",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send list of groups for distribution to edit selected groups",
        "info": "",
        "x": 1970,
        "y": 1780,
        "wires": []
    },
    {
        "id": "b0b82aef.d9adc8",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send list of groups for distribution to edit selected groups",
        "links": [
            "a8f532b7.9551d"
        ],
        "x": 1775,
        "y": 1820,
        "wires": []
    },
    {
        "id": "369d16a4.59851a",
        "type": "link in",
        "z": "4000ac09.8509f4",
        "name": "Send message with action buttons for editing admin list",
        "links": [
            "d5772bfb.1db3b8"
        ],
        "x": 155,
        "y": 100,
        "wires": [
            [
                "f67b5ff1.95ea7"
            ]
        ]
    },
    {
        "id": "43f05561.c6f64c",
        "type": "comment",
        "z": "4000ac09.8509f4",
        "name": "Sending message with action buttons for editing admin list",
        "info": "",
        "x": 350,
        "y": 60,
        "wires": []
    },
    {
        "id": "d5772bfb.1db3b8",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send message with action buttons for editing admin list",
        "links": [
            "369d16a4.59851a"
        ],
        "x": 1775,
        "y": 2060,
        "wires": []
    },
    {
        "id": "fb3f7be8.212f78",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send message with action buttons for editing admin list",
        "info": "",
        "x": 1960,
        "y": 2020,
        "wires": []
    },
    {
        "id": "f67b5ff1.95ea7",
        "type": "function",
        "z": "4000ac09.8509f4",
        "name": "Setting up message with action buttons for editing admins list",
        "func": "msg.payload = {\n    text: \"–©–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –≤—ñ–¥—Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏?\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–î–æ–¥–∞—Ç–∏ –∞–¥–º—ñ–Ω–∞\",\n                callback_data: \"addAdmin\"            \n            }, \n            {\n                text: \"–í–∏–¥–∞–ª–∏—Ç–∏ –∞–¥–º—ñ–Ω–∞\",\n                callback_data: \"adminsForDelete\"            \n            }],\n            [{\n                text: \"‚óÄ –ù–∞–∑–∞–¥\",\n                callback_data: \"adminMenu\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 500,
        "y": 100,
        "wires": [
            [
                "8ae69bf9.340b58"
            ]
        ]
    },
    {
        "id": "8ae69bf9.340b58",
        "type": "subflow:411ddac8.164cb4",
        "z": "4000ac09.8509f4",
        "name": "",
        "env": [],
        "x": 950,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "1837dccf.aa6913",
        "type": "link in",
        "z": "4000ac09.8509f4",
        "name": "Send message to write username of new admin",
        "links": [
            "e3ee6ca3.b886c"
        ],
        "x": 155,
        "y": 240,
        "wires": [
            [
                "57db290b.f60aa8"
            ]
        ]
    },
    {
        "id": "c927b79d.b983e8",
        "type": "comment",
        "z": "4000ac09.8509f4",
        "name": "Sending message to write username of new admin",
        "info": "",
        "x": 330,
        "y": 200,
        "wires": []
    },
    {
        "id": "aaee0af8.512428",
        "type": "function",
        "z": "4000ac09.8509f4",
        "name": "Setting up message to write username of new admin",
        "func": "msg.payload = {\n    text: \"–í–∫–∞–∂—ñ—Ç—å username\",\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1100,
        "y": 240,
        "wires": [
            [
                "7893b837.3bd568"
            ]
        ]
    },
    {
        "id": "7893b837.3bd568",
        "type": "subflow:411ddac8.164cb4",
        "z": "4000ac09.8509f4",
        "name": "",
        "env": [],
        "x": 1530,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "57db290b.f60aa8",
        "type": "function",
        "z": "4000ac09.8509f4",
        "name": "Set status 'adding admin'",
        "func": "msg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users?id=\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nmsg.payload = {\"state\": {\"state\": \"addingAdmin\"}};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 390,
        "y": 240,
        "wires": [
            [
                "4c6786c7.119908"
            ]
        ]
    },
    {
        "id": "4c6786c7.119908",
        "type": "http request",
        "z": "4000ac09.8509f4",
        "name": "",
        "method": "PUT",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 690,
        "y": 240,
        "wires": [
            [
                "aaee0af8.512428"
            ]
        ]
    },
    {
        "id": "e3ee6ca3.b886c",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send message to write useraname of new admin",
        "links": [
            "1837dccf.aa6913"
        ],
        "x": 1775,
        "y": 2140,
        "wires": []
    },
    {
        "id": "a6f284b7.746378",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send message to write useraname of new admin",
        "info": "",
        "x": 1940,
        "y": 2100,
        "wires": []
    },
    {
        "id": "fdc2130b.e08af",
        "type": "link in",
        "z": "4000ac09.8509f4",
        "name": "Add new admin",
        "links": [
            "24e51cd8.751164"
        ],
        "x": 155,
        "y": 360,
        "wires": [
            [
                "a94475ac.d34bc8"
            ]
        ]
    },
    {
        "id": "834a9995.186698",
        "type": "comment",
        "z": "4000ac09.8509f4",
        "name": "Adding new admin",
        "info": "",
        "x": 230,
        "y": 320,
        "wires": []
    },
    {
        "id": "6c22e625.e884c8",
        "type": "function",
        "z": "4000ac09.8509f4",
        "name": "Setting up message that new admin successfully added",
        "func": "msg.payload = {\n    text: \"‚úÖ –ê–¥–º—ñ–Ω —É—Å–ø—ñ—à–Ω–æ –¥–æ–¥–∞–Ω–∏–π\",\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1850,
        "y": 360,
        "wires": [
            [
                "faff982b.3420c8"
            ]
        ]
    },
    {
        "id": "faff982b.3420c8",
        "type": "subflow:411ddac8.164cb4",
        "z": "4000ac09.8509f4",
        "name": "",
        "env": [],
        "x": 2270,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "85239228.782b6",
        "type": "function",
        "z": "4000ac09.8509f4",
        "name": "Set status 'registered'",
        "func": "msg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/users?id=\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nmsg.payload = {\"state\": {\"state\": \"registered\"}};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1120,
        "y": 360,
        "wires": [
            [
                "6a49002b.c022d"
            ]
        ]
    },
    {
        "id": "6a49002b.c022d",
        "type": "http request",
        "z": "4000ac09.8509f4",
        "name": "",
        "method": "PUT",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 1430,
        "y": 360,
        "wires": [
            [
                "6c22e625.e884c8"
            ]
        ]
    },
    {
        "id": "b1e43e3d.d56a4",
        "type": "http request",
        "z": "4000ac09.8509f4",
        "name": "",
        "method": "PUT",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 610,
        "y": 360,
        "wires": [
            [
                "9575d015.681c4"
            ]
        ]
    },
    {
        "id": "a94475ac.d34bc8",
        "type": "function",
        "z": "4000ac09.8509f4",
        "name": "Adding new admin",
        "func": "if (msg.message.startsWith(\"@\")) msg.message = msg.message.slice(1);\n\nmsg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/admins/add/?username=\" + msg.message;\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 370,
        "y": 360,
        "wires": [
            [
                "b1e43e3d.d56a4"
            ]
        ]
    },
    {
        "id": "9575d015.681c4",
        "type": "switch",
        "z": "4000ac09.8509f4",
        "name": "If success",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "success",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 820,
        "y": 360,
        "wires": [
            [
                "85239228.782b6"
            ]
        ]
    },
    {
        "id": "24e51cd8.751164",
        "type": "link out",
        "z": "cbf72f33.63dd6",
        "name": "Add new admin",
        "links": [
            "fdc2130b.e08af"
        ],
        "x": 1735,
        "y": 1180,
        "wires": []
    },
    {
        "id": "cfacf806.f0d4e8",
        "type": "comment",
        "z": "cbf72f33.63dd6",
        "name": "Add new admin",
        "info": "",
        "x": 1800,
        "y": 1140,
        "wires": []
    },
    {
        "id": "c93fac14.b4c41",
        "type": "link out",
        "z": "14785f2b.3d2341",
        "name": "Is registration completed",
        "links": [
            "6ff45d49.c66084",
            "4d1e8f79.27d3c"
        ],
        "x": 715,
        "y": 220,
        "wires": []
    },
    {
        "id": "27435946.ad3596",
        "type": "comment",
        "z": "14785f2b.3d2341",
        "name": "Checking whether the registration is completed",
        "info": "",
        "x": 880,
        "y": 180,
        "wires": []
    },
    {
        "id": "173d0a39.c80376",
        "type": "debug",
        "z": "cbf72f33.63dd6",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3180,
        "y": 920,
        "wires": []
    },
    {
        "id": "e8450ef9.72f97",
        "type": "link in",
        "z": "4000ac09.8509f4",
        "name": "Send message with admins for delete",
        "links": [
            "22333f69.fdca5",
            "5b187e5e.156ae"
        ],
        "x": 155,
        "y": 520,
        "wires": [
            [
                "c4fa9f7f.86481"
            ]
        ]
    },
    {
        "id": "735b4369.ff2d8c",
        "type": "comment",
        "z": "4000ac09.8509f4",
        "name": "Sending message with admins for delete",
        "info": "",
        "x": 300,
        "y": 480,
        "wires": []
    },
    {
        "id": "450073bc.f7e6fc",
        "type": "function",
        "z": "4000ac09.8509f4",
        "name": "Setting up message with admins for delete",
        "func": "var admins = msg.payload.users;\n\nmsg.payload = {\n    text: \"–í–∏–µ–±—Ä—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ–≥–æ –∞–¥–º—ñ–Ω–∞\",\n    reply_markup: {\n        inline_keyboard: []\n    },\n    chat_id: msg.chat_id\n}\n\nadmins.forEach((value) => {\n   msg.payload.reply_markup.inline_keyboard.push([{text: (value.username ? value.username : \" \"), callback_data: (\"deleteAdminPrompt_\" + value.id)}]);\n});\n\nmsg.payload.reply_markup.inline_keyboard.push([{\n                text: \"‚óÄ –ù–∞–∑–∞–¥\",\n                callback_data: \"adminMenu\"            \n            }]);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1130,
        "y": 460,
        "wires": [
            [
                "200c282d.8dfb58"
            ]
        ]
    },
    {
        "id": "200c282d.8dfb58",
        "type": "subflow:411ddac8.164cb4",
        "z": "4000ac09.8509f4",
        "name": "",
        "env": [],
        "x": 1510,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "22333f69.fdca5",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send message with admins for delete",
        "links": [
            "e8450ef9.72f97"
        ],
        "x": 1775,
        "y": 2220,
        "wires": []
    },
    {
        "id": "42df4836.162fd8",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send message with admins for delete",
        "info": "",
        "x": 1910,
        "y": 2180,
        "wires": []
    },
    {
        "id": "d91eb7d1.266608",
        "type": "http request",
        "z": "4000ac09.8509f4",
        "name": "",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 550,
        "y": 520,
        "wires": [
            [
                "12934ff0.323c",
                "16a2a1ef.06636e"
            ]
        ]
    },
    {
        "id": "c4fa9f7f.86481",
        "type": "function",
        "z": "4000ac09.8509f4",
        "name": "Get admins list",
        "func": "msg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/admins/list\";\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 360,
        "y": 520,
        "wires": [
            [
                "d91eb7d1.266608"
            ]
        ]
    },
    {
        "id": "12934ff0.323c",
        "type": "switch",
        "z": "4000ac09.8509f4",
        "name": "If success",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "success",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 780,
        "y": 480,
        "wires": [
            [
                "450073bc.f7e6fc"
            ]
        ]
    },
    {
        "id": "a8548bd1.669278",
        "type": "function",
        "z": "4000ac09.8509f4",
        "name": "Setting up message that there aren't any admins",
        "func": "msg.payload = {\n    text: \"–ê–¥–º—ñ–Ω—ñ–≤ –Ω–µ–º–∞—î\",\n    reply_markup: {\n        inline_keyboard: [[{\n                text: \"‚óÄ –ù–∞–∑–∞–¥\",\n                callback_data: \"adminMenu\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1140,
        "y": 600,
        "wires": [
            [
                "200c282d.8dfb58"
            ]
        ]
    },
    {
        "id": "16a2a1ef.06636e",
        "type": "switch",
        "z": "4000ac09.8509f4",
        "name": "If there aren't any admins",
        "property": "payload.message",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Admin users not found",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 830,
        "y": 540,
        "wires": [
            [
                "a8548bd1.669278"
            ]
        ]
    },
    {
        "id": "59c43f49.d05c1",
        "type": "link out",
        "z": "14785f2b.3d2341",
        "name": "Send admin menu",
        "links": [
            "174b2f09.720ee1"
        ],
        "x": 735,
        "y": 400,
        "wires": []
    },
    {
        "id": "649ae7e6.b5a278",
        "type": "comment",
        "z": "14785f2b.3d2341",
        "name": "Send admin menu",
        "info": "",
        "x": 810,
        "y": 360,
        "wires": []
    },
    {
        "id": "77999755.4ff548",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Delete admin prompt",
        "property": "$split(msg.message, \"_\", 1)",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "eq",
                "v": "deleteAdminPrompt",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1300,
        "y": 3140,
        "wires": [
            [
                "bcc40914.8260d8"
            ]
        ]
    },
    {
        "id": "bcc40914.8260d8",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send delete admin prompt",
        "links": [
            "6e64f2dd.67beec"
        ],
        "x": 1795,
        "y": 3140,
        "wires": []
    },
    {
        "id": "1dd71fad.f7f1b",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send delete admin prompt",
        "info": "",
        "x": 1890,
        "y": 3100,
        "wires": []
    },
    {
        "id": "6e64f2dd.67beec",
        "type": "link in",
        "z": "4000ac09.8509f4",
        "name": "Send delete admin prompt",
        "links": [
            "bcc40914.8260d8"
        ],
        "x": 155,
        "y": 760,
        "wires": [
            [
                "790cf7cc.d92818"
            ]
        ]
    },
    {
        "id": "f1415030.4c228",
        "type": "comment",
        "z": "4000ac09.8509f4",
        "name": "Sending delete admin prompt",
        "info": "",
        "x": 260,
        "y": 720,
        "wires": []
    },
    {
        "id": "790cf7cc.d92818",
        "type": "function",
        "z": "4000ac09.8509f4",
        "name": "Setting up message with delete admin prompt",
        "func": "msg.payload = {\n    text: \"–í–∏ —Ç–æ—á–Ω–æ –±–∞–∂–∞—î—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü—å–æ–≥–æ –∞–¥–º—ñ–Ω–∞?\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–¢–∞–∫\",\n                callback_data: (\"deleteAdmin_\" + msg.message.split('_')[1])            \n            }, \n            {\n                text: \"–ù—ñ\",\n                callback_data: \"adminsForDelete\"            \n            }],\n            [{\n                text: \"‚óÄ –ù–∞–∑–∞–¥\",\n                callback_data: \"adminsForDelete\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 460,
        "y": 760,
        "wires": [
            [
                "3f12676f.7ff6e8"
            ]
        ]
    },
    {
        "id": "3f12676f.7ff6e8",
        "type": "subflow:411ddac8.164cb4",
        "z": "4000ac09.8509f4",
        "name": "",
        "env": [],
        "x": 850,
        "y": 760,
        "wires": [
            []
        ]
    },
    {
        "id": "896bfa0a.e7c978",
        "type": "link in",
        "z": "4000ac09.8509f4",
        "name": "Delete admin",
        "links": [
            "e3d5dff2.1410b"
        ],
        "x": 155,
        "y": 900,
        "wires": [
            [
                "b5bc13a0.40b57"
            ]
        ]
    },
    {
        "id": "b2cc11af.4f336",
        "type": "comment",
        "z": "4000ac09.8509f4",
        "name": "Deleting admin",
        "info": "",
        "x": 220,
        "y": 860,
        "wires": []
    },
    {
        "id": "c88b07e6.915868",
        "type": "http request",
        "z": "4000ac09.8509f4",
        "name": "",
        "method": "PUT",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 630,
        "y": 900,
        "wires": [
            [
                "9cd52896.ce06a8"
            ]
        ]
    },
    {
        "id": "b5bc13a0.40b57",
        "type": "function",
        "z": "4000ac09.8509f4",
        "name": "Deleting admin",
        "func": "msg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/admins/delete/?id=\" + msg.message.split('_')[1];\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 360,
        "y": 900,
        "wires": [
            [
                "c88b07e6.915868"
            ]
        ]
    },
    {
        "id": "abd8c51f.27f648",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Delete admin prompt",
        "property": "$split(msg.message, \"_\", 1)",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "eq",
                "v": "deleteAdmin",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1300,
        "y": 3220,
        "wires": [
            [
                "e3d5dff2.1410b"
            ]
        ]
    },
    {
        "id": "e3d5dff2.1410b",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Delete admin",
        "links": [
            "896bfa0a.e7c978"
        ],
        "x": 1795,
        "y": 3220,
        "wires": []
    },
    {
        "id": "942da5b8.ad0928",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Delete admin",
        "info": "",
        "x": 1850,
        "y": 3180,
        "wires": []
    },
    {
        "id": "64610c6a.0bcf94",
        "type": "comment",
        "z": "4000ac09.8509f4",
        "name": "Send message with admins for delete",
        "info": "",
        "x": 2070,
        "y": 860,
        "wires": []
    },
    {
        "id": "5b187e5e.156ae",
        "type": "link out",
        "z": "4000ac09.8509f4",
        "name": "Send message with admins for delete",
        "links": [
            "e8450ef9.72f97"
        ],
        "x": 1935,
        "y": 900,
        "wires": []
    },
    {
        "id": "9cd52896.ce06a8",
        "type": "switch",
        "z": "4000ac09.8509f4",
        "name": "If success",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "success",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 840,
        "y": 900,
        "wires": [
            [
                "2058f947.f3eec6"
            ]
        ]
    },
    {
        "id": "2058f947.f3eec6",
        "type": "function",
        "z": "4000ac09.8509f4",
        "name": "Setting up message that admin successfully deleted",
        "func": "msg.payload = {\n    text: \"‚úÖ –ê–¥–º—ñ–Ω —É—Å–º—ñ—à–Ω–æ –≤–∏–¥–∞–ª–µ–Ω–∏–π\",\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1270,
        "y": 900,
        "wires": [
            [
                "146cf952.ae8097"
            ]
        ]
    },
    {
        "id": "146cf952.ae8097",
        "type": "subflow:411ddac8.164cb4",
        "z": "4000ac09.8509f4",
        "name": "",
        "env": [],
        "x": 1650,
        "y": 900,
        "wires": [
            [
                "5b187e5e.156ae"
            ]
        ]
    },
    {
        "id": "fd270046.426d4",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Sync FAQ",
        "links": [
            "11f5f0e8.a0633f"
        ],
        "x": 1775,
        "y": 2300,
        "wires": []
    },
    {
        "id": "4eddfce1.d18244",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Sync FAQ",
        "info": "",
        "x": 1820,
        "y": 2260,
        "wires": []
    },
    {
        "id": "11f5f0e8.a0633f",
        "type": "link in",
        "z": "54742aae.b4a584",
        "name": "Sync FAQ",
        "links": [
            "fd270046.426d4"
        ],
        "x": 195,
        "y": 100,
        "wires": [
            [
                "b403e5b1.e05d88"
            ]
        ]
    },
    {
        "id": "f8b385bd.855528",
        "type": "comment",
        "z": "54742aae.b4a584",
        "name": "Sync FAQ",
        "info": "",
        "x": 240,
        "y": 60,
        "wires": []
    },
    {
        "id": "a02a40a6.3900a",
        "type": "http request",
        "z": "54742aae.b4a584",
        "name": "",
        "method": "PUT",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 690,
        "y": 100,
        "wires": [
            [
                "f3559e3b.d4589"
            ]
        ]
    },
    {
        "id": "b403e5b1.e05d88",
        "type": "function",
        "z": "54742aae.b4a584",
        "name": "Sync FAQ",
        "func": "msg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/questions/faq/sync\";\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 400,
        "y": 100,
        "wires": [
            [
                "a02a40a6.3900a"
            ]
        ]
    },
    {
        "id": "7ecadfba.e0e1a",
        "type": "function",
        "z": "54742aae.b4a584",
        "name": "Setting up message successfully sync faq",
        "func": "msg.payload = {\n    text: \"‚úÖ –°–ø–∏—Å–æ–∫ –ø–∏—Ç–∞–Ω—å —É—Å–ø—ñ—à–Ω–æ –æ–Ω–æ–≤–ª–µ–Ω–æ\",\n    reply_markup: {\n        inline_keyboard: [\n            [{\n                text: \"‚è™ –ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å\",\n                callback_data: \"adminMenu\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1340,
        "y": 100,
        "wires": [
            [
                "985de521.e20488"
            ]
        ]
    },
    {
        "id": "985de521.e20488",
        "type": "subflow:411ddac8.164cb4",
        "z": "54742aae.b4a584",
        "name": "",
        "env": [],
        "x": 1750,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "f3559e3b.d4589",
        "type": "switch",
        "z": "54742aae.b4a584",
        "name": "If success",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "success",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 960,
        "y": 100,
        "wires": [
            [
                "7ecadfba.e0e1a"
            ]
        ]
    },
    {
        "id": "284c3f7b.7c2f8",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send message with unanswered questions",
        "links": [
            "f30d3b8.a8367c8",
            "e09b46a.0ff56b8"
        ],
        "x": 1775,
        "y": 2380,
        "wires": []
    },
    {
        "id": "4ba56ac0.2e7874",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send message with unanswered questions",
        "info": "",
        "x": 1920,
        "y": 2340,
        "wires": []
    },
    {
        "id": "3927be27.c53412",
        "type": "link in",
        "z": "892838ee.3ab438",
        "name": "Clear unanswered questions list",
        "links": [
            "f1c3ab8.d32b458"
        ],
        "x": 175,
        "y": 940,
        "wires": [
            [
                "5eb95d6d.8e2a24"
            ]
        ]
    },
    {
        "id": "3eceae62.962792",
        "type": "comment",
        "z": "892838ee.3ab438",
        "name": "Clearing unanswered questions list",
        "info": "",
        "x": 300,
        "y": 900,
        "wires": []
    },
    {
        "id": "d934bfbd.e2234",
        "type": "function",
        "z": "892838ee.3ab438",
        "name": "Setting up message with menu with groups",
        "func": "msg.payload = {\n    text: \"‚úÖ –°–ø–∏—Å–æ–∫ –ø–∏—Ç–∞–Ω—å –±–µ–∑ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —É—Å–ø—ñ—à–Ω–æ –æ—á–∏—â–µ–Ω–æ\",\n    reply_markup: {\n        inline_keyboard: [\n            [{\n                text: \"‚óÄ –ù–∞–∑–∞–¥\",\n                callback_data: \"statistics\"            \n            }],\n            [{\n                text: \"‚è™ –ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å\",\n                callback_data: \"adminMenu\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1310,
        "y": 940,
        "wires": [
            [
                "6426e708.54e338"
            ]
        ]
    },
    {
        "id": "6426e708.54e338",
        "type": "subflow:411ddac8.164cb4",
        "z": "892838ee.3ab438",
        "name": "",
        "x": 1810,
        "y": 940,
        "wires": [
            []
        ]
    },
    {
        "id": "9c9a6bf3.d43d48",
        "type": "http request",
        "z": "892838ee.3ab438",
        "name": "",
        "method": "DELETE",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 710,
        "y": 940,
        "wires": [
            [
                "47c7e567.c1cd2c"
            ]
        ]
    },
    {
        "id": "5eb95d6d.8e2a24",
        "type": "function",
        "z": "892838ee.3ab438",
        "name": "Clearing unanswered questions list",
        "func": "msg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/questions/unanswered/clear\";\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 440,
        "y": 940,
        "wires": [
            [
                "9c9a6bf3.d43d48"
            ]
        ]
    },
    {
        "id": "47c7e567.c1cd2c",
        "type": "switch",
        "z": "892838ee.3ab438",
        "name": "If success",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "success",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 920,
        "y": 940,
        "wires": [
            [
                "d934bfbd.e2234"
            ]
        ]
    },
    {
        "id": "e09b46a.0ff56b8",
        "type": "link in",
        "z": "892838ee.3ab438",
        "name": "Sending message with unanswered questions",
        "links": [
            "284c3f7b.7c2f8"
        ],
        "x": 175,
        "y": 820,
        "wires": [
            [
                "ec4f25c6.d84fd8"
            ]
        ]
    },
    {
        "id": "62495535.5be9fc",
        "type": "comment",
        "z": "892838ee.3ab438",
        "name": "Sending message with unanswered questions",
        "info": "",
        "x": 330,
        "y": 780,
        "wires": []
    },
    {
        "id": "383002a9.a97b8e",
        "type": "function",
        "z": "892838ee.3ab438",
        "name": "Setting up message with unanswered questions",
        "func": "msg.headers = {\n    \"Content-Type\": \"multipart/form-data\",\n};\n\nmsg.payload = {\n    \"document\": {\n        \"value\": msg.payload,\n        \"options\": {\n            \"filename\": \"unanswered_questions.xlsx\"\n        }\n    },\n    \"chat_id\": msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1100,
        "y": 820,
        "wires": [
            [
                "7fcff719.f15238"
            ]
        ]
    },
    {
        "id": "cb471d22.b187f",
        "type": "http request",
        "z": "892838ee.3ab438",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "basic",
        "x": 1810,
        "y": 820,
        "wires": [
            []
        ]
    },
    {
        "id": "7fcff719.f15238",
        "type": "change",
        "z": "892838ee.3ab438",
        "name": "Setting up bot url",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "\"https://api.telegram.org/bot\" & $env('TOKEN') & \"/sendDocument\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1510,
        "y": 820,
        "wires": [
            [
                "cb471d22.b187f"
            ]
        ]
    },
    {
        "id": "f1c3ab8.d32b458",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Clear unanswered questions list",
        "links": [
            "3927be27.c53412"
        ],
        "x": 1775,
        "y": 2460,
        "wires": []
    },
    {
        "id": "e951cec6.3097c",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Clear unanswered questions list",
        "info": "",
        "x": 1890,
        "y": 2420,
        "wires": []
    },
    {
        "id": "f8380ffc.92c4d",
        "type": "http request",
        "z": "892838ee.3ab438",
        "name": "",
        "method": "GET",
        "ret": "bin",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 690,
        "y": 820,
        "wires": [
            [
                "383002a9.a97b8e"
            ]
        ]
    },
    {
        "id": "ec4f25c6.d84fd8",
        "type": "function",
        "z": "892838ee.3ab438",
        "name": "Get unanswered questions file",
        "func": "msg.url = \"https://tg-bot-uni-develop.herokuapp.com/api/v1/questions/unanswered/excel\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 430,
        "y": 820,
        "wires": [
            [
                "f8380ffc.92c4d"
            ]
        ]
    },
    {
        "id": "a6c076cb.782348",
        "type": "debug",
        "z": "cbf72f33.63dd6",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3880,
        "y": 920,
        "wires": []
    },
    {
        "id": "8cd68d5a.41fe5",
        "type": "debug",
        "z": "cbf72f33.63dd6",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 4180,
        "y": 880,
        "wires": []
    },
    {
        "id": "26bece42.b72052",
        "type": "debug",
        "z": "cbf72f33.63dd6",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 4560,
        "y": 860,
        "wires": []
    },
    {
        "id": "492e5f50.8b03c",
        "type": "debug",
        "z": "cbf72f33.63dd6",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3600,
        "y": 900,
        "wires": []
    },
    {
        "id": "44bde95d.ab5328",
        "type": "switch",
        "z": "cbf72f33.63dd6",
        "name": "If fallback",
        "property": "_dialogflow.intent.displayName",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Default Fallback Intent",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 3840,
        "y": 780,
        "wires": [
            [
                "2c29d5cc.f3f26a"
            ]
        ]
    },
    {
        "id": "7595aabc.c1d6b4",
        "type": "debug",
        "z": "59350fd8.5c52c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 1020,
        "wires": []
    },
    {
        "id": "7af57ab2.f52244",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Is success",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "success",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1210,
        "y": 3360,
        "wires": [
            [
                "c255e784.8ab028"
            ],
            [
                "712534ba.03dabc"
            ]
        ]
    }
]