[
    {
        "id": "dbbd86af.74c0d8",
        "type": "tab",
        "label": "Main Flow",
        "disabled": false,
        "info": ""
    },
    {
        "id": "96f6108e.64a37",
        "type": "tab",
        "label": "Start command",
        "disabled": false,
        "info": ""
    },
    {
        "id": "696b129b.360e0c",
        "type": "tab",
        "label": "Is registration completed",
        "disabled": false,
        "info": ""
    },
    {
        "id": "4c6874fb.68b9dc",
        "type": "tab",
        "label": "Editing username",
        "disabled": false,
        "info": ""
    },
    {
        "id": "3b5b98a.1c38768",
        "type": "tab",
        "label": "Editing location",
        "disabled": false,
        "info": ""
    },
    {
        "id": "68a30d94.469f94",
        "type": "tab",
        "label": "Editing occupation",
        "disabled": false,
        "info": ""
    },
    {
        "id": "df5e43cb.b674f",
        "type": "tab",
        "label": "Main menu",
        "disabled": false,
        "info": ""
    },
    {
        "id": "276bc02d.e347",
        "type": "tab",
        "label": "Pages info",
        "disabled": false,
        "info": ""
    },
    {
        "id": "d3d080fa.62628",
        "type": "tab",
        "label": "The most popular questions",
        "disabled": false,
        "info": ""
    },
    {
        "id": "cbf72f33.63dd6",
        "type": "tab",
        "label": "Chatting",
        "disabled": false,
        "info": ""
    },
    {
        "id": "14785f2b.3d2341",
        "type": "tab",
        "label": "Is admin",
        "disabled": false,
        "info": ""
    },
    {
        "id": "741a84b0.eaaafc",
        "type": "tab",
        "label": "Admin messages",
        "disabled": false,
        "info": ""
    },
    {
        "id": "3d74a532.309a9a",
        "type": "tab",
        "label": "Admin auth",
        "disabled": false,
        "info": ""
    },
    {
        "id": "27a4d84f.90dc58",
        "type": "tab",
        "label": "Admin auth message",
        "disabled": false,
        "info": ""
    },
    {
        "id": "74e0bd75.30b964",
        "type": "tab",
        "label": "Admin menu",
        "disabled": false,
        "info": ""
    },
    {
        "id": "b1ea2d1b.82b21",
        "type": "tab",
        "label": "Admin Dashboard ",
        "disabled": false,
        "info": ""
    },
    {
        "id": "892838ee.3ab438",
        "type": "tab",
        "label": "Admin statistics",
        "disabled": false,
        "info": ""
    },
    {
        "id": "411ddac8.164cb4",
        "type": "subflow",
        "name": "Send message to the chat",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 140,
                "y": 80,
                "wires": [
                    {
                        "id": "bd92a1fe.c5f6f"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 720,
                "y": 80,
                "wires": [
                    {
                        "id": "b8d99eac.ee468",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "color": "#DDAA99"
    },
    {
        "id": "4001764a.8341f8",
        "type": "subflow",
        "name": "Remove inline keyboard",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 160,
                "y": 80,
                "wires": [
                    {
                        "id": "a46d83e7.59837"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1980,
                "y": 80,
                "wires": [
                    {
                        "id": "cfe21d91.ca59b",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "color": "#DDAA99"
    },
    {
        "id": "529c4263.aeab0c",
        "type": "MySQLdatabase",
        "name": "",
        "host": "localhost",
        "port": "3306",
        "db": "internship_telegram_bot",
        "tz": "",
        "charset": "UTF8"
    },
    {
        "id": "b513f9.a96b5c08",
        "type": "dialogflowv2-token",
        "name": "Questions"
    },
    {
        "id": "95f1f9c.778f308",
        "type": "dialogflowv2-token",
        "name": "dialogflow_node_red"
    },
    {
        "id": "83a6c20c.1b51b",
        "type": "function",
        "z": "4c6874fb.68b9dc",
        "name": "Updating user name",
        "func": "msg.first_name = msg.payload.callback_query.message.chat.first_name ? msg.payload.callback_query.message.chat.first_name : '';\nmsg.last_name = msg.payload.callback_query.message.chat.last_name ? msg.payload.callback_query.message.chat.last_name : '';\n\nmsg.method = \"PATCH\"\nmsg.url = \"http://localhost:8000/api/v1/users/user/detail/\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": \"Token 3a02264c98f37be1a907f23ed9fb10de5fc11aec\"\n};\nmsg.payload = {\n    \"username\": msg.first_name + \" \" + msg.last_name,\n    \"state\": \"location\"\n}\n\n//for the next question\nmsg.text = \"–ó—Ä–æ–∑—É–º—ñ–ª–æ. –î–µ –≤–∏ –ø—Ä–æ–∂–∏–≤–∞—î—Ç–µ?\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 440,
        "y": 160,
        "wires": [
            [
                "4a21bcb4.3b48f4"
            ]
        ]
    },
    {
        "id": "49db1ec2.c7de4",
        "type": "link in",
        "z": "4c6874fb.68b9dc",
        "name": "Set username to default name",
        "links": [
            "96e4744d.d20358",
            "e97be8fd.b371d8",
            "9fa707eb.be1788"
        ],
        "x": 235,
        "y": 160,
        "wires": [
            [
                "83a6c20c.1b51b",
                "28cc6c0e.6a0174"
            ]
        ]
    },
    {
        "id": "f553be12.15931",
        "type": "debug",
        "z": "4c6874fb.68b9dc",
        "name": "Setting username to default response from db",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 980,
        "y": 240,
        "wires": []
    },
    {
        "id": "28cc6c0e.6a0174",
        "type": "debug",
        "z": "4c6874fb.68b9dc",
        "name": "Setting username to default incoming data",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 450,
        "y": 240,
        "wires": []
    },
    {
        "id": "643d38df.03a4c8",
        "type": "function",
        "z": "4c6874fb.68b9dc",
        "name": "Setting up response",
        "func": "msg.payload = {\n    text: \"–í–∫–∞–∂—ñ—Ç—å, –±—É–¥—å –ª–∞—Å–∫–∞, —Å–≤–æ—î —ñ–º'—èüëá\",\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1820,
        "y": 160,
        "wires": [
            [
                "c538e448.9052c8"
            ]
        ]
    },
    {
        "id": "407592c4.adb5ec",
        "type": "link in",
        "z": "4c6874fb.68b9dc",
        "name": "Send request message to enter a new username",
        "links": [
            "b48e521d.7a459",
            "ba2be4d7.46a368",
            "8b7e5ba1.e6b3d8",
            "7009e878.03e338"
        ],
        "x": 1605,
        "y": 160,
        "wires": [
            [
                "643d38df.03a4c8"
            ]
        ]
    },
    {
        "id": "4d10c364.bba70c",
        "type": "link out",
        "z": "4c6874fb.68b9dc",
        "name": "Move on to setting the location field",
        "links": [
            "b0af6159.780a4",
            "1835ced7.6011d1",
            "2afdb4a1.ffb67c"
        ],
        "x": 875,
        "y": 160,
        "wires": []
    },
    {
        "id": "37feab15.469a44",
        "type": "comment",
        "z": "4c6874fb.68b9dc",
        "name": "Setting username to default name",
        "info": "",
        "x": 350,
        "y": 120,
        "wires": []
    },
    {
        "id": "56b28ca1.adcfe4",
        "type": "comment",
        "z": "4c6874fb.68b9dc",
        "name": "Request message to enter a new username",
        "info": "",
        "x": 1760,
        "y": 120,
        "wires": []
    },
    {
        "id": "29b87cf7.8de694",
        "type": "debug",
        "z": "4c6874fb.68b9dc",
        "name": "Setting username field to 'editing' response from db",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3050,
        "y": 260,
        "wires": []
    },
    {
        "id": "32bc9488.39455c",
        "type": "function",
        "z": "4c6874fb.68b9dc",
        "name": "Changing state to 'username'",
        "func": "msg.method = \"PATCH\"\nmsg.url = \"http://localhost:8000/api/v1/users/user/detail/\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": \"Token 3a02264c98f37be1a907f23ed9fb10de5fc11aec\"\n};\nmsg.payload = {\n    \"state\": \"username\"\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2500,
        "y": 160,
        "wires": [
            [
                "36cbe213.34e8fe"
            ]
        ]
    },
    {
        "id": "981f1664.6f90e8",
        "type": "comment",
        "z": "4c6874fb.68b9dc",
        "name": "Move on to setting the location field",
        "info": "",
        "x": 1000,
        "y": 120,
        "wires": []
    },
    {
        "id": "cab5fa05.8972f8",
        "type": "function",
        "z": "96f6108e.64a37",
        "name": "Setting up response greeting to '/start'",
        "func": "msg.payload = {\n    text: \"–ü—Ä–∏–≤—ñ—Ç! –Ø –±–æ—Ç –∫–∞—Ñ–µ–¥—Ä–∏ –Ü–°–ú.üë®‚Äçüíª–ó —Ä–∞–¥—ñ—Å—Ç—é –¥–æ–ø–æ–º–æ–∂—É –∑–Ω–∞–π—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –≤—Å—ñ –≤–∞—à—ñ –ø–∏—Ç–∞–Ω–Ω—è\",\n    chat_id: msg.chat_id\n}\n\n//for the next question\nmsg.text = \"–î–∞–≤–∞–π—Ç–µ –∑–Ω–∞–π–æ–º–∏—Ç–∏—Å—å –±–ª–∏–∂—á–µ. –ß–∏ –º–æ–∂—É —è –¥–æ –≤–∞—Å –∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—è \" + msg.first_name + \" \" + msg.last_name + \"?\"\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2370,
        "y": 120,
        "wires": [
            [
                "c965d10e.f8642"
            ]
        ]
    },
    {
        "id": "20d295e5.2aa6ca",
        "type": "function",
        "z": "96f6108e.64a37",
        "name": "Setting up request message to set username",
        "func": "msg.payload = {\n    text: msg.text,\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–¢–∞–∫, –∑–≤—ñ—Å–Ω–æ\",\n                callback_data: \"setCurrentName\"\n            }, \n            {\n                text: \"–Ø —Ö–æ—á—É –∑–º—ñ–Ω–∏—Ç–∏\",\n                callback_data: \"setName\"\n            }]\n        ]\n    },\n    chat_id: msg.chat_id,\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 3190,
        "y": 120,
        "wires": [
            [
                "cece57bc.ae7278"
            ]
        ]
    },
    {
        "id": "41e89314.19813c",
        "type": "debug",
        "z": "96f6108e.64a37",
        "name": "Getting user row in 'start command flow' response from api",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1160,
        "y": 300,
        "wires": []
    },
    {
        "id": "776fd5bc.aa182c",
        "type": "function",
        "z": "96f6108e.64a37",
        "name": "Checking presence of user row",
        "func": "if (!msg.payload.detail) return [null, msg];\nelse return [msg, null];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1170,
        "y": 220,
        "wires": [
            [
                "58ada314.42903c"
            ],
            [
                "65f19cea.cc3ef4"
            ]
        ]
    },
    {
        "id": "bb24cad3.d57618",
        "type": "link in",
        "z": "96f6108e.64a37",
        "name": "Start",
        "links": [
            "2cfd1290.cbdfde",
            "b2bc8798.6a3f68",
            "a30c38e0.20a148",
            "712534ba.03dabc",
            "3df9c3f8.76229c"
        ],
        "x": 415,
        "y": 220,
        "wires": [
            [
                "954a6c74.4f585",
                "de1e2237.23c0a"
            ]
        ]
    },
    {
        "id": "fc1f4d6.e69b0b",
        "type": "comment",
        "z": "96f6108e.64a37",
        "name": "Start",
        "info": "",
        "x": 450,
        "y": 180,
        "wires": []
    },
    {
        "id": "1835ced7.6011d1",
        "type": "link in",
        "z": "3b5b98a.1c38768",
        "name": "Send message to set the location field",
        "links": [
            "4d10c364.bba70c",
            "67e90bd9.a1e8c4",
            "ce2794d2.a63448",
            "fc83002f.8146f",
            "6f605b10.5004f4",
            "d8112410.42a728",
            "bba92257.ecedb",
            "82300e9c.ebaef",
            "edc1406.22255c",
            "25ba409f.99d92"
        ],
        "x": 175,
        "y": 140,
        "wires": [
            [
                "d2a126cb.79b0c8"
            ]
        ]
    },
    {
        "id": "d2a126cb.79b0c8",
        "type": "function",
        "z": "3b5b98a.1c38768",
        "name": "Setting up question for location",
        "func": "msg.payload = {\n    text: msg.text,    \n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 470,
        "y": 140,
        "wires": [
            [
                "bcaa2825.03ec98"
            ]
        ]
    },
    {
        "id": "f83bba65.663248",
        "type": "function",
        "z": "3b5b98a.1c38768",
        "name": "Changing state filed to 'location'",
        "func": "msg.method = \"PATCH\"\nmsg.url = \"http://localhost:8000/api/v1/users/user/detail/\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": \"Token 3a02264c98f37be1a907f23ed9fb10de5fc11aec\"\n};\nmsg.payload = {\n    \"state\": \"location\"\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1210,
        "y": 140,
        "wires": [
            [
                "14d25b8f.4b64c4"
            ]
        ]
    },
    {
        "id": "c6df9017.a5565",
        "type": "debug",
        "z": "3b5b98a.1c38768",
        "name": "Changing city field to 'editing' response from db",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1800,
        "y": 220,
        "wires": []
    },
    {
        "id": "64fc7f2f.7e856",
        "type": "comment",
        "z": "3b5b98a.1c38768",
        "name": "Request message to enter a location",
        "info": "",
        "x": 300,
        "y": 100,
        "wires": []
    },
    {
        "id": "62bdcfd6.d166e",
        "type": "link in",
        "z": "68a30d94.469f94",
        "name": "Send message to set the occupation field",
        "links": [
            "8a07dd6e.fb122",
            "eb6c15f.d5924e8",
            "cbb721f9.d1df5",
            "99c3c041.c38d3",
            "4984be9d.47765",
            "76dc39c7.1f1908",
            "1b5b2acd.749c85"
        ],
        "x": 195,
        "y": 300,
        "wires": [
            [
                "c54069b2.59d4f8"
            ]
        ]
    },
    {
        "id": "c54069b2.59d4f8",
        "type": "function",
        "z": "68a30d94.469f94",
        "name": "Setting up 'choose occupation' message",
        "func": "msg.payload = {\n    text: msg.text,\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–ê–±—ñ—Ç—É—Ä—ñ—î–Ω—Ç\",\n                callback_data: \"setOccupationAsAnApplicant\"            \n            }, \n            {\n                text: \"–û–¥–∏–Ω –∑ –±–∞—Ç—å–∫—ñ–≤\",\n                callback_data: \"setOccupationAsOneOfTheParents\"            \n            }],\n            [{\n                text: \"–í–∏–∫–ª–∞–¥–∞—á\",\n                callback_data: \"setOccupationAsATeacher\"            \n            },\n            {\n                text: \"–°—Ç—É–¥–µ–Ω—Ç\",\n                callback_data: \"setOccupationAsAStudent\"            \n            }],\n            [{\n                text: \"–Ü–Ω—à–µ\",\n                callback_data: \"setOccupationAsOther\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 460,
        "y": 300,
        "wires": [
            [
                "6a938578.b8740c"
            ]
        ]
    },
    {
        "id": "efb68a90.a747e8",
        "type": "function",
        "z": "68a30d94.469f94",
        "name": "Set occupation as an applicant",
        "func": "msg.occupation = \"Applicant\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2330,
        "y": 180,
        "wires": [
            [
                "1001a33d.d9504d"
            ]
        ]
    },
    {
        "id": "35734a3f.d60566",
        "type": "function",
        "z": "68a30d94.469f94",
        "name": "Set occupation as one of the parents",
        "func": "msg.occupation = \"One of the parents\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2350,
        "y": 240,
        "wires": [
            [
                "1001a33d.d9504d"
            ]
        ]
    },
    {
        "id": "28c9f7e4.efea48",
        "type": "function",
        "z": "68a30d94.469f94",
        "name": "Set occupation as a teacher",
        "func": "msg.occupation = \"Teacher\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2320,
        "y": 300,
        "wires": [
            [
                "1001a33d.d9504d"
            ]
        ]
    },
    {
        "id": "564c6898.976ac8",
        "type": "function",
        "z": "68a30d94.469f94",
        "name": "Set occupation as a student",
        "func": "msg.occupation = \"Student\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2320,
        "y": 360,
        "wires": [
            [
                "1001a33d.d9504d"
            ]
        ]
    },
    {
        "id": "acac65a4.a6de98",
        "type": "function",
        "z": "68a30d94.469f94",
        "name": "Set occupation as other",
        "func": "msg.occupation = \"Other\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2310,
        "y": 420,
        "wires": [
            [
                "1001a33d.d9504d"
            ]
        ]
    },
    {
        "id": "bfff6d3f.b5c17",
        "type": "debug",
        "z": "68a30d94.469f94",
        "name": "Editing occupation field response from db",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 3260,
        "y": 360,
        "wires": []
    },
    {
        "id": "59d394d6.305dac",
        "type": "link out",
        "z": "68a30d94.469f94",
        "name": "Move on to printing main menu",
        "links": [
            "f1be3b15.c41ab8",
            "502c79bf.c60c68"
        ],
        "x": 3155,
        "y": 280,
        "wires": []
    },
    {
        "id": "ed917a17.8e5078",
        "type": "link in",
        "z": "68a30d94.469f94",
        "name": "Set occupation as an applicant",
        "links": [
            "2b168ecb.915b02",
            "8d8d567.b8915a8",
            "9f17155a.a2e3d8"
        ],
        "x": 1875,
        "y": 180,
        "wires": [
            [
                "efb68a90.a747e8"
            ]
        ]
    },
    {
        "id": "4f5ec5f6.e9838c",
        "type": "link in",
        "z": "68a30d94.469f94",
        "name": "Set occupation as one of the parents",
        "links": [
            "84969f23.caa1",
            "a7216124.6534",
            "ab9f10ed.c145a"
        ],
        "x": 1875,
        "y": 240,
        "wires": [
            [
                "35734a3f.d60566"
            ]
        ]
    },
    {
        "id": "f2c3d2a0.25b49",
        "type": "link in",
        "z": "68a30d94.469f94",
        "name": "Set occupation as a teacher",
        "links": [
            "b50620a8.7515",
            "5ffcf5e0.aa2fec",
            "7f128497.b6240c"
        ],
        "x": 1875,
        "y": 300,
        "wires": [
            [
                "28c9f7e4.efea48"
            ]
        ]
    },
    {
        "id": "4ed757e7.456528",
        "type": "link in",
        "z": "68a30d94.469f94",
        "name": "Set occupation as a student",
        "links": [
            "1356b19c.1cb64e",
            "3b6ee588.2aab8a",
            "68c78f79.2c1b2"
        ],
        "x": 1875,
        "y": 360,
        "wires": [
            [
                "564c6898.976ac8"
            ]
        ]
    },
    {
        "id": "bcbdc401.9580e8",
        "type": "link in",
        "z": "68a30d94.469f94",
        "name": "Set occupation as other",
        "links": [
            "ce92fb67.2ac148",
            "9eae2df4.d9717",
            "7501c22.02e853c"
        ],
        "x": 1875,
        "y": 420,
        "wires": [
            [
                "acac65a4.a6de98"
            ]
        ]
    },
    {
        "id": "f1632c06.222ac",
        "type": "comment",
        "z": "68a30d94.469f94",
        "name": "Setting occupation",
        "info": "",
        "x": 1950,
        "y": 140,
        "wires": []
    },
    {
        "id": "ba8647ee.f68c28",
        "type": "comment",
        "z": "68a30d94.469f94",
        "name": "Request message to choose an occupation",
        "info": "",
        "x": 340,
        "y": 260,
        "wires": []
    },
    {
        "id": "ea5c7390.3d1a9",
        "type": "comment",
        "z": "68a30d94.469f94",
        "name": "Move on to printing main menu",
        "info": "",
        "x": 3270,
        "y": 240,
        "wires": []
    },
    {
        "id": "e0bc4239.7e156",
        "type": "function",
        "z": "cbf72f33.63dd6",
        "name": "Editing username or city or move on to processing message",
        "func": "function isTooLongAnswer(text) {\n    if (msg.message.length > 120) {\n        msg.payload = {\n            \"text\": text,\n            \"chat_id\": msg.chat_id\n        }\n        \n        return true;\n    }\n    \n    return false;\n}\n\nmsg.method = \"PATCH\"\nmsg.url = \"http://localhost:8000/api/v1/users/user/detail/\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": \"Token 3a02264c98f37be1a907f23ed9fb10de5fc11aec\"\n};\n\nif (!msg.payload.detail) {\n    if (msg.payload.state == \"username\") {\n        if (isTooLongAnswer(\"–í–∏ –≤–≤–µ–ª–∏ –∑–∞–¥—É–∂–µ –¥–æ–≤–≥–µ —ñ–º'—è\")) return [null, null, msg, null, null];\n        \n        msg.payload = {\n            \"username\": msg.message\n        }\n        \n        //for the next question\n        msg.text = \"–ó—Ä–æ–∑—É–º—ñ–ª–æ. –î–µ –≤–∏ –ø—Ä–æ–∂–∏–≤–∞—î—Ç–µ?\";\n        \n        return [msg, null, null, null, null];\n    } else if (msg.payload.state == \"location\") {\n        if (isTooLongAnswer(\"–í–∏ –≤–≤–µ–ª–∏ –∑–∞–¥—É–∂–µ –¥–æ–≤–≥—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å\")) return [null, null, msg, null, null];\n        \n        msg.payload = {\n            \"location\": msg.message\n        }\n        \n        //for the next message\n        msg.text = \"–°—É–ø–µ—Ä. –î–ª—è –∫—Ä–∞—â–æ–≥–æ –ø—ñ–¥–±–æ—Ä—É FAQ üìä –≤–∏–±–µ—Ä—ñ—Ç—å —Å–≤—ñ–π –≤–∏–¥ –∑–∞–π–Ω—è—Ç–æ—Å—Ç—ñ\";\n        \n        return [null, msg, null, null, null];\n    } else if (msg.payload.state == \"registered\") {\n        \n        //sending saved contexts\n        msg.queryParams = {\n            \"contexts\": global.get(msg.chat_id.toString())\n        };\n        \n        //slice if it is answer to dialogflow question\n        if (msg.message.startsWith(\"answerToDFQuestion_\")) {\n            msg.payload = msg.message.slice(19);\n        } else {\n            msg.payload = msg.message;\n        }\n        \n        return [null, null, null, msg, null];\n    }\n}\n\nreturn [null, null, null, null, msg];",
        "outputs": 5,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1200,
        "y": 600,
        "wires": [
            [
                "858f85dd.43b438"
            ],
            [
                "2d8d4f52.fd9d1"
            ],
            [
                "5b53c12b.cc56"
            ],
            [
                "c82c545b.287d98"
            ],
            [
                "452a3d2.72b81c4",
                "21bc1fa0.7c76"
            ]
        ],
        "outputLabels": [
            "Saving the username field",
            "Saving the city field",
            "Sending a message",
            "Send answer to one of the most popular questions",
            "DialogFlow Processing Message"
        ]
    },
    {
        "id": "feea9eea.8f9fd",
        "type": "debug",
        "z": "cbf72f33.63dd6",
        "name": "Getting username and city fields 'Chatting flow' response from db",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1080,
        "y": 680,
        "wires": []
    },
    {
        "id": "bba92257.ecedb",
        "type": "link out",
        "z": "cbf72f33.63dd6",
        "name": "Move on to setting the location field",
        "links": [
            "b0af6159.780a4",
            "1835ced7.6011d1",
            "2afdb4a1.ffb67c"
        ],
        "x": 1975,
        "y": 180,
        "wires": []
    },
    {
        "id": "76dc39c7.1f1908",
        "type": "link out",
        "z": "cbf72f33.63dd6",
        "name": "Move on to choosing occupation",
        "links": [
            "4b1be78d.e0a2d8",
            "62bdcfd6.d166e"
        ],
        "x": 1975,
        "y": 380,
        "wires": []
    },
    {
        "id": "5581481b.706b38",
        "type": "link in",
        "z": "cbf72f33.63dd6",
        "name": "Edit username or city or process message",
        "links": [
            "17a4ed75.37c813",
            "5079e290.c379dc"
        ],
        "x": 335,
        "y": 600,
        "wires": [
            [
                "b312c38e.6cf24"
            ]
        ]
    },
    {
        "id": "11cb9c66.1c2c64",
        "type": "comment",
        "z": "cbf72f33.63dd6",
        "name": "Processing other messages. Edit username or city",
        "info": "",
        "x": 510,
        "y": 560,
        "wires": []
    },
    {
        "id": "bd92a1fe.c5f6f",
        "type": "change",
        "z": "411ddac8.164cb4",
        "name": "Setting up bot url",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "\"https://api.telegram.org/bot\" & $env('TOKEN') & \"/sendMessage\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 330,
        "y": 80,
        "wires": [
            [
                "b8d99eac.ee468"
            ]
        ]
    },
    {
        "id": "b8d99eac.ee468",
        "type": "http request",
        "z": "411ddac8.164cb4",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "basic",
        "x": 550,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "5d8decb2.3014e4",
        "type": "debug",
        "z": "cbf72f33.63dd6",
        "name": "Response from dialogflow",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2030,
        "y": 860,
        "wires": []
    },
    {
        "id": "c82c545b.287d98",
        "type": "dialogflowv2",
        "z": "cbf72f33.63dd6",
        "dialogflow": "b513f9.a96b5c08",
        "language": "uk",
        "debug": false,
        "queryParamsOK": true,
        "x": 1800,
        "y": 780,
        "wires": [
            [
                "5d8decb2.3014e4",
                "8c22d5f5.4223e8"
            ]
        ]
    },
    {
        "id": "2c767f74.82a47",
        "type": "comment",
        "z": "cbf72f33.63dd6",
        "name": "DialogFlow Processing Message",
        "info": "",
        "x": 1850,
        "y": 740,
        "wires": []
    },
    {
        "id": "63a1490b.736ab8",
        "type": "function",
        "z": "cbf72f33.63dd6",
        "name": "Setting up dialogflow response",
        "func": "msg.payload = {\n    chat_id: msg.chat_id,\n    reply_markup: {\n        inline_keyboard: [[{\n            text: \"‚óÄ –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é\",\n            callback_data: \"mainMenu\"\n        }]]\n    }\n}\n\ntry {\n    var jsonResponse = JSON.parse(msg._dialogflow.fulfillmentText.toString());\n    \n    msg.payload.text = jsonResponse.question;\n    \n    var answersArr = [];\n    jsonResponse.answers.forEach((item, i, arr) => {\n       answersArr.push({text: item.text, callback_data: \"answerToDFQuestion_\" + item.callback_data});\n    });\n    \n    msg.payload.reply_markup.inline_keyboard.unshift(answersArr);\n    \n}catch (err) {\n    msg.payload.text = msg._dialogflow.fulfillmentText;\n}\n    \n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2590,
        "y": 780,
        "wires": [
            [
                "5a2ebc6a.567e54"
            ]
        ]
    },
    {
        "id": "985d37c2.3d2328",
        "type": "comment",
        "z": "cbf72f33.63dd6",
        "name": "Move on to setting the location field",
        "info": "",
        "x": 2100,
        "y": 140,
        "wires": []
    },
    {
        "id": "74b4671f.1c13a8",
        "type": "comment",
        "z": "cbf72f33.63dd6",
        "name": "Move on to choosing occupation",
        "info": "",
        "x": 2090,
        "y": 340,
        "wires": []
    },
    {
        "id": "452a3d2.72b81c4",
        "type": "link out",
        "z": "cbf72f33.63dd6",
        "name": "Is registration completed",
        "links": [
            "6ff45d49.c66084",
            "4d1e8f79.27d3c"
        ],
        "x": 1735,
        "y": 980,
        "wires": []
    },
    {
        "id": "1795e6cf.ce9ef9",
        "type": "comment",
        "z": "cbf72f33.63dd6",
        "name": "Checking whether the registration is completed",
        "info": "",
        "x": 1900,
        "y": 940,
        "wires": []
    },
    {
        "id": "8c22d5f5.4223e8",
        "type": "function",
        "z": "cbf72f33.63dd6",
        "name": "Saving dialogflow context",
        "func": "global.set(msg.chat_id.toString(), msg._dialogflow.outputContexts);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2190,
        "y": 780,
        "wires": [
            [
                "63a1490b.736ab8"
            ]
        ]
    },
    {
        "id": "319d5b6f.be2d74",
        "type": "function",
        "z": "4001764a.8341f8",
        "name": "Removing inline keyboard",
        "func": "//remove inline keyboard\nmsg.payload = {\n    chat_id: msg.chat_id,\n    message_id: msg.message_id,\n    reply_markup: {\n        inline_keyboard: []\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 730,
        "y": 80,
        "wires": [
            [
                "ac12e929.bfded8"
            ]
        ]
    },
    {
        "id": "4a6d9a4d.b3d5b4",
        "type": "comment",
        "z": "cbf72f33.63dd6",
        "name": "Sending a message",
        "info": "",
        "x": 1810,
        "y": 560,
        "wires": []
    },
    {
        "id": "a64a08f7.365978",
        "type": "comment",
        "z": "cbf72f33.63dd6",
        "name": "Saving the city field",
        "info": "",
        "x": 1810,
        "y": 340,
        "wires": []
    },
    {
        "id": "b908221a.202f7",
        "type": "comment",
        "z": "cbf72f33.63dd6",
        "name": "Saving the username field",
        "info": "",
        "x": 1830,
        "y": 140,
        "wires": []
    },
    {
        "id": "954a6c74.4f585",
        "type": "debug",
        "z": "96f6108e.64a37",
        "name": "Start command incoming data",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 610,
        "y": 300,
        "wires": []
    },
    {
        "id": "5b53c12b.cc56",
        "type": "subflow:411ddac8.164cb4",
        "z": "cbf72f33.63dd6",
        "name": "",
        "env": [],
        "x": 1830,
        "y": 600,
        "wires": [
            []
        ]
    },
    {
        "id": "5a2ebc6a.567e54",
        "type": "subflow:411ddac8.164cb4",
        "z": "cbf72f33.63dd6",
        "name": "",
        "env": [],
        "x": 2930,
        "y": 780,
        "wires": [
            [
                "bd895bb.3ba4ea8"
            ]
        ]
    },
    {
        "id": "6a938578.b8740c",
        "type": "subflow:411ddac8.164cb4",
        "z": "68a30d94.469f94",
        "name": "",
        "env": [],
        "x": 820,
        "y": 300,
        "wires": [
            [
                "5cdcad90.c84254"
            ]
        ]
    },
    {
        "id": "bcaa2825.03ec98",
        "type": "subflow:411ddac8.164cb4",
        "z": "3b5b98a.1c38768",
        "name": "",
        "env": [],
        "x": 850,
        "y": 140,
        "wires": [
            [
                "f83bba65.663248"
            ]
        ]
    },
    {
        "id": "c538e448.9052c8",
        "type": "subflow:411ddac8.164cb4",
        "z": "4c6874fb.68b9dc",
        "name": "",
        "env": [],
        "x": 2130,
        "y": 160,
        "wires": [
            [
                "32bc9488.39455c"
            ]
        ]
    },
    {
        "id": "c965d10e.f8642",
        "type": "subflow:411ddac8.164cb4",
        "z": "96f6108e.64a37",
        "name": "",
        "env": [],
        "x": 2710,
        "y": 120,
        "wires": [
            [
                "20d295e5.2aa6ca"
            ]
        ]
    },
    {
        "id": "cece57bc.ae7278",
        "type": "subflow:411ddac8.164cb4",
        "z": "96f6108e.64a37",
        "name": "",
        "env": [],
        "x": 3550,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "a46d83e7.59837",
        "type": "change",
        "z": "4001764a.8341f8",
        "name": "Saving msg.payload",
        "rules": [
            {
                "t": "set",
                "p": "payload_copy",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 80,
        "wires": [
            [
                "319d5b6f.be2d74"
            ]
        ]
    },
    {
        "id": "cfe21d91.ca59b",
        "type": "change",
        "z": "4001764a.8341f8",
        "name": "Setting saved payload to msg.payload",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload_copy",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1730,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "ac12e929.bfded8",
        "type": "change",
        "z": "4001764a.8341f8",
        "name": "Setting up editMessageReplyMarkup url",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "\"https://api.telegram.org/bot\" & $env('TOKEN') & \"/editMessageReplyMarkup\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1060,
        "y": 80,
        "wires": [
            [
                "a41f75cf.a711d8"
            ]
        ]
    },
    {
        "id": "a41f75cf.a711d8",
        "type": "http request",
        "z": "4001764a.8341f8",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "basic",
        "x": 1350,
        "y": 80,
        "wires": [
            [
                "cfe21d91.ca59b"
            ]
        ]
    },
    {
        "id": "bd895bb.3ba4ea8",
        "type": "function",
        "z": "cbf72f33.63dd6",
        "name": "Getting info from Questions",
        "func": "msg.url = \"http://localhost:8000/api/v1/questions/question/detail/\" + msg._dialogflow.intent.displayName.split(\" \").join(\"\");\nmsg.headers = {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": \"Token 3a02264c98f37be1a907f23ed9fb10de5fc11aec\"\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 3400,
        "y": 780,
        "wires": [
            [
                "a3e38c50.eca3d"
            ]
        ]
    },
    {
        "id": "a8d398a0.9fa888",
        "type": "function",
        "z": "cbf72f33.63dd6",
        "name": "Updating calls field of question",
        "func": "if (!msg.payload.detail) {\n    msg.method = \"PATCH\";\n    msg.url = \"http://localhost:8000/api/v1/questions/question/detail/\" + msg.payload.intent;\n    msg.headers = {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": \"Token 3a02264c98f37be1a907f23ed9fb10de5fc11aec\"\n    };\n    msg.payload = {\n        \"calls\": msg.payload.calls + 1\n    }\n    \n    return msg;\n}\n\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 4070,
        "y": 780,
        "wires": [
            [
                "bb4c4877.8d7198"
            ]
        ]
    },
    {
        "id": "1c133d73.d7c5c3",
        "type": "debug",
        "z": "dbbd86af.74c0d8",
        "name": "Incoming data",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 880,
        "wires": []
    },
    {
        "id": "13e44bbe.022ec4",
        "type": "http response",
        "z": "dbbd86af.74c0d8",
        "name": "",
        "statusCode": "200",
        "headers": {},
        "x": 440,
        "y": 940,
        "wires": []
    },
    {
        "id": "be1ed164.1521d",
        "type": "function",
        "z": "dbbd86af.74c0d8",
        "name": "Formatting data",
        "func": "if (msg.payload.callback_query) {\n    msg.message = msg.payload.callback_query.data;\n        \n    msg.chat_id = msg.payload.callback_query.from.id\n    \n    msg.message_id = msg.payload.callback_query.message.message_id;\n    \n    return [msg, null];\n} else if (msg.payload.message) {\n    //saving firstname and lastname of user\n    msg.first_name = msg.payload.message.chat.first_name ? msg.payload.message.chat.first_name : '';\n    msg.last_name = msg.payload.message.chat.last_name ? msg.payload.message.chat.last_name : '';\n\n    msg.message = msg.payload.message.text;\n    \n    msg.chat_id = msg.payload.message.from.id\n    \n    msg.message_id = msg.payload.message.message_id - 1;\n    \n    return [null, msg];\n}\n\nreturn [null, null]",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 580,
        "y": 800,
        "wires": [
            [
                "c017e434.7d5098"
            ],
            [
                "336efa19.615be6"
            ]
        ]
    },
    {
        "id": "d4173cf4.07cab",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Callback query events",
        "property": "message",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "setCurrentName",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "setName",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "setOccupationAsAnApplicant",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "setOccupationAsOneOfTheParents",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "setOccupationAsATeacher",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "setOccupationAsAStudent",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "setOccupationAsOther",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "mainMenu",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "theMostPopularQuestions",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "aboutISMDepartment",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "aboutNULP",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "usingBot",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 12,
        "x": 1280,
        "y": 340,
        "wires": [
            [
                "9fa707eb.be1788"
            ],
            [
                "7009e878.03e338"
            ],
            [
                "9f17155a.a2e3d8"
            ],
            [
                "ab9f10ed.c145a"
            ],
            [
                "7f128497.b6240c"
            ],
            [
                "68c78f79.2c1b2"
            ],
            [
                "7501c22.02e853c"
            ],
            [
                "423e195b.dec3f8"
            ],
            [
                "d7b8d232.f7981"
            ],
            [
                "84602d83.794bf"
            ],
            [
                "84602d83.794bf"
            ],
            [
                "84602d83.794bf"
            ]
        ]
    },
    {
        "id": "9fa707eb.be1788",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Set username to default name",
        "links": [
            "49db1ec2.c7de4"
        ],
        "x": 1775,
        "y": 60,
        "wires": []
    },
    {
        "id": "7009e878.03e338",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Set username",
        "links": [
            "407592c4.adb5ec"
        ],
        "x": 1775,
        "y": 100,
        "wires": []
    },
    {
        "id": "423e195b.dec3f8",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Print main menu",
        "links": [
            "f1be3b15.c41ab8",
            "502c79bf.c60c68"
        ],
        "x": 1775,
        "y": 440,
        "wires": []
    },
    {
        "id": "9f17155a.a2e3d8",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Set occupation as an applicant",
        "links": [
            "3272d461.c8fe5c",
            "ed917a17.8e5078"
        ],
        "x": 1775,
        "y": 180,
        "wires": []
    },
    {
        "id": "ab9f10ed.c145a",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Set occupation as one of the parents",
        "links": [
            "84f1ccf3.e8c91",
            "4f5ec5f6.e9838c"
        ],
        "x": 1775,
        "y": 220,
        "wires": []
    },
    {
        "id": "7f128497.b6240c",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Set occupation as a teacher",
        "links": [
            "7ed591d4.8c433",
            "f2c3d2a0.25b49"
        ],
        "x": 1775,
        "y": 260,
        "wires": []
    },
    {
        "id": "68c78f79.2c1b2",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Set occupation as a student",
        "links": [
            "6ef222d3.893f0c",
            "4ed757e7.456528"
        ],
        "x": 1775,
        "y": 300,
        "wires": []
    },
    {
        "id": "7501c22.02e853c",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Set occupation as other",
        "links": [
            "bebaf9fd.57b3d8",
            "bcbdc401.9580e8"
        ],
        "x": 1775,
        "y": 340,
        "wires": []
    },
    {
        "id": "25afae95.4a6452",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Set occupation",
        "info": "# Setting occupation",
        "x": 1840,
        "y": 140,
        "wires": []
    },
    {
        "id": "4ea530d9.6681",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Main menu",
        "info": "",
        "x": 1820,
        "y": 400,
        "wires": []
    },
    {
        "id": "42e1a254.93316c",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Edit name",
        "info": "",
        "x": 1820,
        "y": 20,
        "wires": []
    },
    {
        "id": "d7b8d232.f7981",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send the most popular questions",
        "links": [
            "db785c0e.a93d6"
        ],
        "x": 1775,
        "y": 540,
        "wires": []
    },
    {
        "id": "92a60b0a.a91188",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send the most popular questions",
        "info": "",
        "x": 1890,
        "y": 500,
        "wires": []
    },
    {
        "id": "84602d83.794bf",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send message about ISM department",
        "links": [
            "b25d1f4e.85ebd",
            "94e14c4f.1155d",
            "255971.a036369"
        ],
        "x": 1775,
        "y": 640,
        "wires": []
    },
    {
        "id": "9e3a5712.5abb58",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send messages about ISM department, NULP, how to use the bot ",
        "info": "",
        "x": 1990,
        "y": 600,
        "wires": []
    },
    {
        "id": "59c1267b.ca3c98",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Answer to dialogflow question",
        "property": "$split(msg.message, \"_\", 1)",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "eq",
                "v": "answerToDFQuestion",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1310,
        "y": 920,
        "wires": [
            [
                "17a4ed75.37c813"
            ]
        ]
    },
    {
        "id": "17a4ed75.37c813",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Process message",
        "links": [
            "957981a1.8fdad",
            "62416c5b.bd8764",
            "5581481b.706b38"
        ],
        "x": 1775,
        "y": 920,
        "wires": []
    },
    {
        "id": "a1439bf8.dd9a78",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Process message",
        "info": "",
        "x": 1850,
        "y": 880,
        "wires": []
    },
    {
        "id": "db142eec.63a9b",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Set answer to popular question(pagination)",
        "property": "$split(msg.message, \"_\", 1)",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "eq",
                "v": "theMostPopularQPagination",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1350,
        "y": 780,
        "wires": [
            [
                "44ca7e7d.f7226"
            ]
        ]
    },
    {
        "id": "44ca7e7d.f7226",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Set answer to popular question(pagination)",
        "links": [
            "db785c0e.a93d6"
        ],
        "x": 1775,
        "y": 780,
        "wires": []
    },
    {
        "id": "695523ed.ad23dc",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Set answer to popular question(pagination)",
        "info": "",
        "x": 1920,
        "y": 740,
        "wires": []
    },
    {
        "id": "712534ba.03dabc",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "/start",
        "links": [
            "bb24cad3.d57618"
        ],
        "x": 1775,
        "y": 1940,
        "wires": []
    },
    {
        "id": "5079e290.c379dc",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Process message",
        "links": [
            "5581481b.706b38"
        ],
        "x": 1915,
        "y": 2160,
        "wires": []
    },
    {
        "id": "2cd9581b.de63b8",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Other user messages",
        "info": "",
        "x": 2000,
        "y": 2120,
        "wires": []
    },
    {
        "id": "2caa3ca0.e8c6a4",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Start",
        "info": "",
        "x": 1810,
        "y": 1900,
        "wires": []
    },
    {
        "id": "c255e784.8ab028",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Start or admin or message",
        "property": "message",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "/start",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "/admin",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 1300,
        "y": 2020,
        "wires": [
            [
                "712534ba.03dabc"
            ],
            [
                "ebcc50de.24dfc"
            ],
            [
                "c3b92b1d.852d98"
            ]
        ]
    },
    {
        "id": "7e88b121.6fb1e",
        "type": "http in",
        "z": "dbbd86af.74c0d8",
        "name": "",
        "url": "/bot",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 220,
        "y": 800,
        "wires": [
            [
                "1c133d73.d7c5c3",
                "13e44bbe.022ec4",
                "be1ed164.1521d"
            ]
        ]
    },
    {
        "id": "58ada314.42903c",
        "type": "function",
        "z": "96f6108e.64a37",
        "name": "Registering new user row in db",
        "func": "msg.url = \"http://localhost:8000/api/v1/users/user/create\";\nmsg.headers = {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": \"Token 3a02264c98f37be1a907f23ed9fb10de5fc11aec\"\n};\nmsg.payload = {\n    \"user_telegram_id\": msg.chat_id,\n    \"state\": \"created\"\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1690,
        "y": 120,
        "wires": [
            [
                "a67c174.729e1e8"
            ]
        ]
    },
    {
        "id": "3038c760.952438",
        "type": "debug",
        "z": "96f6108e.64a37",
        "name": "Registering new user response from db",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2300,
        "y": 200,
        "wires": []
    },
    {
        "id": "502c79bf.c60c68",
        "type": "link in",
        "z": "df5e43cb.b674f",
        "name": "Print main menu",
        "links": [
            "9d38cfeb.72544",
            "cfe6162e.b07178",
            "fee03af4.838098",
            "76361c43.ee74f4",
            "59d394d6.305dac",
            "3dff8462.4ec1dc",
            "423e195b.dec3f8",
            "beaeab00.e10d98"
        ],
        "x": 195,
        "y": 160,
        "wires": [
            [
                "e26cee31.fdd81"
            ]
        ]
    },
    {
        "id": "e26cee31.fdd81",
        "type": "function",
        "z": "df5e43cb.b674f",
        "name": "Setting up message with main menu",
        "func": "msg.payload = {\n    text: \"‚úÖ –í–∏ –≤ –≥–æ–ª–æ–≤–Ω–æ–º—É –º–µ–Ω—é. –ó–∞–¥–∞–≤–∞–π—Ç–µ –ø–∏—Ç–∞–Ω–Ω—è —á–∏ –æ–±–µ—Ä—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –ø—É–Ω–∫—Ç\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–ù–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à—ñ –ø–∏—Ç–∞–Ω–Ω—è üî•\",\n                callback_data: \"theMostPopularQuestions\"            \n            }], \n            [{\n                text: \"–ü—Ä–æ –∫–∞—Ñ–µ–¥—Ä—É ICM üòé\",\n                callback_data: \"aboutISMDepartment\"            \n            },\n            {\n                text: \"–ü—Ä–æ –ù–£–õ–ü üöÄ\",\n                callback_data: \"aboutNULP\"            \n            }],\n            [{\n                text: \"–Ø–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ç–∏—Å—è –±–æ—Ç–æ–º üìÅ\",\n                callback_data: \"usingBot\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 450,
        "y": 160,
        "wires": [
            [
                "744eb46c.1a166c"
            ]
        ]
    },
    {
        "id": "a3e54823.a72818",
        "type": "comment",
        "z": "df5e43cb.b674f",
        "name": "Message with main menu",
        "info": "",
        "x": 290,
        "y": 120,
        "wires": []
    },
    {
        "id": "744eb46c.1a166c",
        "type": "subflow:411ddac8.164cb4",
        "z": "df5e43cb.b674f",
        "name": "",
        "env": [],
        "x": 810,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "58a6af09.78559",
        "type": "function",
        "z": "696b129b.360e0c",
        "name": "Is registration completed",
        "func": "if (msg.payload.state == \"created\" || msg.payload.state == \"username\") {\n    //for the next question\n    msg.text = \"–ß–∏ –º–æ–∂—É —è –¥–æ –≤–∞—Å –∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—è \" + msg.first_name + \" \" + msg.last_name + \"?\";\n    \n    return [msg, null, null, null];\n} else if (msg.payload.state == \"location\") {\n    //for the next question\n    msg.text = \"–î–µ –≤–∏ –ø—Ä–æ–∂–∏–≤–∞—î—Ç–µ?\";\n    \n    return [null, msg, null, null];\n} else if (msg.payload.state == \"occupation\") {\n    //for the next question\n    msg.text = \"–î–ª—è –∫—Ä–∞—â–æ–≥–æ –ø—ñ–¥–±–æ—Ä—É FAQ üìä –≤–∏–±–µ—Ä—ñ—Ç—å —Å–≤—ñ–π –≤–∏–¥ –∑–∞–π–Ω—è—Ç–æ—Å—Ç—ñ\";\n    \n    return [null, null, msg, null];\n}\n\nreturn [null, null, null, msg];",
        "outputs": 4,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 890,
        "y": 320,
        "wires": [
            [
                "b62113f8.d98b5"
            ],
            [
                "25ba409f.99d92"
            ],
            [
                "1b5b2acd.749c85"
            ],
            [
                "beaeab00.e10d98"
            ]
        ],
        "inputLabels": [
            "Checking whether the registration is completed"
        ],
        "outputLabels": [
            "Move on to setting the username field again",
            "Move on to setting the location field again",
            "Move on to setting the occupation field again",
            "Send main menu message"
        ]
    },
    {
        "id": "25ba409f.99d92",
        "type": "link out",
        "z": "696b129b.360e0c",
        "name": "Move on to setting the location field again",
        "links": [
            "1835ced7.6011d1",
            "2afdb4a1.ffb67c"
        ],
        "x": 1195,
        "y": 260,
        "wires": []
    },
    {
        "id": "1b5b2acd.749c85",
        "type": "link out",
        "z": "696b129b.360e0c",
        "name": "Move on to setting the occupation field again",
        "links": [
            "62bdcfd6.d166e"
        ],
        "x": 1195,
        "y": 380,
        "wires": []
    },
    {
        "id": "beaeab00.e10d98",
        "type": "link out",
        "z": "696b129b.360e0c",
        "name": "Send main menu message",
        "links": [
            "f1be3b15.c41ab8",
            "502c79bf.c60c68"
        ],
        "x": 1195,
        "y": 500,
        "wires": []
    },
    {
        "id": "4f8a25d5.b0636c",
        "type": "comment",
        "z": "696b129b.360e0c",
        "name": "Send main menu message",
        "info": "",
        "x": 1290,
        "y": 460,
        "wires": []
    },
    {
        "id": "4d1e8f79.27d3c",
        "type": "link in",
        "z": "696b129b.360e0c",
        "name": "Is registration completed",
        "links": [
            "452a3d2.72b81c4",
            "65f19cea.cc3ef4"
        ],
        "x": 355,
        "y": 320,
        "wires": [
            [
                "58a6af09.78559"
            ]
        ]
    },
    {
        "id": "4ce7c89d.99df08",
        "type": "comment",
        "z": "696b129b.360e0c",
        "name": "Move on to setting the location field again",
        "info": "",
        "x": 1340,
        "y": 220,
        "wires": []
    },
    {
        "id": "4ec2269f.2800f8",
        "type": "comment",
        "z": "696b129b.360e0c",
        "name": "Move on to setting the occupation field again",
        "info": "",
        "x": 1350,
        "y": 340,
        "wires": []
    },
    {
        "id": "eec829d9.ecc588",
        "type": "comment",
        "z": "696b129b.360e0c",
        "name": "Checking whether the registration is completed",
        "info": "",
        "x": 520,
        "y": 280,
        "wires": []
    },
    {
        "id": "62f23a28.fa8414",
        "type": "comment",
        "z": "696b129b.360e0c",
        "name": "Move on to setting the username field again",
        "info": "",
        "x": 1350,
        "y": 100,
        "wires": []
    },
    {
        "id": "65f19cea.cc3ef4",
        "type": "link out",
        "z": "96f6108e.64a37",
        "name": "Is registration completed",
        "links": [
            "4d1e8f79.27d3c"
        ],
        "x": 1575,
        "y": 300,
        "wires": []
    },
    {
        "id": "7c78aa7a.0ce5a4",
        "type": "comment",
        "z": "96f6108e.64a37",
        "name": "Check whether the registration is completed",
        "info": "",
        "x": 1730,
        "y": 260,
        "wires": []
    },
    {
        "id": "a009902e.25a1b",
        "type": "subflow:411ddac8.164cb4",
        "z": "696b129b.360e0c",
        "name": "",
        "env": [],
        "x": 2390,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "e074a2a5.84fdc",
        "type": "function",
        "z": "696b129b.360e0c",
        "name": "Setting up request message to set username",
        "func": "msg.payload = {\n    text: msg.text,\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–¢–∞–∫, –∑–≤—ñ—Å–Ω–æ\",\n                callback_data: \"setCurrentName\"\n            }, \n            {\n                text: \"–Ø —Ö–æ—á—É –∑–º—ñ–Ω–∏—Ç–∏\",\n                callback_data: \"setName\"\n            }]\n        ]\n    },\n    chat_id: msg.chat_id,\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2010,
        "y": 140,
        "wires": [
            [
                "a009902e.25a1b"
            ]
        ]
    },
    {
        "id": "5c5914e5.d60a4c",
        "type": "function",
        "z": "d3d080fa.62628",
        "name": "Setting up next or last question",
        "func": " msg.payload = {\n    text: msg.message + \". \" + msg.payload.question + \"\\n\\n–í—ñ–¥–ø–æ–≤—ñ–¥—å:\\n\" + msg.payload.answer,\n    chat_id: msg.chat_id,\n    message_id: msg.message_id,\n    reply_markup: {\n        inline_keyboard: [[]]\n    },\n}\n\nif (msg.message > 1) {\n    msg.payload.reply_markup.inline_keyboard[0].push({\n                text: \"‚óÄ –ù–∞–∑–∞–¥\",\n                callback_data: \"theMostPopularQPagination_\" + (msg.message - 1)\n            });\n}\n\nif (msg.message < 5) {\n    msg.payload.reply_markup.inline_keyboard[0].push({\n                text: \"–î–∞–ª—ñ ‚ñ∂\",\n                callback_data: \"theMostPopularQPagination_\" + (msg.message + 1)\n            });\n}\n\nmsg.payload.reply_markup.inline_keyboard.push([{\n        text: \"‚óÄ –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é\",\n        callback_data: \"mainMenu\"\n    }]);\n\nif (msg.sendAsASimpleMessage) return [msg, null];\nelse return [null, msg];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1050,
        "y": 180,
        "wires": [
            [
                "d5c114ce.369d48"
            ],
            [
                "9fc24cee.822f5"
            ]
        ]
    },
    {
        "id": "5b820640.b7dcf8",
        "type": "comment",
        "z": "d3d080fa.62628",
        "name": "Setting up answer to next or last or first question(pagination)",
        "info": "",
        "x": 420,
        "y": 140,
        "wires": []
    },
    {
        "id": "9fc24cee.822f5",
        "type": "change",
        "z": "d3d080fa.62628",
        "name": "Setting up editMessageText url",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "\"https://api.telegram.org/bot\" & $env('TOKEN') & \"/editMessageText\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1390,
        "y": 300,
        "wires": [
            [
                "43f8240a.a3c04c"
            ]
        ]
    },
    {
        "id": "43f8240a.a3c04c",
        "type": "http request",
        "z": "d3d080fa.62628",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "basic",
        "x": 1670,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "db785c0e.a93d6",
        "type": "link in",
        "z": "d3d080fa.62628",
        "name": "Set answer to question(pagination)",
        "links": [
            "44ca7e7d.f7226",
            "d7b8d232.f7981"
        ],
        "x": 215,
        "y": 180,
        "wires": [
            [
                "393aa544.3be7ba"
            ]
        ]
    },
    {
        "id": "393aa544.3be7ba",
        "type": "function",
        "z": "d3d080fa.62628",
        "name": "Getting info from questions",
        "func": "msg.sendAsASimpleMessage = false;\n\nif (msg.message.startsWith(\"theMostPopularQPagination_\")) {\n    msg.message = parseInt(msg.message.split(\"_\")[1]);\n} else {\n    msg.message = 1;\n    \n    msg.sendAsASimpleMessage = true;\n}\n\nmsg.url = \"http://localhost:8000/api/v1/questions/theMostPopularWithLimitQuestions/\" + (msg.message - 1) + \"/\" + msg.message;\nmsg.headers = {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": \"Token 3a02264c98f37be1a907f23ed9fb10de5fc11aec\"\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 440,
        "y": 180,
        "wires": [
            [
                "ffff4207.4cbe7"
            ]
        ]
    },
    {
        "id": "255971.a036369",
        "type": "link in",
        "z": "276bc02d.e347",
        "name": "Send message with page info",
        "links": [
            "84602d83.794bf"
        ],
        "x": 75,
        "y": 100,
        "wires": [
            [
                "7d62bb88.a5bb24"
            ]
        ]
    },
    {
        "id": "dd7e88ad.066828",
        "type": "function",
        "z": "276bc02d.e347",
        "name": "Setting up message info",
        "func": "msg.payload = {\n    parse_mode: \"html\",\n    text: msg.payload.content,\n    chat_id: msg.chat_id,\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"‚óÄ –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é\",\n                callback_data: \"mainMenu\"\n            }]\n        ]\n    },\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 910,
        "y": 100,
        "wires": [
            [
                "a38f117b.4a1c1"
            ]
        ]
    },
    {
        "id": "640de173.48ae8",
        "type": "comment",
        "z": "276bc02d.e347",
        "name": "Message with page Info",
        "info": "",
        "x": 160,
        "y": 60,
        "wires": []
    },
    {
        "id": "7d62bb88.a5bb24",
        "type": "function",
        "z": "276bc02d.e347",
        "name": "Getting info from InfoPages",
        "func": "msg.url = \"http://localhost:8000/api/v1/infopages/infopage/detail/\" + msg.payload.callback_query.data;\nmsg.headers = {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": \"Token 3a02264c98f37be1a907f23ed9fb10de5fc11aec\"\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 100,
        "wires": [
            [
                "9ad5d228.d8ffb"
            ]
        ]
    },
    {
        "id": "b8e30ec7.7d583",
        "type": "debug",
        "z": "276bc02d.e347",
        "name": "Getting info from InfoPage response from db",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 850,
        "y": 180,
        "wires": []
    },
    {
        "id": "a38f117b.4a1c1",
        "type": "subflow:411ddac8.164cb4",
        "z": "276bc02d.e347",
        "name": "",
        "env": [],
        "x": 1230,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "336efa19.615be6",
        "type": "subflow:4001764a.8341f8",
        "z": "dbbd86af.74c0d8",
        "name": "",
        "env": [],
        "x": 870,
        "y": 2020,
        "wires": [
            [
                "c255e784.8ab028"
            ]
        ]
    },
    {
        "id": "c017e434.7d5098",
        "type": "subflow:4001764a.8341f8",
        "z": "dbbd86af.74c0d8",
        "name": "",
        "env": [],
        "x": 870,
        "y": 760,
        "wires": [
            [
                "d4173cf4.07cab",
                "db142eec.63a9b",
                "59c1267b.ca3c98",
                "500b8046.0202",
                "4acba4db.21b67c",
                "a525eef0.3d2fc"
            ]
        ]
    },
    {
        "id": "d5c114ce.369d48",
        "type": "subflow:411ddac8.164cb4",
        "z": "d3d080fa.62628",
        "name": "",
        "env": [],
        "x": 1390,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "de1e2237.23c0a",
        "type": "function",
        "z": "96f6108e.64a37",
        "name": "Getting user row",
        "func": "msg.url = \"http://localhost:8000/api/v1/users/user/detail/\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": \"Token 3a02264c98f37be1a907f23ed9fb10de5fc11aec\"\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 600,
        "y": 220,
        "wires": [
            [
                "a092bba8.d7b3c8"
            ]
        ]
    },
    {
        "id": "a092bba8.d7b3c8",
        "type": "http request",
        "z": "96f6108e.64a37",
        "name": "",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 810,
        "y": 220,
        "wires": [
            [
                "41e89314.19813c",
                "776fd5bc.aa182c"
            ]
        ]
    },
    {
        "id": "a67c174.729e1e8",
        "type": "http request",
        "z": "96f6108e.64a37",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 2010,
        "y": 120,
        "wires": [
            [
                "3038c760.952438",
                "cab5fa05.8972f8"
            ]
        ]
    },
    {
        "id": "4a21bcb4.3b48f4",
        "type": "http request",
        "z": "4c6874fb.68b9dc",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 690,
        "y": 160,
        "wires": [
            [
                "4d10c364.bba70c",
                "f553be12.15931"
            ]
        ]
    },
    {
        "id": "36cbe213.34e8fe",
        "type": "http request",
        "z": "4c6874fb.68b9dc",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 2750,
        "y": 160,
        "wires": [
            [
                "29b87cf7.8de694"
            ]
        ]
    },
    {
        "id": "14d25b8f.4b64c4",
        "type": "http request",
        "z": "3b5b98a.1c38768",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 1490,
        "y": 140,
        "wires": [
            [
                "c6df9017.a5565"
            ]
        ]
    },
    {
        "id": "57f0180.55088e8",
        "type": "http request",
        "z": "68a30d94.469f94",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 2970,
        "y": 280,
        "wires": [
            [
                "bfff6d3f.b5c17",
                "59d394d6.305dac"
            ]
        ]
    },
    {
        "id": "1001a33d.d9504d",
        "type": "function",
        "z": "68a30d94.469f94",
        "name": "Set occupation field",
        "func": "msg.method = \"PATCH\"\nmsg.url = \"http://localhost:8000/api/v1/users/user/detail/\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": \"Token 3a02264c98f37be1a907f23ed9fb10de5fc11aec\"\n};\nmsg.payload = {\n    \"occupation\": msg.occupation,\n    \"state\": \"registered\"\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2730,
        "y": 280,
        "wires": [
            [
                "57f0180.55088e8"
            ]
        ]
    },
    {
        "id": "4bd896c6.be6278",
        "type": "http request",
        "z": "cbf72f33.63dd6",
        "name": "",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 730,
        "y": 600,
        "wires": [
            [
                "feea9eea.8f9fd",
                "e0bc4239.7e156"
            ]
        ]
    },
    {
        "id": "b312c38e.6cf24",
        "type": "function",
        "z": "cbf72f33.63dd6",
        "name": "Getting user row",
        "func": "msg.url = \"http://localhost:8000/api/v1/users/user/detail/\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": \"Token 3a02264c98f37be1a907f23ed9fb10de5fc11aec\"\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 520,
        "y": 600,
        "wires": [
            [
                "4bd896c6.be6278"
            ]
        ]
    },
    {
        "id": "858f85dd.43b438",
        "type": "http request",
        "z": "cbf72f33.63dd6",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 1790,
        "y": 180,
        "wires": [
            [
                "bba92257.ecedb"
            ]
        ]
    },
    {
        "id": "2d8d4f52.fd9d1",
        "type": "http request",
        "z": "cbf72f33.63dd6",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 1790,
        "y": 380,
        "wires": [
            [
                "76dc39c7.1f1908"
            ]
        ]
    },
    {
        "id": "ffff4207.4cbe7",
        "type": "http request",
        "z": "d3d080fa.62628",
        "name": "",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 710,
        "y": 180,
        "wires": [
            [
                "5c5914e5.d60a4c",
                "ed00339e.04b77"
            ]
        ]
    },
    {
        "id": "ed00339e.04b77",
        "type": "debug",
        "z": "d3d080fa.62628",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 860,
        "y": 300,
        "wires": []
    },
    {
        "id": "a3e38c50.eca3d",
        "type": "http request",
        "z": "cbf72f33.63dd6",
        "name": "",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 3690,
        "y": 780,
        "wires": [
            [
                "a8d398a0.9fa888"
            ]
        ]
    },
    {
        "id": "bb4c4877.8d7198",
        "type": "http request",
        "z": "cbf72f33.63dd6",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 4370,
        "y": 780,
        "wires": [
            []
        ]
    },
    {
        "id": "9ad5d228.d8ffb",
        "type": "http request",
        "z": "276bc02d.e347",
        "name": "",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 570,
        "y": 100,
        "wires": [
            [
                "dd7e88ad.066828",
                "b8e30ec7.7d583"
            ]
        ]
    },
    {
        "id": "ebcc50de.24dfc",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Admin permission check",
        "links": [
            "10bc7ce3.c92493"
        ],
        "x": 1775,
        "y": 2020,
        "wires": []
    },
    {
        "id": "39c371c1.697aee",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Admin",
        "info": "",
        "x": 1810,
        "y": 1980,
        "wires": []
    },
    {
        "id": "10bc7ce3.c92493",
        "type": "link in",
        "z": "14785f2b.3d2341",
        "name": "Admin permission check",
        "links": [
            "ebcc50de.24dfc"
        ],
        "x": 215,
        "y": 320,
        "wires": [
            [
                "c5b5d78d.28c2f8"
            ]
        ]
    },
    {
        "id": "27ffd58.392ce2a",
        "type": "function",
        "z": "14785f2b.3d2341",
        "name": "Admin telegram id",
        "func": "msg.url = \"http://localhost:8000/api/v1/admins/admin/tIdIsAdmin\";\nmsg.headers = {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": \"Token 3a02264c98f37be1a907f23ed9fb10de5fc11aec\"\n};\nmsg.payload = {\n    \"user_telegram_id\": msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 630,
        "y": 260,
        "wires": [
            [
                "23355ee4.42e6b2"
            ]
        ]
    },
    {
        "id": "22e75983.fc5e96",
        "type": "comment",
        "z": "14785f2b.3d2341",
        "name": "Admin telegram id",
        "info": "",
        "x": 630,
        "y": 220,
        "wires": []
    },
    {
        "id": "23355ee4.42e6b2",
        "type": "http request",
        "z": "14785f2b.3d2341",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 890,
        "y": 260,
        "wires": [
            [
                "dc2b53c3.deda4"
            ]
        ]
    },
    {
        "id": "dc2b53c3.deda4",
        "type": "switch",
        "z": "14785f2b.3d2341",
        "name": "",
        "property": "payload.success",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1100,
        "y": 260,
        "wires": [
            [
                "94a275bf.bc4bf8"
            ],
            [
                "3df9c3f8.76229c"
            ]
        ]
    },
    {
        "id": "3df9c3f8.76229c",
        "type": "link out",
        "z": "14785f2b.3d2341",
        "name": "",
        "links": [
            "bb24cad3.d57618"
        ],
        "x": 1255,
        "y": 360,
        "wires": []
    },
    {
        "id": "1dab72ef.9781fd",
        "type": "comment",
        "z": "14785f2b.3d2341",
        "name": "Move on to simple /start",
        "info": "",
        "x": 1340,
        "y": 320,
        "wires": []
    },
    {
        "id": "94a275bf.bc4bf8",
        "type": "link out",
        "z": "14785f2b.3d2341",
        "name": "Move on to admin authentication",
        "links": [
            "d5cd829c.4da0d"
        ],
        "x": 1255,
        "y": 160,
        "wires": []
    },
    {
        "id": "a9eebed7.2c41b",
        "type": "comment",
        "z": "14785f2b.3d2341",
        "name": "Move on to authentication",
        "info": "",
        "x": 1350,
        "y": 120,
        "wires": []
    },
    {
        "id": "d5cd829c.4da0d",
        "type": "link in",
        "z": "27a4d84f.90dc58",
        "name": "Admin authentication",
        "links": [
            "94a275bf.bc4bf8"
        ],
        "x": 195,
        "y": 100,
        "wires": [
            [
                "2c09c454.955c1c"
            ]
        ]
    },
    {
        "id": "b9b30aa4.913de8",
        "type": "comment",
        "z": "27a4d84f.90dc58",
        "name": "Admin authentication",
        "info": "",
        "x": 280,
        "y": 60,
        "wires": []
    },
    {
        "id": "2c09c454.955c1c",
        "type": "function",
        "z": "27a4d84f.90dc58",
        "name": "Setting up message with main menu",
        "func": "msg.payload = {\n    text: \"–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å\",\n    chat_id: msg.chat_id\n}\n\n//means admin authentication process\narr = global.get(\"admin_auth\");\narr.push(msg.chat_id.toString());\nglobal.set(\"admin_auth\", arr);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 450,
        "y": 100,
        "wires": [
            [
                "f4cf9845.c9c9e8"
            ]
        ]
    },
    {
        "id": "f4cf9845.c9c9e8",
        "type": "subflow:411ddac8.164cb4",
        "z": "27a4d84f.90dc58",
        "name": "",
        "env": [],
        "x": 810,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "c3b92b1d.852d98",
        "type": "function",
        "z": "dbbd86af.74c0d8",
        "name": "Admin message or user message",
        "func": "if (global.get(\"admin_auth\").includes(msg.chat_id.toString()) || global.get(\"admin_message\").includes(msg.chat_id.toString())) return [msg, null]\n\nreturn [null, msg];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1700,
        "y": 2120,
        "wires": [
            [
                "5aa25e4d.afa2f"
            ],
            [
                "5079e290.c379dc"
            ]
        ],
        "outputLabels": [
            "Process admin message",
            "Process user message"
        ]
    },
    {
        "id": "5aa25e4d.afa2f",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Process admin message",
        "links": [
            "dae42a0e.30b798"
        ],
        "x": 1915,
        "y": 2080,
        "wires": []
    },
    {
        "id": "81311556.602fe8",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Other admin messages",
        "info": "",
        "x": 2000,
        "y": 2040,
        "wires": []
    },
    {
        "id": "dae42a0e.30b798",
        "type": "link in",
        "z": "741a84b0.eaaafc",
        "name": "Process admin message",
        "links": [
            "5aa25e4d.afa2f"
        ],
        "x": 175,
        "y": 280,
        "wires": [
            [
                "bc131d5d.f24c7"
            ]
        ]
    },
    {
        "id": "1ef275a0.a014aa",
        "type": "comment",
        "z": "741a84b0.eaaafc",
        "name": "Process admin message",
        "info": "",
        "x": 270,
        "y": 240,
        "wires": []
    },
    {
        "id": "bc131d5d.f24c7",
        "type": "function",
        "z": "741a84b0.eaaafc",
        "name": "if authentication",
        "func": "if (global.get(\"admin_auth\").includes(msg.chat_id.toString())) return [msg, null];\n\nreturn [null, msg];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 360,
        "y": 280,
        "wires": [
            [
                "16824839.79df98"
            ],
            []
        ],
        "outputLabels": [
            "Authentication process",
            "Admin message"
        ]
    },
    {
        "id": "1557dc1a.094de4",
        "type": "inject",
        "z": "dbbd86af.74c0d8",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 220,
        "y": 580,
        "wires": [
            [
                "efdf46fe.490458"
            ]
        ]
    },
    {
        "id": "efdf46fe.490458",
        "type": "function",
        "z": "dbbd86af.74c0d8",
        "name": "",
        "func": "global.set(\"admin_message\", []);\nglobal.set(\"admin_auth\", []);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 450,
        "y": 580,
        "wires": [
            []
        ]
    },
    {
        "id": "344615c3.358eea",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Go to statistics category",
        "func": "msg.payload = {\n    text: \"–í–∏–±–µ—Ä—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –ø—É–Ω–∫—Ç üìä\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–ù–∞–π–±—ñ–ª—å—à –ø–æ—à–∏—Ä–µ–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è\",\n                callback_data: \"FAQ\"            \n            }, \n            {\n                text: \"–ü–∏—Ç–∞–Ω–Ω—è –±–µ–∑ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ\",\n                callback_data: \"unansweredQuestions\"            \n            }],\n            [{\n                text: \"–ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤\",\n                callback_data: \"totalNumberOfUsers\"            \n            },\n            {\n                text: \"–ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –ø–µ–≤–Ω–æ—ó –≥—Ä—É–ø–∏\",\n                callback_data: \"numberOfUsersOfAGroup\"            \n            }],\n            [{\n                text: \"‚óÄ –ù–∞–∑–∞–¥\",\n                callback_data: \"/admin\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1350,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "cfc8f9c8.ab1158",
        "type": "link in",
        "z": "b1ea2d1b.82b21",
        "name": "Show statistic",
        "links": [
            "6965b3ef.b05a6c",
            "5641ac71.778604"
        ],
        "x": 1015,
        "y": 120,
        "wires": [
            [
                "344615c3.358eea"
            ]
        ]
    },
    {
        "id": "99c536c4.fd8938",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Choose a category for distribution",
        "func": "msg.payload = {\n    text: \"–í–∏–±–µ—Ä—ñ—Ç—å –∫–∞—Ç–µ–≥–æ—Ä—ñ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ üôÇ\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–ê–±—ñ—Ç—É—Ä—ñ—î–Ω—Ç–∏\",\n                callback_data: \"distributionToApplicants\"            \n            }, \n            {\n                text: \"–ë–∞—Ç—å–∫–∏\",\n                callback_data: \"distributionToParents\"            \n            }],\n            [{\n                text: \"–í–∏–∫–ª–∞–¥–∞—á—ñ\",\n                callback_data: \"distributionToTeachers\"            \n            },\n            {\n                text: \"–°—Ç—É–¥–µ–Ω—Ç–∏\",\n                callback_data: \"distributionToStudents\"            \n            }],\n            [{\n                text: \"–Ü–Ω—à–µ\",\n                callback_data: \"distributionToOther\"            \n            }],\n            [{\n                text: \"‚óÄ –ù–∞–∑–∞–¥\",\n                callback_data: \"/admin\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1000,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "ab5703fb.0a78a",
        "type": "link in",
        "z": "b1ea2d1b.82b21",
        "name": "Go to distribution",
        "links": [
            "bca370b2.8614a"
        ],
        "x": 775,
        "y": 540,
        "wires": [
            [
                "99c536c4.fd8938"
            ]
        ]
    },
    {
        "id": "e996dbb6.2058f8",
        "type": "comment",
        "z": "b1ea2d1b.82b21",
        "name": "Distribution categories",
        "info": "",
        "x": 900,
        "y": 480,
        "wires": []
    },
    {
        "id": "a889b7d4.e813c8",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Add a category for distribution",
        "func": "msg.payload = {\n    text: \"–•–æ—á–µ—Ç–µ –¥–æ–¥–∞—Ç–∏ —â–µ –æ–¥–Ω—É –∫–∞—Ç–µ–≥–æ—Ä—ñ—é?\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–¢–∞–∫\",\n                callback_data: \"/distribution\"            \n            }, \n            {\n                text: \"–ù—ñ\",\n                callback_data: \"?\"            \n            }],\n            [{\n                text: \"‚óÄ –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é\",\n                callback_data: \"/admin\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1650,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "a87dece3.2de2d",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Setting up message with admin dashboard",
        "func": "msg.payload = {\n    text: \"–í–∏ –≤ –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—ñ. –í–∏–±–µ—Ä—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –ø—É–Ω–∫—Ç\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\",\n                callback_data: \"statistics\"            \n            }], \n            [{\n                text: \"–†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ ICM üòé\",\n                callback_data: \"editAboutISMDepartment\"            \n            },\n            {\n                text: \"–†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –ù–£–õ–ü üöÄ\",\n                callback_data: \"editAboutNULP\"            \n            }],\n            [{\n                text: \"–ú–∞—Å–æ–≤–∞ —Ä–æ–∑—Å–∏–ª–∫–∞ üì©\",\n                callback_data: \"distribution\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 690,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "69aef460.cf3e2c",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Manage admins",
        "func": "msg.payload = {\n    text: \"–©–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –∑—Ä–æ–±–∏—Ç–∏?\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–î–æ–¥–∞—Ç–∏ –∞–¥–º—ñ–Ω–∞\",\n                callback_data: \"addAdmin\"            \n            }, \n            {\n                text: \"–í–∏–¥–∞–ª–∏—Ç–∏ –∞–¥–º—ñ–Ω–∞\",\n                callback_data: \"RemoveAdmin\"            \n            }],\n            [{\n                text: \"‚óÄ –ù–∞–∑–∞–¥\",\n                callback_data: \"/admin\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 240,
        "y": 1320,
        "wires": [
            []
        ]
    },
    {
        "id": "e3967c44.a671e",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Change distribution text",
        "func": "msg.payload = {\n    text: \"–í–∫–∞–∂—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –¥–ª—è —Ä–æ–∑—Å–∏–ª–∫–∏ —Ç–µ–∫—Å—Ç\",    \n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2250,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "9bc97024.47b0d",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Send or cancel distribution",
        "func": "msg.payload = {\n    text: \"–ö–∞—Ç–µ–≥–æ—Ä—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤: {{–ø–µ—Ä–µ–ª—ñ–∫ –∫–∞—Ç–µ–≥–æ—Ä—ñ–π}}\\n–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: {{—Ç–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è}}\\n –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –æ–±—Ä–∞–Ω–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º?\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–ù—ñ, –ø–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å –¥–æ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è\",\n                callback_data: \"backToEditDistribution\"            \n            }, \n            {\n                text: \"–¢–∞–∫, –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏\",\n                callback_data: \"completeDistribution\"            \n            }],\n            [{\n                text: \"–ü–æ–≤–Ω—ñ—Å—Ç—é —Å–∫–∞—Å—É–≤–∞—Ç–∏ —Ä–æ–∑—Å–∏–ª–∫—É\",\n                callback_data: \"cancelDistribution\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 880,
        "y": 660,
        "wires": [
            []
        ]
    },
    {
        "id": "6337cfd.d265a3",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Setting",
        "func": "msg.payload = {\n    text: msg.text,    \n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 960,
        "wires": [
            []
        ]
    },
    {
        "id": "e9bdd4e8.a56fb8",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Changing field",
        "func": "msg.topic = \"\" + msg.chat_id + \";\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 960,
        "y": 960,
        "wires": [
            []
        ]
    },
    {
        "id": "53aa4578.f58adc",
        "type": "comment",
        "z": "b1ea2d1b.82b21",
        "name": "Editing information about NULP ???",
        "info": "",
        "x": 240,
        "y": 880,
        "wires": []
    },
    {
        "id": "dd2ac3e1.7cccd",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Setting",
        "func": "msg.payload = {\n    text: msg.text,    \n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 1160,
        "wires": [
            []
        ]
    },
    {
        "id": "b5a54a2d.91c298",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Changing field",
        "func": "msg.topic = \"\" + msg.chat_id + \";\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 960,
        "y": 1160,
        "wires": [
            []
        ]
    },
    {
        "id": "d2faf575.1796a8",
        "type": "comment",
        "z": "b1ea2d1b.82b21",
        "name": "Editing information about ISM department ???",
        "info": "",
        "x": 250,
        "y": 1080,
        "wires": []
    },
    {
        "id": "f4f7a179.c65be",
        "type": "switch",
        "z": "b1ea2d1b.82b21",
        "name": "Admin callback query intents",
        "property": "message",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "statistics",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "editAboutISMDepartment",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "editAboutNULP",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "distribution",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "FAQ",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "unansweredQuestions",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "totalNumberOfUsers",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "numberOfUsersOfAGroup",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "distributionToApplicants",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "distributionToParents",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "distributionToTeachers",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "distributionToStudents",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "distributionToOther",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "adminManagement",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "adminActions",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 15,
        "x": 140,
        "y": 640,
        "wires": [
            [
                "5641ac71.778604"
            ],
            [
                "b3c3f223.3798d"
            ],
            [
                "d3269b3f.ccfe78"
            ],
            [
                "bca370b2.8614a"
            ],
            [
                "4f821a82.75bcf4"
            ],
            [
                "5f533f59.85069"
            ],
            [
                "490790b4.64729"
            ],
            [
                "e174b3ee.5eb9c"
            ],
            [],
            [],
            [],
            [],
            [],
            [
                "9d367b3a.ca6028"
            ],
            []
        ]
    },
    {
        "id": "5641ac71.778604",
        "type": "link out",
        "z": "b1ea2d1b.82b21",
        "name": "Show statistics",
        "links": [
            "cfc8f9c8.ab1158"
        ],
        "x": 455,
        "y": 280,
        "wires": []
    },
    {
        "id": "b3c3f223.3798d",
        "type": "link out",
        "z": "b1ea2d1b.82b21",
        "name": "Edit information about ISM department",
        "links": [
            "6986fe3a.50a85",
            "26e89225.c59d4e",
            "b36272d5.bde41"
        ],
        "x": 455,
        "y": 380,
        "wires": []
    },
    {
        "id": "bca370b2.8614a",
        "type": "link out",
        "z": "b1ea2d1b.82b21",
        "name": "Go to distribution",
        "links": [
            "ab5703fb.0a78a"
        ],
        "x": 455,
        "y": 500,
        "wires": []
    },
    {
        "id": "4f821a82.75bcf4",
        "type": "link out",
        "z": "b1ea2d1b.82b21",
        "name": "Show FAQ",
        "links": [
            "7f977952.648338",
            "77a41681.f01f38"
        ],
        "x": 455,
        "y": 580,
        "wires": []
    },
    {
        "id": "5f533f59.85069",
        "type": "link out",
        "z": "b1ea2d1b.82b21",
        "name": "Show unanswered questions",
        "links": [
            "f3e8d2c8.19afa",
            "87b6ef4a.30d78"
        ],
        "x": 455,
        "y": 620,
        "wires": []
    },
    {
        "id": "490790b4.64729",
        "type": "link out",
        "z": "b1ea2d1b.82b21",
        "name": "Show total number of users",
        "links": [
            "82b6101e.1144f",
            "b0314280.97558"
        ],
        "x": 455,
        "y": 660,
        "wires": []
    },
    {
        "id": "e174b3ee.5eb9c",
        "type": "link out",
        "z": "b1ea2d1b.82b21",
        "name": "Show number of users of a group",
        "links": [
            "cac99f77.6400b",
            "e70393a1.21477"
        ],
        "x": 455,
        "y": 700,
        "wires": []
    },
    {
        "id": "ad821c0c.35548",
        "type": "comment",
        "z": "b1ea2d1b.82b21",
        "name": "Edit information about ISM department and NULP",
        "info": "# Setting occupation",
        "x": 620,
        "y": 340,
        "wires": []
    },
    {
        "id": "d3269b3f.ccfe78",
        "type": "link out",
        "z": "b1ea2d1b.82b21",
        "name": "Edit information about NULP",
        "links": [],
        "x": 455,
        "y": 420,
        "wires": []
    },
    {
        "id": "503d465d.e3bec8",
        "type": "comment",
        "z": "b1ea2d1b.82b21",
        "name": "Go to statistics",
        "info": "",
        "x": 520,
        "y": 240,
        "wires": []
    },
    {
        "id": "b3de6661.d816c8",
        "type": "comment",
        "z": "b1ea2d1b.82b21",
        "name": "Send the distribution",
        "info": "",
        "x": 530,
        "y": 460,
        "wires": []
    },
    {
        "id": "37aa1c2.30659e4",
        "type": "comment",
        "z": "b1ea2d1b.82b21",
        "name": "Show statistics categories",
        "info": "",
        "x": 550,
        "y": 540,
        "wires": []
    },
    {
        "id": "4d8d7dfb.063694",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Show FAQ",
        "func": "return msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1430,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "99a168fb.f89498",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Show unanswered questions",
        "func": "return msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1480,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "63d943ea.eab55c",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Show total number of users",
        "func": "return msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1480,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "54ceaf5e.19242",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Show number of users of a group",
        "func": "return msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1500,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "77a41681.f01f38",
        "type": "link in",
        "z": "b1ea2d1b.82b21",
        "name": "Show FAQ",
        "links": [
            "1ebbb82d.0a3458",
            "2b168ecb.915b02",
            "4f821a82.75bcf4"
        ],
        "x": 1035,
        "y": 260,
        "wires": [
            [
                "4d8d7dfb.063694"
            ]
        ]
    },
    {
        "id": "87b6ef4a.30d78",
        "type": "link in",
        "z": "b1ea2d1b.82b21",
        "name": "Show unanswered questions",
        "links": [
            "a30a37ca.2e1f78",
            "5f533f59.85069"
        ],
        "x": 1035,
        "y": 320,
        "wires": [
            [
                "99a168fb.f89498"
            ]
        ]
    },
    {
        "id": "b0314280.97558",
        "type": "link in",
        "z": "b1ea2d1b.82b21",
        "name": "Show total number of users",
        "links": [
            "99a0be48.893df",
            "490790b4.64729"
        ],
        "x": 1035,
        "y": 380,
        "wires": [
            [
                "63d943ea.eab55c"
            ]
        ]
    },
    {
        "id": "e70393a1.21477",
        "type": "link in",
        "z": "b1ea2d1b.82b21",
        "name": "Show number of users of a group",
        "links": [
            "3d614410.5a40ac",
            "e174b3ee.5eb9c"
        ],
        "x": 1035,
        "y": 440,
        "wires": [
            [
                "54ceaf5e.19242"
            ]
        ]
    },
    {
        "id": "601c8e6e.fccd4",
        "type": "comment",
        "z": "b1ea2d1b.82b21",
        "name": "Statistics categories",
        "info": "",
        "x": 1450,
        "y": 200,
        "wires": []
    },
    {
        "id": "2b226c1b.3be674",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Add a category for distribution",
        "func": "msg.payload = {\n    text: \"–©–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –≤—ñ–¥—Ä–µ–∞–¥–∞–≥—É–≤–∞—Ç–∏?\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–ö–∞—Ç–µ–≥–æ—Ä—ñ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤\",\n                callback_data: \"?\"            \n            }, \n            {\n                text: \"–¢–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è\",\n                callback_data: \"?\"            \n            }],\n            [{\n                text: \"–Ü —Ç–µ —ñ —ñ–Ω—à–µ\",\n                callback_data: \"/distribution\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1510,
        "y": 760,
        "wires": [
            []
        ]
    },
    {
        "id": "5d1834bd.9664dc",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Add Admin",
        "func": "msg.payload = {\n    text: \"–í–∫–∞–∂—ñ—Ç—å userName\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–ù–∞–∑–∞–¥\",\n                callback_data: \"/adminActions\"            \n            } \n        ]]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 870,
        "y": 1260,
        "wires": [
            []
        ]
    },
    {
        "id": "6986fe3a.50a85",
        "type": "link in",
        "z": "b1ea2d1b.82b21",
        "name": "Edit information about ISM department",
        "links": [
            "b3c3f223.3798d"
        ],
        "x": 75,
        "y": 960,
        "wires": [
            [
                "112570bb.791c7f"
            ]
        ]
    },
    {
        "id": "26e89225.c59d4e",
        "type": "link in",
        "z": "b1ea2d1b.82b21",
        "name": "Edit information about NULP",
        "links": [
            "b3c3f223.3798d"
        ],
        "x": 75,
        "y": 1160,
        "wires": [
            [
                "1120c0d6.09b31f"
            ]
        ]
    },
    {
        "id": "112570bb.791c7f",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Change text field",
        "func": "msg.payload = {\n    text: \"–í–∫–∞–∂—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è üçé\",    \n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 210,
        "y": 960,
        "wires": [
            [
                "6337cfd.d265a3"
            ]
        ]
    },
    {
        "id": "1120c0d6.09b31f",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Change text field",
        "func": "msg.payload = {\n    text: \"–í–∫–∞–∂—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è üçé\",    \n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 210,
        "y": 1160,
        "wires": [
            [
                "dd2ac3e1.7cccd"
            ]
        ]
    },
    {
        "id": "9d367b3a.ca6028",
        "type": "link out",
        "z": "b1ea2d1b.82b21",
        "name": "Manage admins",
        "links": [
            "e50360d2.4636c"
        ],
        "x": 435,
        "y": 820,
        "wires": []
    },
    {
        "id": "e50360d2.4636c",
        "type": "link in",
        "z": "b1ea2d1b.82b21",
        "name": "Manage admins",
        "links": [
            "9d367b3a.ca6028"
        ],
        "x": 95,
        "y": 1320,
        "wires": [
            [
                "69aef460.cf3e2c"
            ]
        ]
    },
    {
        "id": "c22b6f74.7a66",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Remove Admin",
        "func": "msg.payload = {\n    text: \"–í–∏–±–µ—Ä—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ–≥–æ –∞–¥–º—ñ–Ω–∞\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–ê–¥–º—ñ–Ω 1\",\n                callback_data: \"?\"            \n            }, \n            {\n                text: \"–ê–¥–º—ñ–Ω N\",\n                callback_data: \"?\"            \n            }],\n            [{\n                text: \"‚óÄ –ù–∞–∑–∞–¥\",\n                callback_data: \"/manageAdmins\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 860,
        "y": 1380,
        "wires": [
            []
        ]
    },
    {
        "id": "14487d05.843283",
        "type": "function",
        "z": "b1ea2d1b.82b21",
        "name": "Confirm Remove Admin",
        "func": "msg.payload = {\n    text: \"–í–∏ —Ç–æ—á–Ω–æ –±–∞–∂–∞—î—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü—å–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ –∞–¥–º—ñ–Ω—ñ–≤?\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–¢–∞–∫\",\n                callback_data: \"?\"            \n            }, \n            {\n                text: \"–ù—ñ\",\n                callback_data: \"?\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1430,
        "y": 1380,
        "wires": [
            []
        ]
    },
    {
        "id": "4ba34618.3d5c38",
        "type": "comment",
        "z": "b1ea2d1b.82b21",
        "name": "Manage admins",
        "info": "",
        "x": 500,
        "y": 780,
        "wires": []
    },
    {
        "id": "fa7a75a2.b53dc8",
        "type": "function",
        "z": "3d74a532.309a9a",
        "name": "Check password",
        "func": "msg.url = \"http://localhost:8000/api/v1/admins/admin/isAdmin\";\nmsg.headers = {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": \"Token 3a02264c98f37be1a907f23ed9fb10de5fc11aec\"\n};\nmsg.payload = {\n    \"user_telegram_id\": msg.chat_id,\n    \"password\": msg.message\n}\n\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 390,
        "y": 280,
        "wires": [
            [
                "653aed01.599b24"
            ]
        ]
    },
    {
        "id": "653aed01.599b24",
        "type": "http request",
        "z": "3d74a532.309a9a",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 630,
        "y": 280,
        "wires": [
            [
                "374ce18f.11570e"
            ]
        ]
    },
    {
        "id": "3261bb5b.1076c4",
        "type": "subflow:411ddac8.164cb4",
        "z": "3d74a532.309a9a",
        "name": "",
        "env": [],
        "x": 1530,
        "y": 140,
        "wires": [
            [
                "251e1dc6.f7dae2"
            ]
        ]
    },
    {
        "id": "c209732a.e2143",
        "type": "function",
        "z": "3d74a532.309a9a",
        "name": "Setting up message about successful auth",
        "func": "msg.payload = {\n    text: \"–£—Å–ø—ñ—à–Ω–∏–π –≤—Ö—ñ–¥\",\n    chat_id: msg.chat_id\n}\n\nvar arr = global.get(\"admin_message\");\narr.push(msg.chat_id.toString());\nglobal.set(\"admin_message\", arr);\n\n//admin authentication process was ended\narr = global.get(\"admin_auth\");\narr.pop(arr.indexOf(msg.chat_id.toString()));\nglobal.set(\"admin_auth\", arr);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1180,
        "y": 140,
        "wires": [
            [
                "3261bb5b.1076c4"
            ]
        ]
    },
    {
        "id": "374ce18f.11570e",
        "type": "switch",
        "z": "3d74a532.309a9a",
        "name": "Check response",
        "property": "payload.success",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 840,
        "y": 280,
        "wires": [
            [
                "c209732a.e2143"
            ],
            [
                "bcd9a922.47b278"
            ]
        ]
    },
    {
        "id": "4b1a9e4.e3d226",
        "type": "subflow:411ddac8.164cb4",
        "z": "3d74a532.309a9a",
        "name": "",
        "env": [],
        "x": 1790,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "296a5036.0498f",
        "type": "function",
        "z": "3d74a532.309a9a",
        "name": "Setting up message about wrong password",
        "func": "msg.payload = {\n    text: \"–ù–µ–≤—ñ—Ä–Ω–∏–π –ø–∞—Ä–æ–ª—å\",\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1470,
        "y": 280,
        "wires": [
            [
                "4b1a9e4.e3d226"
            ]
        ]
    },
    {
        "id": "bcd9a922.47b278",
        "type": "switch",
        "z": "3d74a532.309a9a",
        "name": "Wrong password or other errors",
        "property": "payload.wrong_password",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1120,
        "y": 340,
        "wires": [
            [
                "296a5036.0498f"
            ],
            [
                "6a998187.d7f0f"
            ]
        ]
    },
    {
        "id": "15e13901.8f3487",
        "type": "subflow:411ddac8.164cb4",
        "z": "3d74a532.309a9a",
        "name": "",
        "env": [],
        "x": 1790,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "6a998187.d7f0f",
        "type": "function",
        "z": "3d74a532.309a9a",
        "name": "Setting up message about failde auth",
        "func": "msg.payload = {\n    text: \"–ü–æ–º–∏–ª–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó\",\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1450,
        "y": 400,
        "wires": [
            [
                "15e13901.8f3487"
            ]
        ]
    },
    {
        "id": "16824839.79df98",
        "type": "link out",
        "z": "741a84b0.eaaafc",
        "name": "Admin authentication process",
        "links": [
            "fcdda474.e64398"
        ],
        "x": 515,
        "y": 180,
        "wires": []
    },
    {
        "id": "ccc974b5.3ec5d8",
        "type": "comment",
        "z": "741a84b0.eaaafc",
        "name": "Admin authentication process",
        "info": "",
        "x": 620,
        "y": 140,
        "wires": []
    },
    {
        "id": "fcdda474.e64398",
        "type": "link in",
        "z": "3d74a532.309a9a",
        "name": "Admin authentication process",
        "links": [
            "16824839.79df98"
        ],
        "x": 175,
        "y": 280,
        "wires": [
            [
                "fa7a75a2.b53dc8"
            ]
        ]
    },
    {
        "id": "61178589.efb29c",
        "type": "comment",
        "z": "3d74a532.309a9a",
        "name": "Checking if password is correct",
        "info": "",
        "x": 290,
        "y": 240,
        "wires": []
    },
    {
        "id": "251e1dc6.f7dae2",
        "type": "link out",
        "z": "3d74a532.309a9a",
        "name": "Send admin menu",
        "links": [
            "174b2f09.720ee1"
        ],
        "x": 1755,
        "y": 140,
        "wires": []
    },
    {
        "id": "f33922f7.202e7",
        "type": "comment",
        "z": "3d74a532.309a9a",
        "name": "Send admin menu",
        "info": "",
        "x": 1830,
        "y": 100,
        "wires": []
    },
    {
        "id": "174b2f09.720ee1",
        "type": "link in",
        "z": "74e0bd75.30b964",
        "name": "Send admin menu",
        "links": [
            "251e1dc6.f7dae2",
            "a0263de3.c8c3d",
            "6fc70e3b.e2da2",
            "16626079.4e26d"
        ],
        "x": 195,
        "y": 180,
        "wires": [
            [
                "7a6c7bed.6c8544"
            ]
        ]
    },
    {
        "id": "f8c321de.c69c",
        "type": "comment",
        "z": "74e0bd75.30b964",
        "name": "Sending admin menu",
        "info": "",
        "x": 280,
        "y": 140,
        "wires": []
    },
    {
        "id": "ee6a100.26f8bf",
        "type": "subflow:411ddac8.164cb4",
        "z": "74e0bd75.30b964",
        "name": "",
        "env": [],
        "x": 850,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "7a6c7bed.6c8544",
        "type": "function",
        "z": "74e0bd75.30b964",
        "name": "Setting up message with admin menu",
        "func": "msg.payload = {\n    text: \"–í–∏ –≤ –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—ñ. –í–∏–±–µ—Ä—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –ø—É–Ω–∫—Ç\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\",\n                callback_data: \"statistics\"            \n            }], \n            [{\n                text: \"–†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ ICM üòé\",\n                callback_data: \"editAboutISMDepartment\"            \n            }],\n            [{\n                text: \"–†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –ù–£–õ–ü üöÄ\",\n                callback_data: \"editAboutNULP\"            \n            }],\n            [{\n                text: \"–ú–∞—Å–æ–≤–∞ —Ä–æ–∑—Å–∏–ª–∫–∞ üì©\",\n                callback_data: \"distribution\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 490,
        "y": 180,
        "wires": [
            [
                "ee6a100.26f8bf"
            ]
        ]
    },
    {
        "id": "c5b5d78d.28c2f8",
        "type": "function",
        "z": "14785f2b.3d2341",
        "name": "if admin",
        "func": "if (global.get(\"admin_message\").includes(msg.chat_id.toString())) return [null, msg];\n\nreturn [msg, null];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 360,
        "y": 320,
        "wires": [
            [
                "27ffd58.392ce2a"
            ],
            [
                "a0263de3.c8c3d"
            ]
        ]
    },
    {
        "id": "feea9f00.ef13e",
        "type": "comment",
        "z": "14785f2b.3d2341",
        "name": "Checking permissions",
        "info": "",
        "x": 300,
        "y": 280,
        "wires": []
    },
    {
        "id": "a0263de3.c8c3d",
        "type": "link out",
        "z": "14785f2b.3d2341",
        "name": "Send admin menu",
        "links": [
            "174b2f09.720ee1"
        ],
        "x": 555,
        "y": 380,
        "wires": []
    },
    {
        "id": "2315c330.7e6ecc",
        "type": "comment",
        "z": "14785f2b.3d2341",
        "name": "Send admin menu",
        "info": "",
        "x": 630,
        "y": 340,
        "wires": []
    },
    {
        "id": "5cdcad90.c84254",
        "type": "function",
        "z": "68a30d94.469f94",
        "name": "Changing state field to 'occupation'",
        "func": "msg.method = \"PATCH\"\nmsg.url = \"http://localhost:8000/api/v1/users/user/detail/\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": \"Token 3a02264c98f37be1a907f23ed9fb10de5fc11aec\"\n};\nmsg.payload = {\n    \"state\": \"occupation\"\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1240,
        "y": 300,
        "wires": [
            [
                "993855d7.043228"
            ]
        ]
    },
    {
        "id": "993855d7.043228",
        "type": "http request",
        "z": "68a30d94.469f94",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 1530,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "21bc1fa0.7c76",
        "type": "debug",
        "z": "cbf72f33.63dd6",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1520,
        "y": 800,
        "wires": []
    },
    {
        "id": "b62113f8.d98b5",
        "type": "function",
        "z": "696b129b.360e0c",
        "name": "Changing state filed to 'created'",
        "func": "msg.method = \"PATCH\"\nmsg.url = \"http://localhost:8000/api/v1/users/user/detail/\" + msg.chat_id;\nmsg.headers = {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": \"Token 3a02264c98f37be1a907f23ed9fb10de5fc11aec\"\n};\nmsg.payload = {\n    \"state\": \"created\"\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1310,
        "y": 140,
        "wires": [
            [
                "b36044b0.dd6018"
            ]
        ]
    },
    {
        "id": "b36044b0.dd6018",
        "type": "http request",
        "z": "696b129b.360e0c",
        "name": "",
        "method": "use",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 1590,
        "y": 140,
        "wires": [
            [
                "e074a2a5.84fdc"
            ]
        ]
    },
    {
        "id": "a5af100c.3c9e6",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Callback admin query events",
        "property": "message",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "adminMenu",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "statistics",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "theMostPopularQuestionsForAdmin",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "totalNumberOfUsers",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "groupsMenuNumberOfUsers",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 5,
        "x": 1500,
        "y": 1280,
        "wires": [
            [
                "16626079.4e26d"
            ],
            [
                "441568f.2e4a998"
            ],
            [
                "857490ee.89b9d"
            ],
            [
                "384d9cd0.c20d84"
            ],
            [
                "88664c92.b9374"
            ]
        ]
    },
    {
        "id": "500b8046.0202",
        "type": "function",
        "z": "dbbd86af.74c0d8",
        "name": "If admin",
        "func": "if(global.get(\"admin_message\").includes(msg.chat_id.toString())) return msg;\n\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1250,
        "y": 1280,
        "wires": [
            [
                "a5af100c.3c9e6"
            ]
        ]
    },
    {
        "id": "441568f.2e4a998",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send admin statistics menu",
        "links": [
            "e6b71aba.a6e668"
        ],
        "x": 1775,
        "y": 1240,
        "wires": []
    },
    {
        "id": "1314e790.78d638",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send admin statistics menu",
        "info": "",
        "x": 1880,
        "y": 1200,
        "wires": []
    },
    {
        "id": "e6b71aba.a6e668",
        "type": "link in",
        "z": "892838ee.3ab438",
        "name": "Send admin statistics menu",
        "links": [
            "441568f.2e4a998"
        ],
        "x": 175,
        "y": 100,
        "wires": [
            [
                "62fb6121.5b6d6"
            ]
        ]
    },
    {
        "id": "69997a3a.806a74",
        "type": "comment",
        "z": "892838ee.3ab438",
        "name": "Sending admin statistics menu",
        "info": "",
        "x": 290,
        "y": 60,
        "wires": []
    },
    {
        "id": "62fb6121.5b6d6",
        "type": "function",
        "z": "892838ee.3ab438",
        "name": "Setting up message with admin statistics menu",
        "func": "msg.payload = {\n    text: \"–í–∏–±–µ—Ä—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –ø—É–Ω–∫—Ç üìä\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–ù–∞–π–±—ñ–ª—å—à –ø–æ—à–∏—Ä–µ–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è\",\n                callback_data: \"theMostPopularQuestionsForAdmin\"            \n            }],\n            [{\n                text: \"–ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤\",\n                callback_data: \"totalNumberOfUsers\"            \n            }],\n            [{\n                text: \"–ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –ø–µ–≤–Ω–æ—ó –≥—Ä—É–ø–∏\",\n                callback_data: \"groupsMenuNumberOfUsers\"            \n            }],\n            [{\n                text: \"‚óÄ –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é\",\n                callback_data: \"adminMenu\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 480,
        "y": 100,
        "wires": [
            [
                "ef71566a.78a108"
            ]
        ]
    },
    {
        "id": "ef71566a.78a108",
        "type": "subflow:411ddac8.164cb4",
        "z": "892838ee.3ab438",
        "name": "",
        "x": 870,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "384d9cd0.c20d84",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Get total number of users",
        "links": [
            "fa6195ba.f6b108"
        ],
        "x": 1775,
        "y": 1400,
        "wires": []
    },
    {
        "id": "b83bf345.f41b6",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Get total number of users",
        "info": "",
        "x": 1870,
        "y": 1360,
        "wires": []
    },
    {
        "id": "fa6195ba.f6b108",
        "type": "link in",
        "z": "892838ee.3ab438",
        "name": "Get total number of users",
        "links": [
            "384d9cd0.c20d84"
        ],
        "x": 175,
        "y": 460,
        "wires": [
            [
                "b21b9fd9.f3f67"
            ]
        ]
    },
    {
        "id": "9cefd413.fc1df8",
        "type": "comment",
        "z": "892838ee.3ab438",
        "name": "Getting total number of users",
        "info": "",
        "x": 280,
        "y": 420,
        "wires": []
    },
    {
        "id": "b21b9fd9.f3f67",
        "type": "function",
        "z": "892838ee.3ab438",
        "name": "Getting total number of users",
        "func": "msg.url = \"http://localhost:8000/api/v1/admins/users/totalNumber\";\nmsg.headers = {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": \"Token 3a02264c98f37be1a907f23ed9fb10de5fc11aec\"\n};\n\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 460,
        "wires": [
            [
                "38d61daa.3cd252"
            ]
        ]
    },
    {
        "id": "84ca21f9.36fa6",
        "type": "function",
        "z": "892838ee.3ab438",
        "name": "Setting up message with total number of users",
        "func": "msg.payload = {\n    text: \"–ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤: \" + msg.payload.total_number,\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"‚óÄ –ù–∞–∑–∞–¥\",\n                callback_data: \"statistics\"            \n            }],\n            [{\n                text: \"‚óÄ –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é\",\n                callback_data: \"adminMenu\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1120,
        "y": 460,
        "wires": [
            [
                "3ef52885.a11438"
            ]
        ]
    },
    {
        "id": "3ef52885.a11438",
        "type": "subflow:411ddac8.164cb4",
        "z": "892838ee.3ab438",
        "name": "",
        "x": 1510,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "38d61daa.3cd252",
        "type": "http request",
        "z": "892838ee.3ab438",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 690,
        "y": 460,
        "wires": [
            [
                "84ca21f9.36fa6"
            ]
        ]
    },
    {
        "id": "5450672d.fe9ef8",
        "type": "link in",
        "z": "892838ee.3ab438",
        "name": "Send number of users of a group",
        "links": [
            "1efe31e6.57de7e"
        ],
        "x": 175,
        "y": 680,
        "wires": [
            [
                "3351e7aa.306c48"
            ]
        ]
    },
    {
        "id": "b3b02c42.b5d37",
        "type": "comment",
        "z": "892838ee.3ab438",
        "name": "Sending number of users of a group",
        "info": "",
        "x": 300,
        "y": 640,
        "wires": []
    },
    {
        "id": "3351e7aa.306c48",
        "type": "function",
        "z": "892838ee.3ab438",
        "name": "Getting total number of users",
        "func": "msg.url = \"http://localhost:8000/api/v1/admins/users/numberOfUsersOfAGroup/\" + msg.message.split('_')[1];\nmsg.headers = {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": \"Token 3a02264c98f37be1a907f23ed9fb10de5fc11aec\"\n};\n\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 680,
        "wires": [
            [
                "2b4e12c0.32921e"
            ]
        ]
    },
    {
        "id": "b467cc69.58282",
        "type": "function",
        "z": "892838ee.3ab438",
        "name": "Setting up message with number of users of a group",
        "func": "msg.payload = {\n    text: \"–ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤: \" + msg.payload.total_number,reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"‚óÄ –ù–∞–∑–∞–¥\",\n                callback_data: \"groupsMenuNumberOfUsers\"            \n            }],\n            [{\n                text: \"‚óÄ –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é\",\n                callback_data: \"adminMenu\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1140,
        "y": 680,
        "wires": [
            [
                "c087148f.a272d8"
            ]
        ]
    },
    {
        "id": "c087148f.a272d8",
        "type": "subflow:411ddac8.164cb4",
        "z": "892838ee.3ab438",
        "name": "",
        "x": 1570,
        "y": 680,
        "wires": [
            []
        ]
    },
    {
        "id": "2b4e12c0.32921e",
        "type": "http request",
        "z": "892838ee.3ab438",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 690,
        "y": 680,
        "wires": [
            [
                "b467cc69.58282"
            ]
        ]
    },
    {
        "id": "1efe31e6.57de7e",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send number of users of a group",
        "links": [
            "5450672d.fe9ef8"
        ],
        "x": 1775,
        "y": 1620,
        "wires": []
    },
    {
        "id": "6f51c3f6.40991c",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send number of users of a group",
        "info": "",
        "x": 1890,
        "y": 1580,
        "wires": []
    },
    {
        "id": "4acba4db.21b67c",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Admin users statistics of groups",
        "property": "$split(msg.message, \"_\", 1)",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "eq",
                "v": "numberOfUsersOfAGroup",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1310,
        "y": 1620,
        "wires": [
            [
                "1efe31e6.57de7e"
            ]
        ]
    },
    {
        "id": "e73d99f1.c57c58",
        "type": "link in",
        "z": "892838ee.3ab438",
        "name": "Send menu with groups (number of users)",
        "links": [
            "88664c92.b9374"
        ],
        "x": 175,
        "y": 600,
        "wires": [
            [
                "3e97624e.e1943e"
            ]
        ]
    },
    {
        "id": "febae297.ef2cf",
        "type": "comment",
        "z": "892838ee.3ab438",
        "name": "Sending menu with groups (number of users)",
        "info": "",
        "x": 330,
        "y": 560,
        "wires": []
    },
    {
        "id": "3e97624e.e1943e",
        "type": "function",
        "z": "892838ee.3ab438",
        "name": "Setting up message with menu with groups",
        "func": "msg.payload = {\n    text: \"–í–∏–±–µ—Ä—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –ø—É–Ω–∫—Ç üìä\",\n    reply_markup: {\n        inline_keyboard: [[\n            {\n                text: \"–ê–±—ñ—Ç—É—Ä—ñ—î–Ω—Ç\",\n                callback_data: \"numberOfUsersOfAGroup_Applicant\"            \n            }, \n            {\n                text: \"–û–¥–∏–Ω –∑ –±–∞—Ç—å–∫—ñ–≤\",\n                callback_data: \"numberOfUsersOfAGroup_OneOfTheParents\"            \n            }],\n            [{\n                text: \"–í–∏–∫–ª–∞–¥–∞—á\",\n                callback_data: \"numberOfUsersOfAGroup_Teacher\"            \n            },\n            {\n                text: \"–°—Ç—É–¥–µ–Ω—Ç\",\n                callback_data: \"numberOfUsersOfAGroup_Student\"            \n            }],\n            [{\n                text: \"–Ü–Ω—à–µ\",\n                callback_data: \"numberOfUsersOfAGroup_Other\"            \n            }],\n            [{\n                text: \"‚óÄ –ù–∞–∑–∞–¥\",\n                callback_data: \"statistics\"            \n            }],\n            [{\n                text: \"‚óÄ –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é\",\n                callback_data: \"adminMenu\"            \n            }]\n        ]\n    },\n    chat_id: msg.chat_id\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 470,
        "y": 600,
        "wires": [
            [
                "88c9da92.3faac8"
            ]
        ]
    },
    {
        "id": "88c9da92.3faac8",
        "type": "subflow:411ddac8.164cb4",
        "z": "892838ee.3ab438",
        "name": "",
        "x": 850,
        "y": 600,
        "wires": [
            []
        ]
    },
    {
        "id": "88664c92.b9374",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send menu with groups (number of users)",
        "links": [
            "e73d99f1.c57c58"
        ],
        "x": 1775,
        "y": 1480,
        "wires": []
    },
    {
        "id": "a193e222.7975b",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send menu with groups (number of users)",
        "info": "",
        "x": 1920,
        "y": 1440,
        "wires": []
    },
    {
        "id": "16626079.4e26d",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send admin menu",
        "links": [
            "174b2f09.720ee1"
        ],
        "x": 1775,
        "y": 1140,
        "wires": []
    },
    {
        "id": "c4e635cf.389bf8",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send admin menu",
        "info": "",
        "x": 1850,
        "y": 1100,
        "wires": []
    },
    {
        "id": "78e346f1.8e8b28",
        "type": "function",
        "z": "892838ee.3ab438",
        "name": "Setting up next or last question",
        "func": " msg.payload = {\n    text: msg.message + \". \" + msg.payload.question + \"\\n\\n–ó–∞–¥–∞–Ω–æ: \" + msg.payload.calls + \"\\n\\n–í—ñ–¥–ø–æ–≤—ñ–¥—å:\\n\" + msg.payload.answer,\n    chat_id: msg.chat_id,\n    message_id: msg.message_id,\n    reply_markup: {\n        inline_keyboard: [[]]\n    },\n}\n\nif (msg.message > 1) {\n    msg.payload.reply_markup.inline_keyboard[0].push({\n                text: \"‚óÄ –ù–∞–∑–∞–¥\",\n                callback_data: \"theMostPopularQPaginationForAdmin_\" + (msg.message - 1)\n            });\n}\n\nif (msg.message < 5) {\n    msg.payload.reply_markup.inline_keyboard[0].push({\n                text: \"–î–∞–ª—ñ ‚ñ∂\",\n                callback_data: \"theMostPopularQPaginationForAdmin_\" + (msg.message + 1)\n            });\n}\n\nmsg.payload.reply_markup.inline_keyboard.push([{\n        text: \"‚óÄ –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é\",\n        callback_data: \"adminMenu\"\n    }]);\n\nif (msg.sendAsASimpleMessage) return [msg, null];\nelse return [null, msg];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1010,
        "y": 240,
        "wires": [
            [
                "230ea498.065ddc"
            ],
            [
                "2ef67ced.c751b4"
            ]
        ]
    },
    {
        "id": "206e324c.35e26e",
        "type": "comment",
        "z": "892838ee.3ab438",
        "name": "Setting up answer to next or last or first question for admin (pagination)",
        "info": "",
        "x": 410,
        "y": 200,
        "wires": []
    },
    {
        "id": "2ef67ced.c751b4",
        "type": "change",
        "z": "892838ee.3ab438",
        "name": "Setting up editMessageText url",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "\"https://api.telegram.org/bot\" & $env('TOKEN') & \"/editMessageText\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1350,
        "y": 360,
        "wires": [
            [
                "134eb23c.9aa8fe"
            ]
        ]
    },
    {
        "id": "134eb23c.9aa8fe",
        "type": "http request",
        "z": "892838ee.3ab438",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "basic",
        "x": 1630,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "4329a74.1062558",
        "type": "link in",
        "z": "892838ee.3ab438",
        "name": "Set answer to question for admin (pagination)",
        "links": [
            "857490ee.89b9d",
            "87c7d03d.ab97b"
        ],
        "x": 175,
        "y": 240,
        "wires": [
            [
                "6ca8bcf8.3c9544"
            ]
        ]
    },
    {
        "id": "6ca8bcf8.3c9544",
        "type": "function",
        "z": "892838ee.3ab438",
        "name": "Getting info from questions",
        "func": "msg.sendAsASimpleMessage = false;\n\nif (msg.message.startsWith(\"theMostPopularQPaginationForAdmin_\")) {\n    msg.message = parseInt(msg.message.split(\"_\")[1]);\n} else {\n    msg.message = 1;\n    \n    msg.sendAsASimpleMessage = true;\n}\n\nmsg.url = \"http://localhost:8000/api/v1/questions/theMostPopularWithLimitQuestions/\" + (msg.message - 1) + \"/\" + msg.message;\nmsg.headers = {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": \"Token 3a02264c98f37be1a907f23ed9fb10de5fc11aec\"\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 400,
        "y": 240,
        "wires": [
            [
                "12232cbb.f802d3"
            ]
        ]
    },
    {
        "id": "230ea498.065ddc",
        "type": "subflow:411ddac8.164cb4",
        "z": "892838ee.3ab438",
        "name": "",
        "env": [],
        "x": 1350,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "12232cbb.f802d3",
        "type": "http request",
        "z": "892838ee.3ab438",
        "name": "",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 670,
        "y": 240,
        "wires": [
            [
                "78e346f1.8e8b28",
                "cb27fff4.49b69"
            ]
        ]
    },
    {
        "id": "cb27fff4.49b69",
        "type": "debug",
        "z": "892838ee.3ab438",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 820,
        "y": 360,
        "wires": []
    },
    {
        "id": "857490ee.89b9d",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Send the most popular questions for admin",
        "links": [
            "4329a74.1062558"
        ],
        "x": 1775,
        "y": 1320,
        "wires": []
    },
    {
        "id": "988b4bfe.7ceae8",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Send the most popular questions for admin",
        "info": "",
        "x": 1920,
        "y": 1280,
        "wires": []
    },
    {
        "id": "a525eef0.3d2fc",
        "type": "switch",
        "z": "dbbd86af.74c0d8",
        "name": "Set answer to popular question for admin (pagination)",
        "property": "$split(msg.message, \"_\", 1)",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "eq",
                "v": "theMostPopularQPaginationForAdmin",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1380,
        "y": 1720,
        "wires": [
            [
                "87c7d03d.ab97b"
            ]
        ]
    },
    {
        "id": "87c7d03d.ab97b",
        "type": "link out",
        "z": "dbbd86af.74c0d8",
        "name": "Set answer to popular question(pagination)",
        "links": [
            "4329a74.1062558"
        ],
        "x": 1775,
        "y": 1720,
        "wires": []
    },
    {
        "id": "28ecb014.f4527",
        "type": "comment",
        "z": "dbbd86af.74c0d8",
        "name": "Set answer to popular question(pagination)",
        "info": "",
        "x": 1920,
        "y": 1680,
        "wires": []
    }
]